{"version":3,"file":"static/js/main.68c77845.js","mappings":"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","sources":["src/firebase.ts","src/context/AuthProvider.tsx","src/components/EnhancedErrorBoundary.tsx","src/config/piConfig.ts","src/screens/AuthScreen.tsx","src/api/chords.ts","src/context/ThemeContext.tsx","src/utils/chordLibrary.ts","src/components/CompactRhythmTimeline.tsx","src/components/EmbeddedRhythmSheet.tsx","src/components/Fretboard.Enhanced.tsx","src/components/UnifiedYouTubePlayer.tsx","src/components/SynchronizedChordPlayer.tsx","src/screens/ChordPlayerScreen.tsx","src/screens/HomeScreen.tsx","src/screens/LibraryScreen.tsx","src/api/youtube.ts","src/screens/SearchScreen.tsx","src/screens/SettingsScreen.tsx","src/navigation/RootStack.tsx","src/utils/deviceCompatibility.ts","index.ts","App.js","webpack/bootstrap","webpack/runtime/chunk loaded","webpack/runtime/compat get default export","webpack/runtime/create fake namespace object","webpack/runtime/define property getters","webpack/runtime/global","webpack/runtime/hasOwnProperty shorthand","webpack/runtime/make namespace object","webpack/runtime/jsonp chunk loading","webpack/startup"],"sourcesContent":["// src/firebase.ts\r\nimport Constants from 'expo-constants';\r\nimport { getApps, initializeApp } from 'firebase/app';\r\nimport {\r\n    Auth,\r\n    getAuth,\r\n    GoogleAuthProvider\r\n} from 'firebase/auth';\r\n\r\n// Firebase configuration with multiple fallback sources\r\nconst getFirebaseConfig = () => {\r\n  // Try to get from Constants (app.config.js)\r\n  const fromConstants = Constants.expoConfig?.extra;\r\n  \r\n  // Create config object\r\n  const config = {\r\n    apiKey: fromConstants?.FIREBASE_API_KEY || \r\n            process.env.EXPO_PUBLIC_FIREBASE_API_KEY || \r\n            process.env.FIREBASE_API_KEY || \r\n            \"your-firebase-api-key-here\",\r\n            \r\n    authDomain: fromConstants?.FIREBASE_AUTH_DOMAIN || \r\n                process.env.EXPO_PUBLIC_FIREBASE_AUTH_DOMAIN || \r\n                process.env.FIREBASE_AUTH_DOMAIN || \r\n                \"chords-legend.firebaseapp.com\",\r\n                \r\n    projectId: fromConstants?.FIREBASE_PROJECT_ID || \r\n               process.env.EXPO_PUBLIC_FIREBASE_PROJECT_ID || \r\n               process.env.FIREBASE_PROJECT_ID || \r\n               \"chords-legend\",\r\n               \r\n    storageBucket: fromConstants?.FIREBASE_STORAGE_BUCKET || \r\n                   process.env.EXPO_PUBLIC_FIREBASE_STORAGE_BUCKET || \r\n                   process.env.FIREBASE_STORAGE_BUCKET || \r\n                   \"chords-legend.firebasestorage.app\",\r\n                   \r\n    messagingSenderId: fromConstants?.FIREBASE_MESSAGING_SENDER_ID || \r\n                       process.env.EXPO_PUBLIC_FIREBASE_MESSAGING_SENDER_ID || \r\n                       process.env.FIREBASE_MESSAGING_SENDER_ID || \r\n                       \"509802787175\",\r\n                       \r\n    appId: fromConstants?.FIREBASE_APP_ID || \r\n           process.env.EXPO_PUBLIC_FIREBASE_APP_ID || \r\n           process.env.FIREBASE_APP_ID || \r\n           \"1:509802787175:android:983791faee41272ef5bfc2\"\r\n  };\r\n  \r\n  return config;\r\n};\r\n\r\nconst firebaseConfig = getFirebaseConfig();\r\n\r\n// Enhanced configuration validation\r\nconst validateFirebaseConfig = (config: any) => {\r\n  const required = ['apiKey', 'authDomain', 'projectId'];\r\n  const missing = required.filter(key => !config[key]);\r\n  \r\n  if (missing.length > 0) {\r\n    console.error('Missing Firebase configuration:', missing);\r\n    return false;\r\n  }\r\n  \r\n  console.log('Firebase configuration validated successfully');\r\n  return true;\r\n};\r\n\r\n// Debug: Log the config to see what's being loaded\r\nconsole.log('Firebase Config loaded:', {\r\n  ...firebaseConfig,\r\n  apiKey: firebaseConfig.apiKey ? `${firebaseConfig.apiKey.substring(0, 10)}...` : 'missing'\r\n});\r\n\r\n// Debug: Log what's available from each source\r\nconst fromConstants = Constants.expoConfig?.extra;\r\nconsole.log('Firebase config sources:');\r\nconsole.log('- Constants.expoConfig?.extra:', fromConstants ? Object.keys(fromConstants).filter(k => k.includes('FIREBASE')) : 'not available');\r\nconsole.log('- process.env EXPO_PUBLIC_:', {\r\n  EXPO_PUBLIC_FIREBASE_API_KEY: process.env.EXPO_PUBLIC_FIREBASE_API_KEY ? 'found' : 'missing',\r\n  EXPO_PUBLIC_FIREBASE_PROJECT_ID: process.env.EXPO_PUBLIC_FIREBASE_PROJECT_ID ? 'found' : 'missing'\r\n});\r\nconsole.log('- process.env regular:', {\r\n  FIREBASE_API_KEY: process.env.FIREBASE_API_KEY ? 'found' : 'missing',\r\n  FIREBASE_PROJECT_ID: process.env.FIREBASE_PROJECT_ID ? 'found' : 'missing'\r\n});\r\n\r\n// Validate configuration\r\nconst isConfigValid = validateFirebaseConfig(firebaseConfig);\r\nif (!isConfigValid) {\r\n  console.error('Firebase configuration is incomplete');\r\n  console.log('Available extra config keys:', Object.keys(Constants.expoConfig?.extra || {}));\r\n}\r\n\r\n// Initialize Firebase\r\nlet app: any;\r\nlet auth: Auth;\r\n\r\ntry {\r\n  // Check if app already exists\r\n  if (getApps().length === 0) {\r\n    app = initializeApp(firebaseConfig);\r\n    console.log('Firebase app initialized successfully');\r\n  } else {\r\n    app = getApps()[0];\r\n    console.log('Using existing Firebase app');\r\n  }\r\n  \r\n  // Initialize Firebase Auth with AsyncStorage persistence\r\n  try {\r\n    // For React Native, we need to use a different approach for persistence\r\n    auth = getAuth(app);\r\n    console.log('Firebase Auth initialized successfully');\r\n  } catch (error: any) {\r\n    console.error('Failed to initialize Firebase Auth:', error);\r\n    throw error;\r\n  }\r\n  \r\n} catch (error) {\r\n  console.error('Failed to initialize Firebase:', error);\r\n  throw new Error(`Firebase initialization failed: ${error instanceof Error ? error.message : String(error)}`);\r\n}\r\n\r\n// Test Firebase connection\r\nexport const testFirebaseConnection = async (): Promise<boolean> => {\r\n  try {\r\n    console.log('Starting Firebase connection test...');\r\n    \r\n    if (!auth) {\r\n      console.error('Firebase Auth not initialized');\r\n      return false;\r\n    }\r\n    \r\n    // Test 1: Check if Firebase configuration is valid\r\n    const config = auth.app.options;\r\n    if (!config.apiKey || !config.authDomain || !config.projectId) {\r\n      console.error('Firebase configuration is incomplete');\r\n      return false;\r\n    }\r\n    console.log(' Firebase configuration is complete');\r\n    \r\n    // Test 2: Try to make a basic request to Firebase Auth API\r\n    try {\r\n      console.log('Testing Firebase Auth API connectivity...');\r\n      const testUrl = `https://identitytoolkit.googleapis.com/v1/accounts:lookup?key=${config.apiKey}`;\r\n      const response = await fetch(testUrl, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({})\r\n      });\r\n      \r\n      console.log('Firebase API response status:', response.status);\r\n      \r\n      if (response.status === 400) {\r\n        // A 400 error with \"INVALID_ID_TOKEN\" or similar means Firebase is reachable\r\n        const errorText = await response.text();\r\n        console.log(' Firebase Auth API is reachable (expected 400 error):', errorText);\r\n        return true;\r\n      } else if (response.status === 200) {\r\n        console.log(' Firebase Auth API responded successfully');\r\n        return true;\r\n      } else if (response.status === 403) {\r\n        console.log(' Firebase API key might be restricted, but service is reachable');\r\n        return true; // API key restrictions don't mean Firebase is down\r\n      } else {\r\n        console.error('Firebase Auth API returned unexpected status:', response.status);\r\n        const errorText = await response.text();\r\n        console.error('Response body:', errorText);\r\n        return false;\r\n      }\r\n    } catch (networkError) {\r\n      console.error('Network request to Firebase failed:', networkError);\r\n      \r\n      // Check if it's a network connectivity issue\r\n      try {\r\n        await fetch('https://www.google.com', { \r\n          method: 'HEAD', \r\n          mode: 'no-cors',\r\n          cache: 'no-cache'\r\n        });\r\n        console.log(' Internet connection is working');\r\n        console.error(' Specific issue connecting to Firebase');\r\n      } catch (internetError) {\r\n        console.error(' No internet connection');\r\n      }\r\n      \r\n      // Even if the network test fails, try to validate that Firebase Auth is at least initialized\r\n      console.log('Attempting fallback test: checking if Firebase Auth is accessible...');\r\n      try {\r\n        const authInstance = getAuth();\r\n        if (authInstance && authInstance.app) {\r\n          console.log(' Firebase Auth instance is accessible (fallback success)');\r\n          return true;\r\n        }\r\n      } catch (fallbackError) {\r\n        console.error(' Firebase Auth instance not accessible:', fallbackError);\r\n      }\r\n      \r\n      return false;\r\n    }\r\n    \r\n  } catch (error) {\r\n    console.error('Firebase connection test failed:', error);\r\n    return false;\r\n  }\r\n};\r\n\r\nexport { auth, GoogleAuthProvider };\r\n\r\nexport const getAuthInstance = () => {\r\n  if (!auth) {\r\n    throw new Error('Firebase Auth not initialized. Check your Firebase configuration.');\r\n  }\r\n  return auth;\r\n};","// src/context/AuthProvider.tsx\r\nimport { createUserWithEmailAndPassword, onAuthStateChanged, signInWithEmailAndPassword, signOut, User } from 'firebase/auth';\r\nimport React, { createContext, useCallback, useContext, useEffect, useState } from 'react';\r\nimport { getAuthInstance, testFirebaseConnection } from '../firebase';\r\n\r\ntype AuthContextType = {\r\n  user: User | null;\r\n  isLoading: boolean;\r\n  error: string | null;\r\n  login: (email: string, password: string) => Promise<User | null>;\r\n  signUp: (email: string, password: string) => Promise<User | null>;\r\n  logout: () => Promise<void>;\r\n  clearError: () => void;\r\n  isConnected: boolean;\r\n  forceConnectionState: (connected: boolean) => void; // Debug function\r\n};\r\n\r\nconst AuthContext = createContext<AuthContextType>({\r\n  user: null,\r\n  isLoading: true,\r\n  error: null,\r\n  login: async () => null,\r\n  signUp: async () => null,\r\n  logout: async () => {},\r\n  clearError: () => {},\r\n  isConnected: false,\r\n  forceConnectionState: () => {}, // Debug function\r\n});\r\n\r\nexport const AuthProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {\r\n  const [user, setUser] = useState<User | null>(null);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [isConnected, setIsConnected] = useState(false);\r\n\r\n  // Debug: Add provider instance ID\r\n  const providerInstanceId = Math.random().toString(36).substring(7);\r\n  console.log(`AuthProvider instance created: ${providerInstanceId}`);\r\n\r\n  // Test Firebase connection on mount\r\n  useEffect(() => {\r\n    const checkConnection = async () => {\r\n      console.log(`AuthProvider [${providerInstanceId}]: Starting Firebase setup...`);\r\n      \r\n      try {\r\n        // Step 1: Initialize Firebase Auth\r\n        console.log(`AuthProvider [${providerInstanceId}]: Getting Firebase Auth instance...`);\r\n        const auth = getAuthInstance();\r\n        console.log(`AuthProvider [${providerInstanceId}]:  Firebase Auth instance obtained`);\r\n        \r\n        // Step 2: Set up auth state listener (this is the key to Firebase working)\r\n        console.log(`AuthProvider [${providerInstanceId}]: Setting up auth state listener...`);\r\n        const unsubscribe = onAuthStateChanged(\r\n          auth, \r\n          (user) => {\r\n            // Auth listener successfully working = Firebase is connected\r\n            console.log(`AuthProvider [${providerInstanceId}]: Auth state changed:`, user ? `User: ${user.email}` : 'No user');\r\n            \r\n            // Update all states in one go\r\n            setUser(user);\r\n            setIsLoading(false);\r\n            setIsConnected(true); // Auth listener working = Firebase connected\r\n            setError(null);\r\n            \r\n            console.log(`AuthProvider [${providerInstanceId}]:  Successfully updated states - Connected: true`);\r\n          },\r\n          (authError) => {\r\n            console.error(`AuthProvider [${providerInstanceId}]: Auth state error:`, authError);\r\n            setError(`Authentication error: ${authError.message}`);\r\n            setIsLoading(false);\r\n            setIsConnected(false);\r\n          }\r\n        );\r\n        \r\n        console.log(`AuthProvider [${providerInstanceId}]:  Auth listener set up successfully`);\r\n        \r\n        // Step 3: Test connection (optional, for debugging)\r\n        try {\r\n          const connectionTest = await testFirebaseConnection();\r\n          console.log(`AuthProvider [${providerInstanceId}]: Connection test result: ${connectionTest}`);\r\n        } catch (testError) {\r\n          console.log(`AuthProvider [${providerInstanceId}]: Connection test failed, but auth listener is working`);\r\n        }\r\n        \r\n        return unsubscribe;\r\n        \r\n      } catch (error) {\r\n        console.error(`AuthProvider [${providerInstanceId}]: Setup failed:`, error);\r\n        setError(error instanceof Error ? error.message : 'Firebase setup failed');\r\n        setIsLoading(false);\r\n        setIsConnected(false);\r\n      }\r\n    };\r\n\r\n    checkConnection();\r\n  }, [providerInstanceId]);\r\n\r\n  const clearError = useCallback(() => {\r\n    setError(null);\r\n  }, []);\r\n\r\n  const login = useCallback(async (email: string, password: string) => {\r\n    try {\r\n      setError(null);\r\n      setIsLoading(true);\r\n      \r\n      // Validate input\r\n      if (!email || !password) {\r\n        throw new Error('Email and password are required');\r\n      }\r\n      \r\n      // Ensure we can get the auth instance\r\n      const auth = getAuthInstance();\r\n      if (!auth) {\r\n        throw new Error('Firebase Auth not initialized');\r\n      }\r\n      \r\n      // Log debugging info\r\n      console.log(`Attempting login for user: ${email}`);\r\n      \r\n      // Attempt login\r\n      const userCredential = await signInWithEmailAndPassword(auth, email, password);\r\n      setUser(userCredential.user);\r\n      console.log('Login successful for user:', userCredential.user.email);\r\n      return userCredential.user;\r\n      \r\n    } catch (error: any) {\r\n      console.error('Login error:', error);\r\n      console.error('Error code:', error.code);\r\n      console.error('Error message:', error.message);\r\n      \r\n      const errorMessage = getFirebaseErrorMessage(error);\r\n      setError(errorMessage);\r\n      throw new Error(errorMessage);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  const signUp = useCallback(async (email: string, password: string) => {\r\n    try {\r\n      setError(null);\r\n      setIsLoading(true);\r\n      \r\n      // Validate input\r\n      if (!email || !password) {\r\n        throw new Error('Email and password are required');\r\n      }\r\n      \r\n      const auth = getAuthInstance();\r\n      if (!auth) {\r\n        throw new Error('Firebase Auth not initialized');\r\n      }\r\n      \r\n      // Log debugging info\r\n      console.log(`Attempting signup for user: ${email}`);\r\n      \r\n      // Attempt signup\r\n      const userCredential = await createUserWithEmailAndPassword(auth, email, password);\r\n      setUser(userCredential.user);\r\n      console.log('Sign up successful for user:', userCredential.user.email);\r\n      return userCredential.user;\r\n      \r\n    } catch (error: any) {\r\n      console.error('SignUp error:', error);\r\n      console.error('Error code:', error.code);\r\n      console.error('Error message:', error.message);\r\n      \r\n      const errorMessage = getFirebaseErrorMessage(error);\r\n      setError(errorMessage);\r\n      throw new Error(errorMessage);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  const logout = useCallback(async () => {\r\n    try {\r\n      setError(null);\r\n      \r\n      const auth = getAuthInstance();\r\n      if (!auth) {\r\n        throw new Error('Firebase Auth not initialized');\r\n      }\r\n      \r\n      await signOut(auth);\r\n      setUser(null);\r\n      console.log('Logout successful');\r\n      \r\n    } catch (error: any) {\r\n      console.error('Logout error:', error);\r\n      const errorMessage = error instanceof Error ? error.message : 'Logout failed';\r\n      setError(errorMessage);\r\n      throw new Error(errorMessage);\r\n    }\r\n  }, []);\r\n\r\n  // Debug function to manually force connection state\r\n  const forceConnectionState = useCallback((connected: boolean) => {\r\n    console.log(`AuthProvider [${providerInstanceId}]: Force setting isConnected to ${connected}`);\r\n    setIsConnected(connected);\r\n    setIsLoading(false);\r\n    if (connected) {\r\n      setError(null);\r\n    }\r\n  }, [providerInstanceId]);\r\n\r\n  const value = {\r\n    user,\r\n    isLoading,\r\n    error,\r\n    login,\r\n    signUp,\r\n    logout,\r\n    clearError,\r\n    isConnected,\r\n    forceConnectionState, // Debug function\r\n  };\r\n\r\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\r\n};\r\n\r\n// Helper function to get user-friendly Firebase error messages\r\nconst getFirebaseErrorMessage = (error: any): string => {\r\n  if (!error?.code) {\r\n    return error?.message || 'An unexpected error occurred';\r\n  }\r\n\r\n  switch (error.code) {\r\n    case 'auth/email-already-in-use':\r\n      return 'An account with this email already exists. Try logging in instead.';\r\n    case 'auth/weak-password':\r\n      return 'Password is too weak. Please choose a stronger password.';\r\n    case 'auth/invalid-email':\r\n      return 'Please enter a valid email address.';\r\n    case 'auth/user-not-found':\r\n      return 'No account found with this email. Try signing up instead.';\r\n    case 'auth/wrong-password':\r\n      return 'Incorrect password. Please try again.';\r\n    case 'auth/too-many-requests':\r\n      return 'Too many failed attempts. Please try again later.';\r\n    case 'auth/network-request-failed':\r\n      return 'Network error. Please check your connection and try again.';\r\n    case 'auth/invalid-credential':\r\n      return 'Invalid email or password. Please check your credentials.';\r\n    case 'auth/user-disabled':\r\n      return 'This account has been disabled. Please contact support.';\r\n    case 'auth/operation-not-allowed':\r\n      return 'Email/password accounts are not enabled. Please contact support.';\r\n    default:\r\n      return error.message || 'An authentication error occurred. Please try again.';\r\n  }\r\n};\r\n\r\nexport const useAuth = () => {\r\n  const context = useContext(AuthContext);\r\n  if (!context) {\r\n    throw new Error('useAuth must be used within an AuthProvider');\r\n  }\r\n  \r\n  // Debug: Log when hook is called and what it returns\r\n  const debugInfo = {\r\n    isConnected: context.isConnected,\r\n    isLoading: context.isLoading,\r\n    user: context.user ? 'logged in' : 'not logged in',\r\n    error: context.error ? 'has error' : 'no error',\r\n    timestamp: new Date().toLocaleTimeString()\r\n  };\r\n  \r\n  console.log(`useAuth called:`, debugInfo);\r\n  \r\n  return context;\r\n};","// Enhanced error boundary for better cross-device compatibility\r\nimport React, { Component, ErrorInfo, ReactNode } from 'react';\r\nimport { Platform, StyleSheet, Text, TouchableOpacity, View } from 'react-native';\r\n\r\ninterface Props {\r\n  children: ReactNode;\r\n}\r\n\r\ninterface State {\r\n  hasError: boolean;\r\n  error: Error | null;\r\n  errorInfo: ErrorInfo | null;\r\n}\r\n\r\nclass EnhancedErrorBoundary extends Component<Props, State> {\r\n  constructor(props: Props) {\r\n    super(props);\r\n    this.state = {\r\n      hasError: false,\r\n      error: null,\r\n      errorInfo: null\r\n    };\r\n  }\r\n\r\n  static getDerivedStateFromError(error: Error): State {\r\n    return {\r\n      hasError: true,\r\n      error,\r\n      errorInfo: null\r\n    };\r\n  }\r\n\r\n  componentDidCatch(error: Error, errorInfo: ErrorInfo) {\r\n    console.error('EnhancedErrorBoundary caught an error:', error, errorInfo);\r\n    \r\n    this.setState({\r\n      error,\r\n      errorInfo\r\n    });\r\n\r\n    // Log error details for debugging\r\n    const deviceInfo = {\r\n      platform: Platform.OS,\r\n      version: Platform.Version,\r\n      userAgent: typeof navigator !== 'undefined' ? navigator.userAgent : 'Unknown',\r\n      timestamp: new Date().toISOString(),\r\n      url: typeof window !== 'undefined' ? window.location.href : 'Unknown'\r\n    };\r\n\r\n    console.log('Device Info:', deviceInfo);\r\n    console.log('Error Stack:', error.stack);\r\n    console.log('Component Stack:', errorInfo.componentStack);\r\n  }\r\n\r\n  handleRestart = () => {\r\n    this.setState({\r\n      hasError: false,\r\n      error: null,\r\n      errorInfo: null\r\n    });\r\n    \r\n    // Reload the page on web, restart the component on native\r\n    if (Platform.OS === 'web' && typeof window !== 'undefined') {\r\n      window.location.reload();\r\n    }\r\n  };\r\n\r\n  render() {\r\n    if (this.state.hasError) {\r\n      return (\r\n        <View style={styles.container}>\r\n          <View style={styles.errorContainer}>\r\n            <Text style={styles.emoji}></Text>\r\n            <Text style={styles.title}>Oops! Something went wrong</Text>\r\n            <Text style={styles.message}>\r\n              ChordsLegend encountered an unexpected error. Don't worry, this helps us improve the app!\r\n            </Text>\r\n            \r\n            {__DEV__ && this.state.error && (\r\n              <View style={styles.debugInfo}>\r\n                <Text style={styles.debugTitle}>Debug Information:</Text>\r\n                <Text style={styles.debugText}>\r\n                  {this.state.error.toString()}\r\n                </Text>\r\n                {this.state.errorInfo && (\r\n                  <Text style={styles.debugText}>\r\n                    {this.state.errorInfo.componentStack}\r\n                  </Text>\r\n                )}\r\n              </View>\r\n            )}\r\n            \r\n            <TouchableOpacity style={styles.restartButton} onPress={this.handleRestart}>\r\n              <Text style={styles.restartButtonText}> Restart App</Text>\r\n            </TouchableOpacity>\r\n            \r\n            <Text style={styles.supportText}>\r\n              If this problem persists, please visit our web version at:\r\n              {'\\n'}https://chordslegend-production.up.railway.app\r\n            </Text>\r\n          </View>\r\n        </View>\r\n      );\r\n    }\r\n\r\n    return this.props.children;\r\n  }\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: '#1a1a2e',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    padding: 20,\r\n  },\r\n  errorContainer: {\r\n    backgroundColor: 'rgba(255, 255, 255, 0.1)',\r\n    borderRadius: 20,\r\n    padding: 30,\r\n    maxWidth: 400,\r\n    alignItems: 'center',\r\n  },\r\n  emoji: {\r\n    fontSize: 64,\r\n    marginBottom: 20,\r\n  },\r\n  title: {\r\n    fontSize: 24,\r\n    fontWeight: 'bold',\r\n    color: '#fff',\r\n    textAlign: 'center',\r\n    marginBottom: 15,\r\n  },\r\n  message: {\r\n    fontSize: 16,\r\n    color: '#ccc',\r\n    textAlign: 'center',\r\n    lineHeight: 24,\r\n    marginBottom: 25,\r\n  },\r\n  debugInfo: {\r\n    backgroundColor: 'rgba(255, 0, 0, 0.1)',\r\n    padding: 15,\r\n    borderRadius: 10,\r\n    marginBottom: 20,\r\n    maxWidth: '100%',\r\n  },\r\n  debugTitle: {\r\n    fontSize: 14,\r\n    fontWeight: 'bold',\r\n    color: '#ff6b6b',\r\n    marginBottom: 10,\r\n  },\r\n  debugText: {\r\n    fontSize: 12,\r\n    color: '#ff9999',\r\n    fontFamily: Platform.OS === 'ios' ? 'Courier' : 'monospace',\r\n  },\r\n  restartButton: {\r\n    backgroundColor: '#4CAF50',\r\n    paddingHorizontal: 30,\r\n    paddingVertical: 15,\r\n    borderRadius: 25,\r\n    marginBottom: 20,\r\n  },\r\n  restartButtonText: {\r\n    color: '#fff',\r\n    fontSize: 16,\r\n    fontWeight: 'bold',\r\n  },\r\n  supportText: {\r\n    fontSize: 12,\r\n    color: '#999',\r\n    textAlign: 'center',\r\n    lineHeight: 18,\r\n  },\r\n});\r\n\r\nexport default EnhancedErrorBoundary;\r\n","// Pi Network Integration Configuration\r\nexport const PI_CONFIG = {\r\n  // Pi Network App Configuration\r\n  APP_NAME: 'ChordsLegend',\r\n  APP_USERNAME: 'chordslegend', // Your Pi app username\r\n  \r\n  // IMPORTANT: Pi Network Sandbox Configuration\r\n  // Set SANDBOX_MODE to true for Pi Network testing\r\n  SANDBOX_MODE: true,\r\n  \r\n  // Pi Network Environment Detection\r\n  ENVIRONMENT: (typeof window !== 'undefined' && \r\n    (window.location.href.includes('sandbox.minepi.com') || \r\n     window.location.href.includes('pi.network'))) ? 'sandbox' : \r\n    (__DEV__ ? 'development' : 'production'),\r\n  \r\n  // Pi SDK Configuration\r\n  API_KEY: process.env.PI_API_KEY || '',\r\n  \r\n  // Sandbox URLs\r\n  SANDBOX_URL: 'https://sandbox.minepi.com/app/chords-legend',\r\n  SANDBOX_API_BASE: 'https://api.sandbox.minepi.com',\r\n  \r\n  // Pi Browser Detection\r\n  isPiBrowser: () => {\r\n    return (\r\n      typeof window !== 'undefined' && \r\n      (\r\n        window.navigator.userAgent.includes('PiBrowser') ||\r\n        window.location.hostname.includes('minepi.com') ||\r\n        window.location.hostname.includes('pi.network') ||\r\n        window.Pi !== undefined ||\r\n        window.location.href.includes('sandbox.minepi.com')\r\n      )\r\n    );\r\n  },\r\n  \r\n  // SDK Configuration\r\n  SDK_CONFIG: {\r\n    version: \"2.0\",\r\n    sandbox: true, // Always true for initial submission testing\r\n    environment: 'sandbox'\r\n  },\r\n  \r\n  // App Configuration for Pi Network\r\n  APP_CONFIG: {\r\n    appName: 'ChordsLegend',\r\n    developerId: 'chordslegend',\r\n    appSecret: process.env.PI_APP_SECRET || '',\r\n    scopes: ['payments', 'username']\r\n  },\r\n  \r\n  // Sandbox-specific features for testing\r\n  SANDBOX_FEATURES: {\r\n    // Test features with small Pi amounts\r\n    TEST_PREMIUM: {\r\n      price: 0.01, // Small amount for testing\r\n      name: 'Test Premium Feature',\r\n      description: 'Test Pi payment functionality'\r\n    }\r\n  },\r\n  \r\n  // App-specific Pi features\r\n  FEATURES: {\r\n    // Premium features that require Pi payments\r\n    PREMIUM_CHORD_LIBRARY: {\r\n      price: 1.0, // 1 Pi\r\n      name: 'Premium Chord Library',\r\n      description: 'Access to advanced chord progressions and techniques'\r\n    },\r\n    \r\n    AI_CHORD_DETECTION: {\r\n      price: 2.0, // 2 Pi\r\n      name: 'AI Chord Detection',\r\n      description: 'Real-time audio analysis and chord recognition'\r\n    },\r\n    \r\n    YOUTUBE_SYNC: {\r\n      price: 1.5, // 1.5 Pi\r\n      name: 'YouTube Synchronization',\r\n      description: 'Sync chord progressions with YouTube videos'\r\n    },\r\n    \r\n    OFFLINE_MODE: {\r\n      price: 0.5, // 0.5 Pi\r\n      name: 'Offline Mode',\r\n      description: 'Download chord libraries for offline practice'\r\n    }\r\n  },\r\n  \r\n  // Pi Network URLs\r\n  URLS: {\r\n    DEVELOPER_PORTAL: 'https://developers.minepi.com/',\r\n    APP_DETAILS: 'https://developers.minepi.com/apps/chordslegend',\r\n    PI_BROWSER: 'https://app-cdn.minepi.com/mobile-app-ui/'\r\n  }\r\n};\r\n\r\n// Pi Network payment types\r\nexport type PiFeature = keyof typeof PI_CONFIG.FEATURES;\r\n\r\nexport interface PiPayment {\r\n  amount: number;\r\n  memo: string;\r\n  metadata: {\r\n    feature: PiFeature;\r\n    userId: string;\r\n    timestamp: number;\r\n  };\r\n}\r\n\r\nexport interface PiUser {\r\n  uid: string;\r\n  username: string;\r\n  accessToken: string;\r\n  payments: PiPayment[];\r\n}\r\n","import { useNavigation, useRoute } from '@react-navigation/native';\r\nimport { NativeStackNavigationProp } from '@react-navigation/native-stack';\r\nimport React, { useEffect, useState } from 'react';\r\nimport {\r\n  ActivityIndicator, KeyboardAvoidingView,\r\n  Platform, ScrollView, StyleSheet, Text,\r\n  TextInput,\r\n  TouchableOpacity, View\r\n} from 'react-native';\r\nimport { useAuth } from '../context/AuthProvider';\r\nimport { RootStackParamList } from '../navigation/types';\r\n\r\ntype AuthScreenNavigationProp = NativeStackNavigationProp<RootStackParamList, 'Auth'>;\r\n\r\nexport default function AuthScreen() {\r\n  const navigation = useNavigation<AuthScreenNavigationProp>();\r\n  const route = useRoute();\r\n  const { mode } = route.params as { mode?: 'login' | 'signup' } || {};\r\n  \r\n  const [email, setEmail] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const [isLogin, setIsLogin] = useState(mode === 'signup' ? false : true);\r\n  const [loading, setLoading] = useState(false);\r\n  const [errors, setErrors] = useState({ email: '', password: '', general: '' });\r\n  const [successMessage, setSuccessMessage] = useState('');\r\n  const { login, signUp, error: authError, clearError, isConnected, isLoading: authLoading, user } = useAuth();\r\n\r\n  // Navigate to Home when user successfully logs in\r\n  useEffect(() => {\r\n    if (user && !loading) {\r\n      setSuccessMessage(isLogin ? 'Login successful! Redirecting...' : 'Account created! Redirecting...');\r\n      // Small delay to show success before navigation\r\n      setTimeout(() => {\r\n        navigation.replace('Home');\r\n      }, 1500);\r\n    }\r\n  }, [user, loading, navigation, isLogin]);\r\n\r\n  // Clear errors when switching between login/signup\r\n  useEffect(() => {\r\n    setErrors({ email: '', password: '', general: '' });\r\n    setSuccessMessage('');\r\n    clearError();\r\n  }, [isLogin, clearError]);\r\n\r\n  // Show auth errors from context\r\n  useEffect(() => {\r\n    if (authError) {\r\n      setErrors(prev => ({ ...prev, general: authError }));\r\n    }\r\n  }, [authError]);\r\n\r\n  const validateEmail = (email: string) => {\r\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n    return emailRegex.test(email);\r\n  };\r\n\r\n  const validatePassword = (password: string) => {\r\n    if (password.length < 6) {\r\n      return 'Password must be at least 6 characters long';\r\n    }\r\n    if (!isLogin && password.length < 8) {\r\n      return 'Password should be at least 8 characters for better security';\r\n    }\r\n    return '';\r\n  };\r\n\r\n  const handleAuth = async () => {\r\n    // Clear previous errors\r\n    setErrors({ email: '', password: '', general: '' });\r\n    clearError();\r\n\r\n    // Validate inputs\r\n    if (!email.trim()) {\r\n      setErrors(prev => ({ ...prev, email: 'Email is required' }));\r\n      return;\r\n    }\r\n\r\n    if (!validateEmail(email)) {\r\n      setErrors(prev => ({ ...prev, email: 'Please enter a valid email address' }));\r\n      return;\r\n    }\r\n\r\n    if (!password) {\r\n      setErrors(prev => ({ ...prev, password: 'Password is required' }));\r\n      return;\r\n    }\r\n\r\n    const passwordError = validatePassword(password);\r\n    if (passwordError && !isLogin) {\r\n      setErrors(prev => ({ ...prev, password: passwordError }));\r\n      return;\r\n    }\r\n    \r\n    setLoading(true);\r\n    try {\r\n      if (isLogin) {\r\n        await login(email.trim(), password);\r\n      } else {\r\n        await signUp(email.trim(), password);\r\n      }\r\n    } catch (error: any) {\r\n      console.error('Auth error:', error);\r\n      // Error is already handled by AuthProvider context\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <KeyboardAvoidingView \r\n      style={styles.container}\r\n      behavior={Platform.OS === 'ios' ? 'padding' : 'height'}\r\n    >\r\n      <ScrollView contentContainerStyle={styles.scrollContainer}>\r\n        <View style={styles.formContainer}>\r\n          <Text style={styles.title}>ChordsLegend</Text>\r\n          <Text style={styles.subtitle}>\r\n            {isLogin ? 'Welcome back!' : 'Join the community'}\r\n          </Text>\r\n\r\n          {/* Connection Status - Only show if not connected */}\r\n          {!isConnected && (\r\n            <View style={styles.statusContainer}>\r\n              <Text style={[styles.statusText, { color: '#ff6b6b' }]}>\r\n                Connection issue - Please check your internet\r\n              </Text>\r\n            </View>\r\n          )}\r\n\r\n          {/* Mode Toggle Buttons */}\r\n          <View style={styles.modeToggle}>\r\n            <TouchableOpacity\r\n              style={[styles.modeButton, isLogin && styles.modeButtonActive]}\r\n              onPress={() => {\r\n                setIsLogin(true);\r\n                setErrors({ email: '', password: '', general: '' });\r\n              }}\r\n            >\r\n              <Text style={[styles.modeButtonText, isLogin && styles.modeButtonTextActive]}>\r\n                Login\r\n              </Text>\r\n            </TouchableOpacity>\r\n            <TouchableOpacity\r\n              style={[styles.modeButton, !isLogin && styles.modeButtonActive]}\r\n              onPress={() => {\r\n                setIsLogin(false);\r\n                setErrors({ email: '', password: '', general: '' });\r\n              }}\r\n            >\r\n              <Text style={[styles.modeButtonText, !isLogin && styles.modeButtonTextActive]}>\r\n                Sign Up\r\n              </Text>\r\n            </TouchableOpacity>\r\n          </View>\r\n\r\n          {/* Success Message */}\r\n          {successMessage ? (\r\n            <View style={styles.successContainer}>\r\n              <Text style={styles.successText}>{successMessage}</Text>\r\n            </View>\r\n          ) : null}\r\n\r\n          {/* General Error Message */}\r\n          {errors.general ? (\r\n            <View style={styles.errorContainer}>\r\n              <Text style={styles.errorText}>{errors.general}</Text>\r\n            </View>\r\n          ) : null}\r\n\r\n          <TextInput\r\n            style={[styles.input, errors.email && styles.inputError]}\r\n            placeholder=\"Email\"\r\n            placeholderTextColor=\"#888\"\r\n            value={email}\r\n            onChangeText={(text) => {\r\n              setEmail(text);\r\n              if (errors.email) {\r\n                setErrors(prev => ({ ...prev, email: '' }));\r\n              }\r\n            }}\r\n            keyboardType=\"email-address\"\r\n            autoCapitalize=\"none\"\r\n            autoComplete=\"email\"\r\n          />\r\n          {errors.email ? <Text style={styles.fieldErrorText}>{errors.email}</Text> : null}\r\n\r\n          <TextInput\r\n            style={[styles.input, errors.password && styles.inputError]}\r\n            placeholder=\"Password\"\r\n            placeholderTextColor=\"#888\"\r\n            value={password}\r\n            onChangeText={(text) => {\r\n              setPassword(text);\r\n              if (errors.password) {\r\n                setErrors(prev => ({ ...prev, password: '' }));\r\n              }\r\n            }}\r\n            secureTextEntry\r\n            autoComplete=\"password\"\r\n          />\r\n          {errors.password ? <Text style={styles.fieldErrorText}>{errors.password}</Text> : null}\r\n\r\n          {/* Password Requirements for Signup */}\r\n          {!isLogin && (\r\n            <View style={styles.passwordRequirements}>\r\n              <Text style={styles.requirementsTitle}>Password Requirements:</Text>\r\n              <Text style={[styles.requirementText, password.length >= 6 && styles.requirementMet]}>\r\n                 At least 6 characters\r\n              </Text>\r\n              <Text style={[styles.requirementText, password.length >= 8 && styles.requirementMet]}>\r\n                 Recommended: 8+ characters for better security\r\n              </Text>\r\n            </View>\r\n          )}\r\n\r\n          {/* Enhanced Auth Button with better UX */}\r\n          <TouchableOpacity\r\n            style={[\r\n              styles.button, \r\n              loading && styles.buttonDisabled,\r\n              !isConnected && styles.buttonWarning\r\n            ]}\r\n            onPress={handleAuth}\r\n            disabled={loading || !isConnected}\r\n          >\r\n            {loading ? (\r\n              <View style={styles.loadingContainer}>\r\n                <ActivityIndicator size=\"small\" color=\"#fff\" />\r\n                <Text style={styles.buttonText}>\r\n                  {isLogin ? 'Signing in...' : 'Creating account...'}\r\n                </Text>\r\n              </View>\r\n            ) : (\r\n              <Text style={styles.buttonText}>\r\n                {!isConnected \r\n                  ? 'Check Connection' \r\n                  : isLogin \r\n                    ? 'Sign In' \r\n                    : 'Create Account'\r\n                }\r\n              </Text>\r\n            )}\r\n          </TouchableOpacity>\r\n\r\n          {/* Alternative Login Methods */}\r\n          <View style={styles.alternativeLogin}>\r\n            <Text style={styles.alternativeText}>Or continue with</Text>\r\n            <View style={styles.socialButtons}>\r\n              <TouchableOpacity style={styles.socialButton} disabled>\r\n                <Text style={styles.socialButtonText}>Google</Text>\r\n              </TouchableOpacity>\r\n              <TouchableOpacity style={styles.socialButton} disabled>\r\n                <Text style={styles.socialButtonText}>Apple</Text>\r\n              </TouchableOpacity>\r\n            </View>\r\n            <Text style={styles.comingSoon}>Coming Soon</Text>\r\n          </View>\r\n        </View>\r\n      </ScrollView>\r\n    </KeyboardAvoidingView>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: '#1a1a1a',\r\n    justifyContent: 'center',\r\n  },\r\n  formContainer: {\r\n    padding: 20,\r\n    marginHorizontal: 20,\r\n  },\r\n  title: {\r\n    fontSize: 32,\r\n    fontWeight: 'bold',\r\n    color: '#fff',\r\n    textAlign: 'center',\r\n    marginBottom: 8,\r\n  },\r\n  subtitle: {\r\n    fontSize: 16,\r\n    color: '#888',\r\n    textAlign: 'center',\r\n    marginBottom: 40,\r\n  },\r\n  input: {\r\n    backgroundColor: '#333',\r\n    color: '#fff',\r\n    padding: 15,\r\n    borderRadius: 10,\r\n    marginBottom: 5,\r\n    fontSize: 16,\r\n    borderWidth: 1,\r\n    borderColor: '#333',\r\n  },\r\n  inputError: {\r\n    borderColor: '#ff4444',\r\n    borderWidth: 1,\r\n  },\r\n  button: {\r\n    backgroundColor: '#007AFF',\r\n    padding: 15,\r\n    borderRadius: 10,\r\n    alignItems: 'center',\r\n    marginBottom: 15,\r\n    marginTop: 10,\r\n  },\r\n  buttonDisabled: {\r\n    backgroundColor: '#555',\r\n  },\r\n  buttonText: {\r\n    color: '#fff',\r\n    fontSize: 16,\r\n    fontWeight: 'bold',\r\n  },\r\n  loadingContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 10,\r\n  },\r\n  scrollContainer: {\r\n    flexGrow: 1,\r\n    justifyContent: 'center',\r\n  },\r\n  statusContainer: {\r\n    padding: 10,\r\n    backgroundColor: '#f8f9fa',\r\n    borderRadius: 8,\r\n    marginBottom: 20,\r\n    alignItems: 'center',\r\n  },\r\n  statusText: {\r\n    fontSize: 14,\r\n    fontWeight: 'bold',\r\n  },\r\n  debugToggle: {\r\n    padding: 10,\r\n    backgroundColor: '#f0f0f0',\r\n    borderRadius: 5,\r\n    marginTop: 10,\r\n    alignItems: 'center',\r\n  },\r\n  debugToggleText: {\r\n    fontSize: 12,\r\n    color: '#666',\r\n  },\r\n  debugContainer: {\r\n    marginTop: 20,\r\n    padding: 15,\r\n    backgroundColor: '#f8f9fa',\r\n    borderRadius: 8,\r\n    maxHeight: 200,\r\n  },\r\n  debugTitle: {\r\n    fontSize: 14,\r\n    fontWeight: 'bold',\r\n    marginBottom: 10,\r\n  },\r\n  clearLogsButton: {\r\n    padding: 5,\r\n    backgroundColor: '#dc3545',\r\n    borderRadius: 4,\r\n    alignItems: 'center',\r\n    marginBottom: 10,\r\n  },\r\n  clearLogsText: {\r\n    color: '#fff',\r\n    fontSize: 12,\r\n  },\r\n  debugLogs: {\r\n    maxHeight: 120,\r\n  },\r\n  debugLogText: {\r\n    fontSize: 10,\r\n    fontFamily: 'monospace',\r\n    color: '#333',\r\n    marginBottom: 2,\r\n  },\r\n  modeToggle: {\r\n    flexDirection: 'row',\r\n    backgroundColor: '#333',\r\n    borderRadius: 10,\r\n    marginBottom: 30,\r\n    padding: 4,\r\n  },\r\n  modeButton: {\r\n    flex: 1,\r\n    paddingVertical: 12,\r\n    alignItems: 'center',\r\n    borderRadius: 6,\r\n  },\r\n  modeButtonActive: {\r\n    backgroundColor: '#007AFF',\r\n  },\r\n  modeButtonText: {\r\n    color: '#888',\r\n    fontSize: 16,\r\n    fontWeight: '500',\r\n  },\r\n  modeButtonTextActive: {\r\n    color: '#fff',\r\n    fontWeight: 'bold',\r\n  },\r\n  errorContainer: {\r\n    backgroundColor: '#ff444420',\r\n    borderColor: '#ff4444',\r\n    borderWidth: 1,\r\n    borderRadius: 8,\r\n    padding: 12,\r\n    marginBottom: 15,\r\n  },\r\n  successContainer: {\r\n    backgroundColor: '#4CAF5020',\r\n    borderColor: '#4CAF50',\r\n    borderWidth: 1,\r\n    borderRadius: 8,\r\n    padding: 12,\r\n    marginBottom: 15,\r\n  },\r\n  errorText: {\r\n    color: '#ff4444',\r\n    fontSize: 14,\r\n    textAlign: 'center',\r\n  },\r\n  successText: {\r\n    color: '#4CAF50',\r\n    fontSize: 14,\r\n    textAlign: 'center',\r\n    fontWeight: 'bold',\r\n  },\r\n  fieldErrorText: {\r\n    color: '#ff4444',\r\n    fontSize: 12,\r\n    marginBottom: 10,\r\n    marginLeft: 5,\r\n  },\r\n  passwordRequirements: {\r\n    backgroundColor: '#333',\r\n    borderRadius: 8,\r\n    padding: 12,\r\n    marginBottom: 15,\r\n  },\r\n  requirementsTitle: {\r\n    color: '#fff',\r\n    fontSize: 14,\r\n    fontWeight: 'bold',\r\n    marginBottom: 8,\r\n  },\r\n  requirementText: {\r\n    color: '#888',\r\n    fontSize: 12,\r\n    marginBottom: 4,\r\n  },\r\n  requirementMet: {\r\n    color: '#4CAF50',\r\n  },\r\n  buttonWarning: {\r\n    backgroundColor: '#ff6b6b',\r\n    opacity: 0.7,\r\n  },\r\n  alternativeLogin: {\r\n    marginTop: 30,\r\n    alignItems: 'center',\r\n  },\r\n  alternativeText: {\r\n    color: '#888',\r\n    fontSize: 14,\r\n    marginBottom: 15,\r\n  },\r\n  socialButtons: {\r\n    flexDirection: 'row',\r\n    gap: 15,\r\n    marginBottom: 10,\r\n  },\r\n  socialButton: {\r\n    backgroundColor: '#333',\r\n    paddingHorizontal: 20,\r\n    paddingVertical: 12,\r\n    borderRadius: 8,\r\n    opacity: 0.6,\r\n  },\r\n  socialButtonText: {\r\n    color: '#888',\r\n    fontSize: 14,\r\n  },\r\n  comingSoon: {\r\n    color: '#666',\r\n    fontSize: 12,\r\n    fontStyle: 'italic',\r\n  },\r\n});","// Enhanced ChordData interface with more detailed types\r\nexport interface ChordData {\r\n  time: number;          // Time in seconds\r\n  chord: string;         // Chord name (e.g., \"Cmaj7\", \"D#m\")\r\n  confidence: number;    // Confidence score between 0-1\r\n  duration?: number;     // Optional: Duration the chord lasts\r\n  beat?: number;         // Optional: Beat position in measure\r\n}\r\n\r\n// Type for API response\r\ninterface ApiResponse {\r\n  status: 'success' | 'error';\r\n  chords?: any[];\r\n  error?: string;\r\n  analysisId?: string;\r\n  timestamp?: string;\r\n}\r\n\r\n// Configuration\r\nconst API_CONFIG = {\r\n  baseUrl: process.env.EXPO_PUBLIC_API_URL || process.env.API_URL || 'http://192.168.1.138:5000',\r\n  timeout: 10000, // 10 seconds\r\n  retries: 2,\r\n};\r\n\r\n// Utility function to safely convert unknown error types\r\nfunction toError(error: unknown): Error {\r\n  if (error instanceof Error) return error;\r\n  if (typeof error === 'string') return new Error(error);\r\n  return new Error(String(error));\r\n}\r\n\r\n/**\r\n * Enhanced chord analysis service with:\r\n * - Better error handling\r\n * - Request timeout\r\n * - Retry mechanism\r\n * - Type safety\r\n */\r\nexport const analyzeChords = async (youtubeUrl: string): Promise<ChordData[]> => {\r\n  const controller = new AbortController();\r\n  const timeoutId = setTimeout(() => controller.abort(), API_CONFIG.timeout);\r\n\r\n  try {\r\n    let lastError: Error | null = null;\r\n    \r\n    for (let attempt = 0; attempt <= API_CONFIG.retries; attempt++) {\r\n      try {\r\n        const response = await fetch(`${API_CONFIG.baseUrl}/analyze`, {\r\n          method: 'POST',\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n            'Accept': 'application/json',\r\n          },\r\n          body: JSON.stringify({ \r\n            youtube_url: youtubeUrl,\r\n            options: {\r\n              detailed: true,  // Request additional data if supported\r\n            }\r\n          }),\r\n          signal: controller.signal,\r\n        });\r\n\r\n        clearTimeout(timeoutId);\r\n\r\n        if (!response.ok) {\r\n          const errorData = await tryParseError(response);\r\n          throw new Error(\r\n            errorData?.error || \r\n            `HTTP error! status: ${response.status}`\r\n          );\r\n        }\r\n\r\n        const data: ApiResponse = await response.json();\r\n        \r\n        if (data.status !== 'success' || !data.chords) {\r\n          throw new Error(data.error || 'Invalid response format');\r\n        }\r\n\r\n        // Transform and validate the response\r\n        return data.chords.map((chord, index) => {\r\n          if (!chord.time || !chord.chord || chord.confidence === undefined) {\r\n            throw new Error(`Invalid chord data at index ${index}`);\r\n          }\r\n          \r\n          return {\r\n            time: Number(chord.time),\r\n            chord: String(chord.chord),\r\n            confidence: Math.min(1, Math.max(0, Number(chord.confidence))),\r\n            duration: chord.duration ? Number(chord.duration) : undefined,\r\n            beat: chord.beat ? Number(chord.beat) : undefined,\r\n          };\r\n        });\r\n\r\n      } catch (error) {\r\n        lastError = toError(error);\r\n        \r\n        // Don't retry on abort or validation errors\r\n        // Check for DOMException only on web platform\r\n        const isDOMError = typeof DOMException !== 'undefined' && error instanceof DOMException;\r\n        if (isDOMError || lastError.message.includes('Invalid')) {\r\n          break;\r\n        }\r\n        \r\n        // Wait before retrying (exponential backoff)\r\n        if (attempt < API_CONFIG.retries) {\r\n          await new Promise(resolve => \r\n            setTimeout(resolve, 1000 * (attempt + 1))\r\n          );\r\n        }\r\n      }\r\n    }\r\n\r\n    throw lastError || new Error('Chord analysis failed');\r\n\r\n  } catch (error) {\r\n    const normalizedError = toError(error);\r\n    console.error('Chord analysis failed:', {\r\n      error: normalizedError.message,\r\n      stack: normalizedError.stack,\r\n      youtubeUrl,\r\n      timestamp: new Date().toISOString(),\r\n    });\r\n\r\n    // Provide fallback data for demo purposes\r\n    if (process.env.NODE_ENV === 'development') {\r\n      console.warn('Using demo chord data');\r\n      return generateDemoChords();\r\n    }\r\n\r\n    throw enhanceError(normalizedError);\r\n  } finally {\r\n    clearTimeout(timeoutId);\r\n  }\r\n};\r\n\r\n// Helper to parse error responses\r\nasync function tryParseError(response: Response): Promise<{ error?: string }> {\r\n  try {\r\n    return await response.json();\r\n  } catch {\r\n    return {};\r\n  }\r\n}\r\n\r\n// Enhance error with additional context\r\nfunction enhanceError(error: Error): Error {\r\n  if (error.message.includes('Failed to fetch')) {\r\n    return new Error('Connection failed. Please check your network.');\r\n  }\r\n  if (error.message.includes('aborted')) {\r\n    return new Error('Request timed out. Please try again.');\r\n  }\r\n  return error;\r\n}\r\n\r\n// Demo data for development\r\nfunction generateDemoChords(): ChordData[] {\r\n  const chords = ['C', 'G', 'Am', 'F', 'Dm', 'Em', 'Bdim'];\r\n  return Array.from({ length: 8 }, (_, i) => ({\r\n    time: i * 2,\r\n    chord: chords[i % chords.length],\r\n    confidence: 0.8 + Math.random() * 0.2,\r\n    duration: 2,\r\n    beat: (i % 4) + 1,\r\n  }));\r\n}\r\n\r\n/**\r\n * Chord processing utilities\r\n */\r\n\r\n// Group chords by time window\r\nexport function groupChords(chords: ChordData[], windowSize = 0.5): ChordData[] {\r\n  if (!chords.length) return [];\r\n\r\n  const sortedChords = [...chords].sort((a, b) => a.time - b.time);\r\n  const grouped: ChordData[] = [];\r\n  let currentWindow: ChordData[] = [];\r\n  let windowStart = sortedChords[0].time;\r\n\r\n  sortedChords.forEach(chord => {\r\n    if (chord.time >= windowStart + windowSize) {\r\n      if (currentWindow.length > 0) {\r\n        grouped.push(createWindowChord(currentWindow));\r\n      }\r\n      currentWindow = [];\r\n      windowStart = chord.time;\r\n    }\r\n    currentWindow.push(chord);\r\n  });\r\n\r\n  // Add remaining chords in the last window\r\n  if (currentWindow.length > 0) {\r\n    grouped.push(createWindowChord(currentWindow));\r\n  }\r\n\r\n  return grouped;\r\n}\r\n\r\nfunction createWindowChord(chords: ChordData[]): ChordData {\r\n  const averageTime = chords.reduce((sum, c) => sum + c.time, 0) / chords.length;\r\n  const mostConfidentChord = chords.reduce((prev, current) => \r\n    (prev.confidence > current.confidence) ? prev : current\r\n  );\r\n  \r\n  return {\r\n    ...mostConfidentChord,\r\n    time: averageTime\r\n  };\r\n}\r\n\r\n// Filter chords by confidence threshold\r\nexport function filterByConfidence(\r\n  chords: ChordData[], \r\n  minConfidence = 0.7\r\n): ChordData[] {\r\n  return chords.filter(c => c.confidence >= minConfidence);\r\n}\r\n\r\n// Find the current chord at a specific playback time\r\nexport function getCurrentChord(\r\n  chords: ChordData[], \r\n  currentTime: number\r\n): ChordData | undefined {\r\n  return chords.find((chord, i) => \r\n    currentTime >= chord.time && \r\n    (i === chords.length - 1 || currentTime < chords[i + 1].time)\r\n  );\r\n}","// src/context/ThemeContext.tsx\r\nimport React, { createContext, useContext, useState, ReactNode } from 'react';\r\n\r\ninterface ThemeProviderProps {\r\n  children: ReactNode;\r\n}\r\ntype Theme = {\r\n  primary: string;\r\n  secondary: string;\r\n  background: string;\r\n  surface: string;\r\n  surfaceHighlight: string;\r\n  error: string;\r\n  text: string;\r\n  secondaryText: string;\r\n  onPrimary: string;\r\n  divider: string;\r\n  children?: ReactNode;\r\n};\r\n\r\nconst lightTheme: Theme = {\r\n  primary: '#6A0DAD',\r\n  secondary: '#9C27B0',\r\n  background: '#FFFFFF',\r\n  surface: '#F5F5F5',\r\n  surfaceHighlight: '#E0E0E0',\r\n  error: '#B00020',\r\n  text: '#000000',\r\n  secondaryText: '#666666',\r\n  onPrimary: '#FFFFFF',\r\n  divider: '#DDDDDD',\r\n};\r\n\r\nconst darkTheme: Theme = {\r\n  primary: '#BB86FC',\r\n  secondary: '#03DAC6',\r\n  background: '#121212',\r\n  surface: '#1E1E1E',\r\n  surfaceHighlight: '#2D2D2D',\r\n  error: '#CF6679',\r\n  text: '#FFFFFF',\r\n  secondaryText: '#BBBBBB',\r\n  onPrimary: '#000000',\r\n  divider: '#333333',\r\n};\r\n\r\nconst ThemeContext = createContext<{\r\n  theme: Theme;\r\n  isDark: boolean;\r\n  setTheme: (dark: boolean) => void;\r\n}>({\r\n  theme: lightTheme,\r\n  isDark: false,\r\n  setTheme: () => {},\r\n});\r\n\r\nexport const ThemeProvider = ({ children }: ThemeProviderProps ) => {\r\n  const [isDark, setIsDark] = useState(false);\r\n\r\n  return (\r\n    <ThemeContext.Provider\r\n      value={{\r\n        theme: isDark ? darkTheme : lightTheme,\r\n        isDark,\r\n        setTheme: setIsDark,\r\n      }}\r\n    >\r\n      {children}\r\n    </ThemeContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useTheme = () => useContext(ThemeContext);","import { ChordFingering } from '../components/Fretboard';\r\n\r\nexport interface ChordDefinition {\r\n  name: string;\r\n  fingerings: ChordFingering[];\r\n}\r\n\r\nexport const CHORD_LIBRARY: Record<string, ChordDefinition> = {\r\n  'C': {\r\n    name: 'C Major',\r\n    fingerings: [\r\n      {\r\n        name: 'Open Position',\r\n        frets: [0, 3, 2, 0, 1, 0],\r\n        fingers: [0, 3, 2, 0, 1, 0],\r\n        type: 'open',\r\n      },\r\n      {\r\n        name: 'Barre 3rd Fret',\r\n        frets: [3, 3, 5, 5, 5, 3],\r\n        fingers: [1, 1, 3, 4, 4, 1],\r\n        barres: [{ fret: 3, startString: 0, endString: 5 }],\r\n        baseFret: 3,\r\n        type: 'barre',\r\n      }\r\n    ]\r\n  },\r\n  'G': {\r\n    name: 'G Major',\r\n    fingerings: [\r\n      {\r\n        name: 'Open Position',\r\n        frets: [3, 2, 0, 0, 3, 3],\r\n        fingers: [3, 2, 0, 0, 4, 4],\r\n        type: 'open',\r\n      }\r\n    ]\r\n  },\r\n  'Am': {\r\n    name: 'A Minor',\r\n    fingerings: [\r\n      {\r\n        name: 'Open Position',\r\n        frets: [0, 0, 2, 2, 1, 0],\r\n        fingers: [0, 0, 3, 2, 1, 0],\r\n        type: 'open',\r\n      }\r\n    ]\r\n  },\r\n  'F': {\r\n    name: 'F Major',\r\n    fingerings: [\r\n      {\r\n        name: 'Barre 1st Fret',\r\n        frets: [1, 3, 3, 2, 1, 1],\r\n        fingers: [1, 3, 4, 2, 1, 1],\r\n        barres: [{ fret: 1, startString: 0, endString: 5 }],\r\n        baseFret: 1,\r\n        type: 'barre',\r\n      }\r\n    ]\r\n  },\r\n  'Em': {\r\n    name: 'E Minor',\r\n    fingerings: [\r\n      {\r\n        name: 'Open Position',\r\n        frets: [0, 2, 2, 0, 0, 0],\r\n        fingers: [0, 2, 3, 0, 0, 0],\r\n        type: 'open',\r\n      }\r\n    ]\r\n  },\r\n  'Em7': {\r\n    name: 'E Minor 7',\r\n    fingerings: [\r\n      {\r\n        name: 'Open Position',\r\n        frets: [0, 2, 0, 0, 0, 0],\r\n        fingers: [0, 2, 0, 0, 0, 0],\r\n        type: 'open',\r\n      }\r\n    ]\r\n  },\r\n  'D': {\r\n    name: 'D Major',\r\n    fingerings: [\r\n      {\r\n        name: 'Open Position',\r\n        frets: [-1, -1, 0, 2, 3, 2],\r\n        fingers: [0, 0, 0, 1, 3, 2],\r\n        type: 'open',\r\n      }\r\n    ]\r\n  },\r\n  'Dm': {\r\n    name: 'D Minor',\r\n    fingerings: [\r\n      {\r\n        name: 'Open Position',\r\n        frets: [-1, -1, 0, 2, 3, 1],\r\n        fingers: [0, 0, 0, 2, 3, 1],\r\n        type: 'open',\r\n      }\r\n    ]\r\n  },\r\n  'B7': {\r\n    name: 'B Dominant 7',\r\n    fingerings: [\r\n      {\r\n        name: 'Open Position',\r\n        frets: [-1, 2, 1, 2, 0, 2],\r\n        fingers: [0, 2, 1, 3, 0, 4],\r\n        type: 'open',\r\n      }\r\n    ]\r\n  },\r\n  'E': {\r\n    name: 'E Major',\r\n    fingerings: [\r\n      {\r\n        name: 'Open Position',\r\n        frets: [0, 2, 2, 1, 0, 0],\r\n        fingers: [0, 2, 3, 1, 0, 0],\r\n        type: 'open',\r\n      }\r\n    ]\r\n  }\r\n};\r\n\r\nexport const getChordFingerings = (chordName: string): ChordDefinition | null => {\r\n  // First try the exact chord name\r\n  if (CHORD_LIBRARY[chordName]) {\r\n    return CHORD_LIBRARY[chordName];\r\n  }\r\n  \r\n  // Then try the base chord (remove extensions)\r\n  const baseChord = chordName.replace(/7|maj7|m7|add9|sus2|sus4|dim|aug|9|11|13/g, '');\r\n  if (CHORD_LIBRARY[baseChord]) {\r\n    return CHORD_LIBRARY[baseChord];\r\n  }\r\n  \r\n  // Handle specific mappings for common extensions\r\n  if (chordName.includes('m7') && !chordName.includes('maj7')) {\r\n    const minorChord = chordName.replace('m7', 'm');\r\n    if (CHORD_LIBRARY[minorChord]) {\r\n      return CHORD_LIBRARY[minorChord];\r\n    }\r\n  }\r\n  \r\n  return null;\r\n};\r\n\r\nexport const getAvailableChords = (): string[] => {\r\n  return Object.keys(CHORD_LIBRARY);\r\n};\r\n","import React, { useEffect, useRef } from 'react';\r\nimport { ScrollView, StyleSheet, Text, TouchableOpacity, View } from 'react-native';\r\n\r\ninterface ChordTiming {\r\n  chord: string;\r\n  startTime: number;\r\n  duration: number;\r\n}\r\n\r\ninterface CompactRhythmTimelineProps {\r\n  chordProgression: ChordTiming[];\r\n  currentTime: number;\r\n  isPlaying: boolean;\r\n  theme: any;\r\n  onSeekToTime: (time: number) => void;\r\n}\r\n\r\nconst CompactRhythmTimeline: React.FC<CompactRhythmTimelineProps> = ({\r\n  chordProgression,\r\n  currentTime,\r\n  isPlaying,\r\n  theme,\r\n  onSeekToTime,\r\n}) => {\r\n  const scrollViewRef = useRef<ScrollView>(null);\r\n\r\n  // Auto-scroll to current position\r\n  useEffect(() => {\r\n    console.log(' CompactRhythmTimeline: currentTime updated to', currentTime.toFixed(1), 'isPlaying:', isPlaying);\r\n    \r\n    if (scrollViewRef.current && isPlaying) {\r\n      // Find current chord index\r\n      const currentIndex = chordProgression.findIndex((chord, index) => {\r\n        const nextChord = chordProgression[index + 1];\r\n        return currentTime >= chord.startTime && \r\n               (!nextChord || currentTime < nextChord.startTime);\r\n      });\r\n\r\n      if (currentIndex >= 0) {\r\n        const currentChord = chordProgression[currentIndex];\r\n        console.log(' Current chord in timeline:', currentChord.chord, 'at index:', currentIndex);\r\n        \r\n        // Scroll to show current chord in center\r\n        const itemWidth = 80; // Width of each chord item\r\n        const scrollPosition = Math.max(0, (currentIndex * itemWidth) - 150); // Center with offset\r\n        \r\n        scrollViewRef.current.scrollTo({ \r\n          x: scrollPosition, \r\n          animated: true \r\n        });\r\n      }\r\n    }\r\n  }, [currentTime, isPlaying, chordProgression]);\r\n\r\n  const getCurrentChordIndex = () => {\r\n    return chordProgression.findIndex((chord, index) => {\r\n      const nextChord = chordProgression[index + 1];\r\n      return currentTime >= chord.startTime && \r\n             (!nextChord || currentTime < nextChord.startTime);\r\n    });\r\n  };\r\n\r\n  const formatTime = (seconds: number) => {\r\n    const mins = Math.floor(seconds / 60);\r\n    const secs = Math.floor(seconds % 60);\r\n    return `${mins}:${secs.toString().padStart(2, '0')}`;\r\n  };\r\n\r\n  const currentChordIndex = getCurrentChordIndex();\r\n\r\n  return (\r\n    <View style={[styles.container, { backgroundColor: theme.surface }]}>\r\n      <View style={styles.header}>\r\n        <Text style={[styles.title, { color: theme.text }]}>\r\n          Rhythm Timeline\r\n        </Text>\r\n        <Text style={[styles.timeIndicator, { color: theme.primary }]}>\r\n          {formatTime(currentTime)}\r\n        </Text>\r\n      </View>\r\n      \r\n      <ScrollView\r\n        ref={scrollViewRef}\r\n        horizontal\r\n        showsHorizontalScrollIndicator={false}\r\n        style={styles.timeline}\r\n        contentContainerStyle={styles.timelineContent}\r\n      >\r\n        {chordProgression.map((chord, index) => {\r\n          const isActive = index === currentChordIndex;\r\n          const isPast = currentTime > chord.startTime + chord.duration;\r\n          const isNext = index === currentChordIndex + 1;\r\n          const isUpcoming = index > currentChordIndex && index <= currentChordIndex + 3;\r\n          \r\n          // Calculate progress within current chord\r\n          const progress = isActive ? \r\n            Math.min(1, Math.max(0, (currentTime - chord.startTime) / chord.duration)) : \r\n            isPast ? 1 : 0;\r\n\r\n          return (\r\n            <TouchableOpacity\r\n              key={index}\r\n              style={[\r\n                styles.chordItem,\r\n                {\r\n                  backgroundColor: isActive \r\n                    ? theme.primary + '30'\r\n                    : isNext \r\n                      ? theme.secondary + '20'\r\n                      : isUpcoming \r\n                        ? theme.surface + '80'\r\n                        : isPast \r\n                          ? theme.divider + '20'\r\n                          : theme.surface,\r\n                  borderColor: isActive \r\n                    ? theme.primary \r\n                    : isNext \r\n                      ? theme.secondary \r\n                      : 'transparent',\r\n                  borderWidth: isActive || isNext ? 2 : 1,\r\n                }\r\n              ]}\r\n              onPress={() => onSeekToTime(chord.startTime)}\r\n            >\r\n              {/* Progress bar for current chord */}\r\n              {isActive && (\r\n                <View style={[styles.progressBar, { backgroundColor: theme.divider }]}>\r\n                  <View \r\n                    style={[\r\n                      styles.progressFill,\r\n                      { \r\n                        backgroundColor: theme.primary,\r\n                        width: `${progress * 100}%`\r\n                      }\r\n                    ]}\r\n                  />\r\n                </View>\r\n              )}\r\n              \r\n              {/* Chord name */}\r\n              <Text style={[\r\n                styles.chordName,\r\n                {\r\n                  color: isActive \r\n                    ? theme.primary \r\n                    : isNext \r\n                      ? theme.secondary\r\n                      : isPast \r\n                        ? theme.secondaryText + '80'\r\n                        : theme.text,\r\n                  fontWeight: isActive ? 'bold' : isNext ? '600' : 'normal',\r\n                  fontSize: isActive ? 16 : 14\r\n                }\r\n              ]}>\r\n                {chord.chord}\r\n              </Text>\r\n              \r\n              {/* Time indicator */}\r\n              <Text style={[\r\n                styles.timeText,\r\n                { \r\n                  color: isActive ? theme.primary : theme.secondaryText,\r\n                  fontSize: isActive ? 11 : 10\r\n                }\r\n              ]}>\r\n                {formatTime(chord.startTime)}\r\n              </Text>\r\n              \r\n              {/* Duration indicator */}\r\n              <Text style={[\r\n                styles.durationText,\r\n                { color: theme.secondaryText }\r\n              ]}>\r\n                {chord.duration}s\r\n              </Text>\r\n              \r\n              {/* Status indicators */}\r\n              {isActive && isPlaying && (\r\n                <View style={[styles.playingIndicator, { backgroundColor: theme.primary }]}>\r\n                  <Text style={styles.playingIcon}></Text>\r\n                </View>\r\n              )}\r\n              \r\n              {isNext && (\r\n                <Text style={[styles.nextLabel, { color: theme.secondary }]}>\r\n                  NEXT\r\n                </Text>\r\n              )}\r\n            </TouchableOpacity>\r\n          );\r\n        })}\r\n      </ScrollView>\r\n      \r\n      {/* Timeline controls */}\r\n      <View style={styles.controls}>\r\n        <Text style={[styles.positionText, { color: theme.secondaryText }]}>\r\n          Chord {currentChordIndex + 1} of {chordProgression.length}\r\n        </Text>\r\n        <View style={[styles.globalProgress, { backgroundColor: theme.divider }]}>\r\n          <View \r\n            style={[\r\n              styles.globalProgressFill,\r\n              { \r\n                backgroundColor: theme.primary,\r\n                width: `${((currentChordIndex + 1) / chordProgression.length) * 100}%`\r\n              }\r\n            ]}\r\n          />\r\n        </View>\r\n      </View>\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    borderRadius: 12,\r\n    margin: 16,\r\n    overflow: 'hidden',\r\n    elevation: 2,\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 2 },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 4,\r\n  },\r\n  header: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    padding: 12,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: 'rgba(255, 255, 255, 0.1)',\r\n  },\r\n  title: {\r\n    fontSize: 14,\r\n    fontWeight: 'bold',\r\n  },\r\n  timeIndicator: {\r\n    fontSize: 14,\r\n    fontWeight: 'bold',\r\n    fontFamily: 'monospace',\r\n  },\r\n  timeline: {\r\n    maxHeight: 120,\r\n  },\r\n  timelineContent: {\r\n    paddingHorizontal: 16,\r\n    paddingVertical: 12,\r\n  },\r\n  chordItem: {\r\n    width: 75,\r\n    height: 90,\r\n    marginRight: 8,\r\n    borderRadius: 8,\r\n    padding: 8,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    position: 'relative',\r\n  },\r\n  progressBar: {\r\n    position: 'absolute',\r\n    top: 0,\r\n    left: 0,\r\n    right: 0,\r\n    height: 3,\r\n    borderRadius: 1.5,\r\n  },\r\n  progressFill: {\r\n    height: '100%',\r\n    borderRadius: 1.5,\r\n  },\r\n  chordName: {\r\n    fontWeight: 'bold',\r\n    marginBottom: 4,\r\n    textAlign: 'center',\r\n  },\r\n  timeText: {\r\n    fontFamily: 'monospace',\r\n    marginBottom: 2,\r\n  },\r\n  durationText: {\r\n    fontSize: 9,\r\n    fontFamily: 'monospace',\r\n  },\r\n  playingIndicator: {\r\n    position: 'absolute',\r\n    top: 4,\r\n    right: 4,\r\n    width: 16,\r\n    height: 16,\r\n    borderRadius: 8,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n  playingIcon: {\r\n    color: '#fff',\r\n    fontSize: 10,\r\n    fontWeight: 'bold',\r\n  },\r\n  nextLabel: {\r\n    position: 'absolute',\r\n    bottom: 2,\r\n    fontSize: 8,\r\n    fontWeight: 'bold',\r\n  },\r\n  controls: {\r\n    padding: 12,\r\n    borderTopWidth: 1,\r\n    borderTopColor: 'rgba(255, 255, 255, 0.1)',\r\n  },\r\n  positionText: {\r\n    fontSize: 12,\r\n    textAlign: 'center',\r\n    marginBottom: 8,\r\n  },\r\n  globalProgress: {\r\n    height: 4,\r\n    borderRadius: 2,\r\n    overflow: 'hidden',\r\n  },\r\n  globalProgressFill: {\r\n    height: '100%',\r\n    borderRadius: 2,\r\n  },\r\n});\r\n\r\nexport default CompactRhythmTimeline;\r\n","import React, { useEffect, useRef } from 'react';\r\nimport { ScrollView, StyleSheet, Text, TouchableOpacity, View } from 'react-native';\r\n\r\ninterface ChordTiming {\r\n  chord: string;\r\n  startTime: number;\r\n  duration: number;\r\n}\r\n\r\ninterface Beat {\r\n  chord: string;\r\n  isChordChange: boolean;\r\n  time: number;\r\n  beatNumber: number;\r\n  measure: number;\r\n}\r\n\r\ninterface EmbeddedRhythmSheetProps {\r\n  chordProgression: ChordTiming[];\r\n  currentTime: number;\r\n  isPlaying: boolean;\r\n  theme: any;\r\n  onSeekToTime: (time: number) => void;\r\n}\r\n\r\nconst EmbeddedRhythmSheet: React.FC<EmbeddedRhythmSheetProps> = ({\r\n  chordProgression,\r\n  currentTime,\r\n  isPlaying,\r\n  theme,\r\n  onSeekToTime,\r\n}) => {\r\n  const scrollViewRef = useRef<ScrollView>(null);\r\n\r\n  // Convert chord progression to rhythm sheet with measures and beats\r\n  const generateRhythmSheet = (): Beat[] => {\r\n    const beats: Beat[] = [];\r\n    const beatsPerMeasure = 4;\r\n    const beatDuration = 1; // 1 second per beat (60 BPM)\r\n    \r\n    if (chordProgression.length === 0) return beats;\r\n    \r\n    const totalDuration = Math.max(\r\n      ...chordProgression.map(c => c.startTime + c.duration)\r\n    );\r\n    \r\n    const totalBeats = Math.ceil(totalDuration / beatDuration);\r\n    \r\n    for (let beatIndex = 0; beatIndex < totalBeats; beatIndex++) {\r\n      const beatTime = beatIndex * beatDuration;\r\n      const measure = Math.floor(beatIndex / beatsPerMeasure) + 1;\r\n      const beatNumber = (beatIndex % beatsPerMeasure) + 1;\r\n      \r\n      // Find the chord that should be playing at this beat\r\n      const activeChord = chordProgression.find(c => \r\n        beatTime >= c.startTime && beatTime < c.startTime + c.duration\r\n      );\r\n      \r\n      // Check if this is a chord change (first beat of a new chord)\r\n      const isChordChange = chordProgression.some(c => \r\n        Math.abs(c.startTime - beatTime) < 0.5\r\n      );\r\n      \r\n      beats.push({\r\n        chord: activeChord?.chord || '',\r\n        isChordChange,\r\n        time: beatTime,\r\n        beatNumber,\r\n        measure,\r\n      });\r\n    }\r\n    \r\n    return beats;\r\n  };\r\n\r\n  const rhythmSheet = generateRhythmSheet();\r\n  \r\n  // Auto-scroll to current position\r\n  useEffect(() => {\r\n    console.log(' EmbeddedRhythmSheet: currentTime updated to', currentTime.toFixed(1), 'isPlaying:', isPlaying);\r\n    \r\n    if (scrollViewRef.current && isPlaying && rhythmSheet.length > 0) {\r\n      // Find current beat index\r\n      const currentBeatIndex = rhythmSheet.findIndex(beat => \r\n        Math.abs(beat.time - currentTime) < 0.5\r\n      );\r\n\r\n      if (currentBeatIndex >= 0) {\r\n        const currentBeat = rhythmSheet[currentBeatIndex];\r\n        console.log(' Current beat:', currentBeat.beatNumber, 'measure:', currentBeat.measure, 'chord:', currentBeat.chord);\r\n        \r\n        // Calculate scroll position (each measure is about 200px wide)\r\n        const currentMeasure = rhythmSheet[currentBeatIndex].measure;\r\n        const scrollPosition = Math.max(0, (currentMeasure - 3) * 200); // Show 3 measures ahead to account for padding\r\n        \r\n        scrollViewRef.current.scrollTo({ \r\n          x: scrollPosition, \r\n          animated: true \r\n        });\r\n      }\r\n    }\r\n  }, [currentTime, isPlaying, rhythmSheet]);\r\n\r\n  const getCurrentBeat = () => {\r\n    return rhythmSheet.find(beat => \r\n      Math.abs(beat.time - currentTime) < 0.5\r\n    );\r\n  };\r\n\r\n  const isActiveBeat = (beat: Beat) => {\r\n    return Math.abs(beat.time - currentTime) < 0.5;\r\n  };\r\n\r\n  const isUpcomingBeat = (beat: Beat) => {\r\n    return beat.time > currentTime && beat.time <= currentTime + 4; // Next 4 beats\r\n  };\r\n\r\n  const isPastBeat = (beat: Beat) => {\r\n    return beat.time < currentTime - 0.5;\r\n  };\r\n\r\n  // Group beats by measures for rendering\r\n  const getMeasures = () => {\r\n    const measures: { [key: number]: Beat[] } = {};\r\n    rhythmSheet.forEach(beat => {\r\n      if (!measures[beat.measure]) {\r\n        measures[beat.measure] = [];\r\n      }\r\n      measures[beat.measure].push(beat);\r\n    });\r\n    return measures;\r\n  };\r\n\r\n  const measures = getMeasures();\r\n  const measureNumbers = Object.keys(measures).map(Number).sort((a, b) => a - b);\r\n\r\n  const renderMeasure = (measureNumber: number, beats: Beat[]) => {\r\n    return (\r\n      <View key={measureNumber} style={[styles.measure, { borderColor: theme.divider }]}>\r\n        <Text style={[styles.measureNumber, { color: theme.secondaryText }]}>\r\n          {measureNumber}\r\n        </Text>\r\n        <View style={styles.beatsRow}>\r\n          {beats.map((beat, index) => (\r\n            <TouchableOpacity\r\n              key={index}\r\n              style={[\r\n                styles.beat,\r\n                {\r\n                  backgroundColor: isActiveBeat(beat) && isPlaying\r\n                    ? theme.primary + '40'\r\n                    : isUpcomingBeat(beat)\r\n                      ? theme.secondary + '20'\r\n                      : isPastBeat(beat)\r\n                        ? theme.divider + '20'\r\n                        : 'transparent'\r\n                }\r\n              ]}\r\n              onPress={() => onSeekToTime(beat.time)}\r\n            >\r\n              {/* Chord symbol */}\r\n              {beat.isChordChange && beat.chord && (\r\n                <Text style={[\r\n                  styles.chordSymbol,\r\n                  {\r\n                    color: isActiveBeat(beat) \r\n                      ? theme.primary \r\n                      : isUpcomingBeat(beat)\r\n                        ? theme.secondary\r\n                        : theme.text,\r\n                    fontWeight: isActiveBeat(beat) ? 'bold' : 'normal'\r\n                  }\r\n                ]}>\r\n                  {beat.chord}\r\n                </Text>\r\n              )}\r\n              \r\n              {/* Beat indicator */}\r\n              <View style={[\r\n                styles.beatIndicator,\r\n                {\r\n                  backgroundColor: isActiveBeat(beat) && isPlaying\r\n                    ? theme.primary\r\n                    : beat.beatNumber === 1\r\n                      ? theme.text\r\n                      : theme.secondaryText,\r\n                  opacity: isActiveBeat(beat) && isPlaying ? 1 : 0.6,\r\n                  transform: isActiveBeat(beat) && isPlaying \r\n                    ? [{ scale: 1.2 }] \r\n                    : [{ scale: 1 }]\r\n                }\r\n              ]} />\r\n              \r\n              {/* Beat number */}\r\n              <Text style={[\r\n                styles.beatNumber,\r\n                {\r\n                  color: isActiveBeat(beat) \r\n                    ? theme.primary \r\n                    : theme.secondaryText,\r\n                  fontWeight: beat.beatNumber === 1 ? 'bold' : 'normal'\r\n                }\r\n              ]}>\r\n                {beat.beatNumber}\r\n              </Text>\r\n\r\n              {/* Playing indicator */}\r\n              {isActiveBeat(beat) && isPlaying && (\r\n                <View style={[styles.playingPulse, { backgroundColor: theme.primary }]} />\r\n              )}\r\n            </TouchableOpacity>\r\n          ))}\r\n        </View>\r\n      </View>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <View style={[styles.container, { backgroundColor: theme.surface }]}>\r\n      <View style={styles.header}>\r\n        <Text style={[styles.title, { color: theme.text }]}>\r\n          Rhythm Sheet   = 60 BPM\r\n        </Text>\r\n        <Text style={[styles.currentInfo, { color: theme.primary }]}>\r\n          {(() => {\r\n            const currentBeat = getCurrentBeat();\r\n            return currentBeat \r\n              ? `M${currentBeat.measure}  Beat ${currentBeat.beatNumber}`\r\n              : 'Ready to play';\r\n          })()}\r\n        </Text>\r\n      </View>\r\n      \r\n      <ScrollView\r\n        ref={scrollViewRef}\r\n        horizontal\r\n        showsHorizontalScrollIndicator={false}\r\n        style={styles.sheetScroll}\r\n        contentContainerStyle={styles.sheetContent}\r\n      >\r\n        {measureNumbers.map(measureNumber => \r\n          renderMeasure(measureNumber, measures[measureNumber])\r\n        )}\r\n      </ScrollView>\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    borderRadius: 12,\r\n    margin: 16,\r\n    marginTop: 8,\r\n    overflow: 'hidden',\r\n    elevation: 1,\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 1 },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 2,\r\n  },\r\n  header: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    padding: 12,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: 'rgba(255, 255, 255, 0.1)',\r\n  },\r\n  title: {\r\n    fontSize: 14,\r\n    fontWeight: 'bold',\r\n  },\r\n  currentInfo: {\r\n    fontSize: 12,\r\n    fontWeight: 'bold',\r\n    fontFamily: 'monospace',\r\n  },\r\n  sheetScroll: {\r\n    maxHeight: 100,\r\n  },\r\n  sheetContent: {\r\n    paddingLeft: 32, // Extra padding on left to ensure measure 1 is visible\r\n    paddingRight: 16,\r\n    paddingVertical: 12,\r\n  },\r\n  measure: {\r\n    width: 180,\r\n    marginRight: 8,\r\n    borderWidth: 1,\r\n    borderRadius: 8,\r\n    padding: 8,\r\n  },\r\n  measureNumber: {\r\n    fontSize: 10,\r\n    fontWeight: 'bold',\r\n    textAlign: 'center',\r\n    marginBottom: 4,\r\n  },\r\n  beatsRow: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-around',\r\n  },\r\n  beat: {\r\n    width: 35,\r\n    height: 50,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    borderRadius: 4,\r\n    position: 'relative',\r\n  },\r\n  chordSymbol: {\r\n    fontSize: 12,\r\n    fontWeight: 'bold',\r\n    marginBottom: 2,\r\n  },\r\n  beatIndicator: {\r\n    width: 6,\r\n    height: 6,\r\n    borderRadius: 3,\r\n    marginBottom: 2,\r\n  },\r\n  beatNumber: {\r\n    fontSize: 8,\r\n    fontWeight: 'bold',\r\n  },\r\n  playingPulse: {\r\n    position: 'absolute',\r\n    top: 2,\r\n    right: 2,\r\n    width: 8,\r\n    height: 8,\r\n    borderRadius: 4,\r\n  },\r\n});\r\n\r\nexport default EmbeddedRhythmSheet;\r\n","import React, { useEffect, useRef } from 'react';\r\nimport { Animated, Dimensions, StyleSheet, Text, View } from 'react-native';\r\n\r\n// Get screen dimensions for responsive sizing\r\nconst { width: screenWidth, height: screenHeight } = Dimensions.get('window');\r\n\r\nexport interface ChordFingering {\r\n  frets: number[]; // Fret numbers for each string (0 = open, -1 = muted)\r\n  fingers?: number[]; // Finger numbers (1-4, 0 = open, -1 = muted)\r\n  barres?: { fret: number; startString: number; endString: number }[]; // Barre chords\r\n  baseFret?: number; // Starting fret for display\r\n  name: string;\r\n  type: 'open' | 'barre' | 'movable';\r\n}\r\n\r\ninterface FretboardProps {\r\n  chord: string;\r\n  fingering: ChordFingering;\r\n  onFingeringChange?: (fingering: ChordFingering) => void;\r\n  theme: any;\r\n  size?: 'small' | 'medium' | 'large';\r\n  isHighlighted?: boolean;\r\n  animationDelay?: number;\r\n}\r\n\r\n// Enhanced sizing system for better mobile experience\r\nconst getSizeDimensions = (size: 'small' | 'medium' | 'large') => {\r\n  const baseWidth = Math.min(screenWidth * 0.85, 320); // Responsive to screen width\r\n  \r\n  switch (size) {\r\n    case 'small':\r\n      return {\r\n        width: baseWidth * 0.6,\r\n        height: (baseWidth * 0.6) * 1.3,\r\n        stringSpacing: (baseWidth * 0.6) / 7,\r\n        fretSpacing: ((baseWidth * 0.6) * 1.3) / 6,\r\n        dotSize: 14,\r\n        fontSize: 10\r\n      };\r\n    case 'medium':\r\n      return {\r\n        width: baseWidth * 0.75,\r\n        height: (baseWidth * 0.75) * 1.3,\r\n        stringSpacing: (baseWidth * 0.75) / 7,\r\n        fretSpacing: ((baseWidth * 0.75) * 1.3) / 6,\r\n        dotSize: 18,\r\n        fontSize: 12\r\n      };\r\n    case 'large':\r\n      return {\r\n        width: baseWidth,\r\n        height: baseWidth * 1.3,\r\n        stringSpacing: baseWidth / 7,\r\n        fretSpacing: (baseWidth * 1.3) / 6,\r\n        dotSize: 22,\r\n        fontSize: 14\r\n      };\r\n  }\r\n};\r\n\r\nexport const Fretboard: React.FC<FretboardProps> = ({ \r\n  chord, \r\n  fingering, \r\n  onFingeringChange, \r\n  theme, \r\n  size = 'medium',\r\n  isHighlighted = false,\r\n  animationDelay = 0\r\n}) => {\r\n  const strings = ['E', 'A', 'D', 'G', 'B', 'E']; // From 6th to 1st string\r\n  const maxFrets = 4; // Standard chord diagrams show 4 frets\r\n  const baseFret = fingering.baseFret || 1;\r\n  const dimensions = getSizeDimensions(size);\r\n  \r\n  // Animation for highlighting\r\n  const highlightAnim = useRef(new Animated.Value(0)).current;\r\n  const pulseAnim = useRef(new Animated.Value(1)).current;\r\n\r\n  // Trigger highlight animation when isHighlighted changes\r\n  useEffect(() => {\r\n    if (isHighlighted) {\r\n      setTimeout(() => {\r\n        Animated.parallel([\r\n          Animated.timing(highlightAnim, {\r\n            toValue: 1,\r\n            duration: 300,\r\n            useNativeDriver: false,\r\n          }),\r\n          Animated.loop(\r\n            Animated.sequence([\r\n              Animated.timing(pulseAnim, {\r\n                toValue: 1.05,\r\n                duration: 600,\r\n                useNativeDriver: true,\r\n              }),\r\n              Animated.timing(pulseAnim, {\r\n                toValue: 1,\r\n                duration: 600,\r\n                useNativeDriver: true,\r\n              }),\r\n            ]),\r\n            { iterations: -1 }\r\n          ),\r\n        ]).start();\r\n      }, animationDelay);\r\n    } else {\r\n      pulseAnim.stopAnimation();\r\n      Animated.parallel([\r\n        Animated.timing(highlightAnim, {\r\n          toValue: 0,\r\n          duration: 200,\r\n          useNativeDriver: false,\r\n        }),\r\n        Animated.timing(pulseAnim, {\r\n          toValue: 1,\r\n          duration: 200,\r\n          useNativeDriver: true,\r\n        }),\r\n      ]).start();\r\n    }\r\n  }, [isHighlighted, animationDelay, highlightAnim, pulseAnim]);\r\n\r\n  return (\r\n    <Animated.View style={[\r\n      styles.container,\r\n      {\r\n        width: dimensions.width,\r\n        height: dimensions.height,\r\n        transform: [{ scale: pulseAnim }],\r\n      }\r\n    ]}>\r\n      <Animated.View style={[\r\n        styles.fretboardContainer, \r\n        { \r\n          width: dimensions.width, \r\n          height: dimensions.height,\r\n          backgroundColor: theme.surface + '20',\r\n          borderRadius: 12,\r\n          padding: 8,\r\n          elevation: isHighlighted ? 6 : 2,\r\n          shadowColor: theme.primary || '#007AFF',\r\n          shadowOffset: { width: 0, height: 2 },\r\n          shadowOpacity: isHighlighted ? 0.4 : 0.1,\r\n          shadowRadius: isHighlighted ? 8 : 4,\r\n          borderWidth: highlightAnim.interpolate({\r\n            inputRange: [0, 1],\r\n            outputRange: [1, 3],\r\n            extrapolate: 'clamp',\r\n          }),\r\n          borderColor: highlightAnim.interpolate({\r\n            inputRange: [0, 1],\r\n            outputRange: [theme.divider || '#E0E0E0', theme.primary || '#007AFF'],\r\n            extrapolate: 'clamp',\r\n          }),\r\n        }\r\n      ]}>\r\n        {/* Fretboard background with wood texture feel */}\r\n        <View style={[\r\n          styles.fretboardBackground,\r\n          {\r\n            width: dimensions.width - 16,\r\n            height: dimensions.height - 16,\r\n            backgroundColor: '#F5DEB3',\r\n            borderRadius: 8,\r\n            position: 'absolute',\r\n            top: 8,\r\n            left: 8,\r\n          }\r\n        ]} />\r\n        \r\n        {/* Chord name at top */}\r\n        <Text\r\n          style={[\r\n            styles.chordNameTop,\r\n            {\r\n              color: theme.text,\r\n              fontSize: dimensions.fontSize + 2,\r\n              fontWeight: 'bold',\r\n              textAlign: 'center',\r\n              marginBottom: 8,\r\n            }\r\n          ]}\r\n        >\r\n          {chord}\r\n        </Text>\r\n        \r\n        {/* Nut (thick line at the beginning for open chords) */}\r\n        <View\r\n          style={[\r\n            styles.nut,\r\n            {\r\n              backgroundColor: baseFret === 1 ? '#8B4513' : 'transparent',\r\n              height: (strings.length - 1) * dimensions.stringSpacing + 10,\r\n              width: baseFret === 1 ? 5 : 0,\r\n              left: 25,\r\n              top: 35,\r\n              borderRadius: 2,\r\n            }\r\n          ]}\r\n        />\r\n        \r\n        {/* Frets */}\r\n        {Array.from({ length: maxFrets + 1 }, (_, fretIndex) => (\r\n          <View\r\n            key={`fret-${fretIndex}`}\r\n            style={[\r\n              styles.fretLine,\r\n              {\r\n                height: (strings.length - 1) * dimensions.stringSpacing + 10,\r\n                width: fretIndex === 0 ? (baseFret === 1 ? 0 : 2.5) : 1.5,\r\n                backgroundColor: fretIndex === 0 && baseFret > 1 \r\n                  ? theme.text \r\n                  : '#C0C0C0',\r\n                left: 30 + (fretIndex * dimensions.fretSpacing),\r\n                top: 35,\r\n                borderRadius: 0.75,\r\n                elevation: 1,\r\n              }\r\n            ]}\r\n          />\r\n        ))}\r\n        \r\n        {/* Strings with realistic thickness */}\r\n        {strings.map((stringName, stringIndex) => {\r\n          const stringThickness = stringIndex < 2 ? 2.5 : stringIndex < 4 ? 1.8 : 1.2;\r\n          return (\r\n            <View\r\n              key={`string-${stringIndex}`}\r\n              style={[\r\n                styles.stringLine,\r\n                {\r\n                  width: maxFrets * dimensions.fretSpacing + 15,\r\n                  height: stringThickness,\r\n                  backgroundColor: '#666',\r\n                  left: 25,\r\n                  top: 35 + (stringIndex * dimensions.stringSpacing),\r\n                  borderRadius: stringThickness / 2,\r\n                }\r\n              ]}\r\n            />\r\n          );\r\n        })}\r\n        \r\n        {/* String labels */}\r\n        {strings.map((stringName, stringIndex) => (\r\n          <Text\r\n            key={`label-${stringIndex}`}\r\n            style={[\r\n              styles.stringLabel,\r\n              {\r\n                color: theme.text,\r\n                fontSize: dimensions.fontSize - 1,\r\n                fontWeight: '600',\r\n                left: 8,\r\n                top: 30 + (stringIndex * dimensions.stringSpacing),\r\n                textAlign: 'center',\r\n                width: 12,\r\n              }\r\n            ]}\r\n          >\r\n            {stringName}\r\n          </Text>\r\n        ))}\r\n        \r\n        {/* Fret number indicator */}\r\n        {baseFret > 1 && (\r\n          <Text\r\n            style={[\r\n              styles.baseFretNumber,\r\n              {\r\n                color: theme.text,\r\n                fontSize: dimensions.fontSize,\r\n                fontWeight: 'bold',\r\n                left: 35 + (dimensions.fretSpacing / 2),\r\n                top: 15,\r\n                textAlign: 'center',\r\n              }\r\n            ]}\r\n          >\r\n            {baseFret}fr\r\n          </Text>\r\n        )}\r\n        \r\n        {/* Open string indicators */}\r\n        {fingering.frets.map((fret, stringIndex) => {\r\n          if (fret !== 0) return null;\r\n          \r\n          return (\r\n            <View\r\n              key={`open-${stringIndex}`}\r\n              style={[\r\n                styles.openStringIndicator,\r\n                {\r\n                  width: dimensions.dotSize * 0.7,\r\n                  height: dimensions.dotSize * 0.7,\r\n                  borderRadius: (dimensions.dotSize * 0.7) / 2,\r\n                  borderWidth: 2,\r\n                  borderColor: theme.primary || '#007AFF',\r\n                  backgroundColor: 'transparent',\r\n                  left: 30 - (dimensions.dotSize * 0.35),\r\n                  top: 35 + (stringIndex * dimensions.stringSpacing) - (dimensions.dotSize * 0.35),\r\n                }\r\n              ]}\r\n            />\r\n          );\r\n        })}\r\n        \r\n        {/* Muted string indicators */}\r\n        {fingering.frets.map((fret, stringIndex) => {\r\n          if (fret !== -1) return null;\r\n          \r\n          return (\r\n            <Text\r\n              key={`muted-${stringIndex}`}\r\n              style={[\r\n                styles.mutedIndicator,\r\n                {\r\n                  fontSize: dimensions.fontSize + 1,\r\n                  color: '#FF3B30',\r\n                  fontWeight: 'bold',\r\n                  left: 30 - (dimensions.fontSize / 2),\r\n                  top: 27 + (stringIndex * dimensions.stringSpacing),\r\n                  textAlign: 'center',\r\n                  width: dimensions.fontSize,\r\n                }\r\n              ]}\r\n            >\r\n              \r\n            </Text>\r\n          );\r\n        })}\r\n        \r\n        {/* Finger positions */}\r\n        {fingering.frets.map((fret, stringIndex) => {\r\n          if (fret <= 0) return null;\r\n          \r\n          const fretPosition = fret - baseFret + 1;\r\n          if (fretPosition < 1 || fretPosition > maxFrets) return null;\r\n          \r\n          const x = 30 + (fretPosition * dimensions.fretSpacing) - (dimensions.fretSpacing / 2);\r\n          const y = 35 + (stringIndex * dimensions.stringSpacing) - (dimensions.dotSize / 2);\r\n          const fingerNumber = fingering.fingers?.[stringIndex] || '';\r\n          \r\n          return (\r\n            <View\r\n              key={`finger-${stringIndex}`}\r\n              style={[\r\n                styles.fingerDot,\r\n                {\r\n                  width: dimensions.dotSize,\r\n                  height: dimensions.dotSize,\r\n                  borderRadius: dimensions.dotSize / 2,\r\n                  backgroundColor: theme.primary || '#007AFF',\r\n                  left: x,\r\n                  top: y,\r\n                  borderWidth: 2,\r\n                  borderColor: '#fff',\r\n                  elevation: 3,\r\n                  shadowColor: '#000',\r\n                  shadowOffset: { width: 0, height: 1 },\r\n                  shadowOpacity: 0.3,\r\n                  shadowRadius: 2,\r\n                  justifyContent: 'center',\r\n                  alignItems: 'center',\r\n                }\r\n              ]}\r\n            >\r\n              {fingerNumber > 0 && (\r\n                <Text\r\n                  style={[\r\n                    styles.fingerNumber,\r\n                    {\r\n                      fontSize: dimensions.fontSize - 3,\r\n                      color: '#fff',\r\n                      fontWeight: 'bold',\r\n                      textAlign: 'center',\r\n                    }\r\n                  ]}\r\n                >\r\n                  {fingerNumber}\r\n                </Text>\r\n              )}\r\n            </View>\r\n          );\r\n        })}\r\n        \r\n        {/* Barre indicators */}\r\n        {fingering.barres?.map((barre, index) => {\r\n          const fretPosition = barre.fret - baseFret + 1;\r\n          if (fretPosition < 1 || fretPosition > maxFrets) return null;\r\n          \r\n          const startY = 35 + (barre.startString * dimensions.stringSpacing);\r\n          const endY = 35 + (barre.endString * dimensions.stringSpacing);\r\n          const x = 30 + (fretPosition * dimensions.fretSpacing) - (dimensions.fretSpacing / 2);\r\n          \r\n          return (\r\n            <View\r\n              key={`barre-${index}`}\r\n              style={[\r\n                styles.barreIndicator,\r\n                {\r\n                  width: dimensions.dotSize * 0.6,\r\n                  height: Math.abs(endY - startY) + dimensions.dotSize,\r\n                  backgroundColor: theme.primary || '#007AFF',\r\n                  left: x - (dimensions.dotSize * 0.3),\r\n                  top: Math.min(startY, endY) - (dimensions.dotSize / 2),\r\n                  borderRadius: dimensions.dotSize * 0.3,\r\n                  borderWidth: 1,\r\n                  borderColor: '#fff',\r\n                  elevation: 2,\r\n                }\r\n              ]}\r\n            />\r\n          );\r\n        })}\r\n        \r\n        {/* Fingering type indicator */}\r\n        <Text\r\n          style={[\r\n            styles.fingeringType,\r\n            {\r\n              color: theme.secondaryText || '#666',\r\n              fontSize: dimensions.fontSize - 2,\r\n              textAlign: 'center',\r\n              position: 'absolute',\r\n              bottom: 8,\r\n              width: dimensions.width - 16,\r\n              left: 8,\r\n              fontStyle: 'italic',\r\n            }\r\n          ]}\r\n        >\r\n          {fingering.type}  {fingering.name}\r\n        </Text>\r\n      </Animated.View>\r\n    </Animated.View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n  fretboardContainer: {\r\n    position: 'relative',\r\n  },\r\n  fretboardBackground: {\r\n    // Background styling handled inline for responsiveness\r\n  },\r\n  chordNameTop: {\r\n    marginTop: 4,\r\n  },\r\n  nut: {\r\n    position: 'absolute',\r\n  },\r\n  fretLine: {\r\n    position: 'absolute',\r\n  },\r\n  stringLine: {\r\n    position: 'absolute',\r\n  },\r\n  stringLabel: {\r\n    position: 'absolute',\r\n  },\r\n  baseFretNumber: {\r\n    position: 'absolute',\r\n  },\r\n  openStringIndicator: {\r\n    position: 'absolute',\r\n  },\r\n  mutedIndicator: {\r\n    position: 'absolute',\r\n  },\r\n  fingerDot: {\r\n    position: 'absolute',\r\n  },\r\n  fingerNumber: {\r\n    // Finger number styling handled inline\r\n  },\r\n  barreIndicator: {\r\n    position: 'absolute',\r\n  },\r\n  fingeringType: {\r\n    // Fingering type styling handled inline\r\n  },\r\n});\r\n\r\nexport default Fretboard;\r\n","import React, { useCallback, useEffect, useImperativeHandle, useRef, useState } from 'react';\r\nimport { Platform, StyleSheet, Text, View } from 'react-native';\r\n\r\n// Import YouTube iframe component for native platforms only\r\nlet YoutubeIframe: any = null;\r\nif (Platform.OS !== 'web') {\r\n  try {\r\n    YoutubeIframe = require('react-native-youtube-iframe').default;\r\n    console.log(' YouTube iframe loaded for native platform');\r\n  } catch (e) {\r\n    console.log(' YouTube iframe not available for native:', e);\r\n  }\r\n}\r\n\r\ninterface UnifiedYouTubePlayerProps {\r\n  videoId: string;\r\n  height?: number;\r\n  width?: number | string;\r\n  playing?: boolean;\r\n  onChangeState?: (state: string) => void;\r\n  onError?: (error: string) => void;\r\n  onTimeUpdate?: (time: number) => void;\r\n  onPlayingChange?: (playing: boolean) => void;\r\n  autoplay?: boolean;\r\n  muted?: boolean;\r\n  loop?: boolean;\r\n  controls?: boolean;\r\n}\r\n\r\nexport interface YouTubePlayerRef {\r\n  play: () => void;\r\n  pause: () => void;\r\n  seekTo: (time: number) => void;\r\n  getCurrentTime: () => Promise<number>;\r\n}\r\n\r\n// YouTube Player Component with iframe-based implementation\r\nconst UnifiedYouTubePlayer = React.forwardRef<YouTubePlayerRef, UnifiedYouTubePlayerProps>(({\r\n  videoId,\r\n  height = 200,\r\n  width = '100%',\r\n  playing = false,\r\n  onChangeState,\r\n  onError,\r\n  onTimeUpdate,\r\n  onPlayingChange,\r\n  autoplay = false,\r\n  muted = false,\r\n  loop = false,\r\n  controls = true,\r\n}, ref) => {\r\n  const [currentTime, setCurrentTime] = useState(0);\r\n  const [isPlayerPlaying, setIsPlayerPlaying] = useState(false);\r\n  const timeUpdateInterval = useRef<NodeJS.Timeout | null>(null);\r\n  const startPlayTime = useRef<number>(0);\r\n\r\n  // Real YouTube API time tracking with fallback to simple tracking\r\n  const startTimeTracking = useCallback(() => {\r\n    if (timeUpdateInterval.current) {\r\n      clearInterval(timeUpdateInterval.current);\r\n    }\r\n    \r\n    console.log(' Starting YouTube time tracking from:', currentTime);\r\n    startPlayTime.current = Date.now() - (currentTime * 1000); // Account for current position\r\n    \r\n    timeUpdateInterval.current = setInterval(() => {\r\n      // Try to get actual YouTube player time first\r\n      if (Platform.OS === 'web' && typeof window !== 'undefined') {\r\n        try {\r\n          const iframe = document.querySelector(`iframe[src*=\"${videoId}\"]`) as HTMLIFrameElement;\r\n          if (iframe && iframe.contentWindow) {\r\n            // Request current time from YouTube player\r\n            iframe.contentWindow.postMessage('{\"event\":\"command\",\"func\":\"getCurrentTime\",\"args\":\"\"}', '*');\r\n          }\r\n        } catch (e) {\r\n          console.warn('Could not get YouTube time, using fallback:', e);\r\n        }\r\n      }\r\n      \r\n      // Fallback: use elapsed time tracking\r\n      const elapsed = (Date.now() - startPlayTime.current) / 1000;\r\n      setCurrentTime(elapsed);\r\n      onTimeUpdate?.(elapsed);\r\n    }, 250); // Update every 250ms for better accuracy\r\n  }, [currentTime, onTimeUpdate, videoId]);\r\n\r\n  const stopTimeTracking = useCallback(() => {\r\n    console.log(' Stopping time tracking');\r\n    if (timeUpdateInterval.current) {\r\n      clearInterval(timeUpdateInterval.current);\r\n      timeUpdateInterval.current = null;\r\n    }\r\n  }, []);\r\n\r\n  // Handle seeking to specific time\r\n  const seekToTime = useCallback((time: number) => {\r\n    console.log(' Seeking to time:', time);\r\n    setCurrentTime(time);\r\n    onTimeUpdate?.(time);\r\n    \r\n    // If playing, restart time tracking from new position\r\n    if (isPlayerPlaying) {\r\n      startTimeTracking();\r\n    }\r\n  }, [onTimeUpdate, isPlayerPlaying, startTimeTracking]);\r\n\r\n  // Handle play/pause state changes\r\n  const handlePlayStateChange = useCallback((shouldPlay: boolean) => {\r\n    console.log(' Play state change:', shouldPlay);\r\n    setIsPlayerPlaying(shouldPlay);\r\n    onPlayingChange?.(shouldPlay);\r\n    \r\n    if (shouldPlay) {\r\n      startTimeTracking();\r\n    } else {\r\n      stopTimeTracking();\r\n    }\r\n  }, [startTimeTracking, stopTimeTracking, onPlayingChange]);\r\n\r\n  // Listen for actual iframe events to detect YouTube player state changes\r\n  useEffect(() => {\r\n    if (Platform.OS === 'web' && typeof window !== 'undefined') {\r\n      const handleMessage = (event: MessageEvent) => {\r\n        try {\r\n          const data = JSON.parse(event.data);\r\n          if (data.event === 'video-state-change') {\r\n            console.log(' YouTube iframe state change:', data.info);\r\n            const isPlaying = data.info === 1; // 1 = playing in YouTube API\r\n            if (isPlaying !== isPlayerPlaying) {\r\n              handlePlayStateChange(isPlaying);\r\n            }\r\n          } else if (data.event === 'video-time-update' || data.event === 'infoDelivery') {\r\n            // Handle both time updates and getCurrentTime responses\r\n            if (data.info && typeof data.info === 'number') {\r\n              console.log(' YouTube iframe time update:', data.info);\r\n              setCurrentTime(data.info);\r\n              onTimeUpdate?.(data.info);\r\n            } else if (data.info && data.info.currentTime !== undefined) {\r\n              console.log(' YouTube iframe getCurrentTime:', data.info.currentTime);\r\n              setCurrentTime(data.info.currentTime);\r\n              onTimeUpdate?.(data.info.currentTime);\r\n            }\r\n          }\r\n        } catch (e) {\r\n          // Ignore non-JSON messages\r\n        }\r\n      };\r\n\r\n      window.addEventListener('message', handleMessage);\r\n      return () => window.removeEventListener('message', handleMessage);\r\n    }\r\n  }, [isPlayerPlaying, handlePlayStateChange, onTimeUpdate]);\r\n\r\n  // React to playing prop changes\r\n  useEffect(() => {\r\n    if (playing !== isPlayerPlaying) {\r\n      handlePlayStateChange(playing);\r\n    }\r\n  }, [playing, isPlayerPlaying, handlePlayStateChange]);\r\n\r\n  // Expose player methods through ref\r\n  useImperativeHandle(ref, () => ({\r\n    play: () => {\r\n      console.log(' YouTube player play() called');\r\n      setIsPlayerPlaying(true);\r\n      onPlayingChange?.(true);\r\n      startTimeTracking();\r\n      \r\n      // Also try to control iframe if on web\r\n      if (Platform.OS === 'web' && typeof window !== 'undefined') {\r\n        try {\r\n          const iframe = document.querySelector(`iframe[src*=\"${videoId}\"]`) as HTMLIFrameElement;\r\n          if (iframe && iframe.contentWindow) {\r\n            iframe.contentWindow.postMessage('{\"event\":\"command\",\"func\":\"playVideo\",\"args\":\"\"}', '*');\r\n          }\r\n        } catch (e) {\r\n          console.warn('Could not control iframe directly:', e);\r\n        }\r\n      }\r\n    },\r\n    pause: () => {\r\n      console.log(' YouTube player pause() called');\r\n      setIsPlayerPlaying(false);\r\n      onPlayingChange?.(false);\r\n      stopTimeTracking();\r\n      \r\n      // Also try to control iframe if on web\r\n      if (Platform.OS === 'web' && typeof window !== 'undefined') {\r\n        try {\r\n          const iframe = document.querySelector(`iframe[src*=\"${videoId}\"]`) as HTMLIFrameElement;\r\n          if (iframe && iframe.contentWindow) {\r\n            iframe.contentWindow.postMessage('{\"event\":\"command\",\"func\":\"pauseVideo\",\"args\":\"\"}', '*');\r\n          }\r\n        } catch (e) {\r\n          console.warn('Could not control iframe directly:', e);\r\n        }\r\n      }\r\n    },\r\n    seekTo: (time: number) => {\r\n      seekToTime(time);\r\n      \r\n      // Also try to control iframe if on web\r\n      if (Platform.OS === 'web' && typeof window !== 'undefined') {\r\n        try {\r\n          const iframe = document.querySelector(`iframe[src*=\"${videoId}\"]`) as HTMLIFrameElement;\r\n          if (iframe && iframe.contentWindow) {\r\n            iframe.contentWindow.postMessage(`{\"event\":\"command\",\"func\":\"seekTo\",\"args\":[${time}, true]}`, '*');\r\n          }\r\n        } catch (e) {\r\n          console.warn('Could not control iframe directly:', e);\r\n        }\r\n      }\r\n    },\r\n    getCurrentTime: async (): Promise<number> => {\r\n      return currentTime;\r\n    },\r\n  }), [currentTime, onPlayingChange, startTimeTracking, stopTimeTracking, seekToTime, videoId]);\r\n\r\n  const onStateChange = useCallback((state: string) => {\r\n    onChangeState?.(state);\r\n    \r\n    // Notify parent of playing state changes\r\n    const isPlaying = state === 'playing';\r\n    handlePlayStateChange(isPlaying);\r\n  }, [onChangeState, handlePlayStateChange]);\r\n\r\n  const onPlayerError = useCallback((error: string) => {\r\n    console.error('YouTube Player Error:', error);\r\n    onError?.(error);\r\n  }, [onError]);\r\n\r\n  // Cleanup on unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      stopTimeTracking();\r\n    };\r\n  }, [stopTimeTracking]);\r\n\r\n  // Universal iframe implementation - works on both web and native\r\n  const params = new URLSearchParams({\r\n    autoplay: autoplay ? '1' : '0',\r\n    mute: muted ? '1' : '0',\r\n    controls: controls ? '1' : '0',\r\n    loop: loop ? '1' : '0',\r\n    rel: '0', // Don't show related videos\r\n    modestbranding: '1', // Hide YouTube logo\r\n    playsinline: '1', // Play inline on iOS\r\n    enablejsapi: '1', // Enable JS API for control\r\n    origin: Platform.OS === 'web' ? window.location.origin : undefined,\r\n  }).toString();\r\n\r\n  // Validate video ID format (YouTube video IDs are typically 11 characters, but some can be longer)\r\n  // Accept both 11-character video IDs and longer IDs for various YouTube content types\r\n  const isValidVideoId = videoId && /^[a-zA-Z0-9_-]{11,}$/.test(videoId.trim());\r\n\r\n  console.log('Video ID validation result:', isValidVideoId, 'for videoId:', videoId);\r\n\r\n  if (!isValidVideoId) {\r\n    console.warn('Invalid YouTube video ID format:', videoId, 'Length:', videoId?.length);\r\n  }\r\n\r\n  console.log('UnifiedYouTubePlayer received videoId:', videoId);\r\n  console.log('Video ID length:', videoId?.length);\r\n  console.log('Video ID type:', typeof videoId);\r\n\r\n  return (\r\n    <View style={[styles.container, { height, width }]}>\r\n      {Platform.OS === 'web' ? (\r\n        // Web-specific iframe implementation\r\n        videoId ? (\r\n          <View style={{ position: 'relative' }}>\r\n            {React.createElement('iframe', {\r\n              title: `YouTube video ${videoId}`,\r\n              width: '100%',\r\n              height: height,\r\n              src: `https://www.youtube.com/embed/${videoId.trim()}?${params}&enablejsapi=1&origin=${Platform.OS === 'web' && typeof window !== 'undefined' ? window.location.origin : ''}`,\r\n              frameBorder: '0',\r\n              allow: 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture',\r\n              allowFullScreen: true,\r\n              style: { borderRadius: 12 },\r\n              onLoad: () => {\r\n                console.log('YouTube iframe loaded successfully for video:', videoId);\r\n                \r\n                // Auto-start if playing prop is true\r\n                if (playing) {\r\n                  setTimeout(() => {\r\n                    handlePlayStateChange(true);\r\n                  }, 1000); // Give iframe time to initialize\r\n                }\r\n              },\r\n              onError: (e: any) => {\r\n                console.error('YouTube iframe error for video:', videoId, e);\r\n                onError?.('Failed to load YouTube video');\r\n              }\r\n            })}\r\n            {/* Add a debug overlay to show video info */}\r\n            {!isValidVideoId && (\r\n              <View style={styles.debugOverlay}>\r\n                <Text style={styles.debugText}>Video ID: {videoId}</Text>\r\n                <Text style={styles.debugText}>Length: {videoId?.length}</Text>\r\n                <Text style={styles.debugText}>Valid: {String(isValidVideoId)}</Text>\r\n              </View>\r\n            )}\r\n          </View>\r\n        ) : (\r\n          <View style={styles.fallback}>\r\n            <Text style={styles.fallbackTitle}> Missing Video ID</Text>\r\n            <Text style={styles.fallbackText}>No video ID provided</Text>\r\n            <Text style={styles.fallbackSubText}>\r\n              Unable to load video\r\n            </Text>\r\n            <Text style={styles.fallbackHint}>\r\n              Please check the video URL\r\n            </Text>\r\n          </View>\r\n        )\r\n      ) : (\r\n        // Native implementation using react-native-youtube-iframe\r\n        YoutubeIframe ? (\r\n          <YoutubeIframe\r\n            height={height}\r\n            play={playing}\r\n            videoId={videoId}\r\n            onChangeState={(state: string) => {\r\n              console.log('Native YouTube state change:', state);\r\n              onStateChange(state);\r\n              const isPlaying = state === 'playing';\r\n              handlePlayStateChange(isPlaying);\r\n            }}\r\n            onError={(error: string) => {\r\n              console.error('Native YouTube error:', error);\r\n              onPlayerError(error);\r\n            }}\r\n            allowWebViewZoom={false}\r\n            webViewStyle={{ borderRadius: 12 }}\r\n            initialPlayerParams={{\r\n              controls: controls,\r\n              modestbranding: true,\r\n              rel: false,\r\n            }}\r\n          />\r\n        ) : (\r\n          // Fallback for devices without YouTube iframe support\r\n          <View style={styles.fallback}>\r\n            <Text style={styles.fallbackTitle}> YouTube Player</Text>\r\n            <Text style={styles.fallbackText}>Video ID: {videoId}</Text>\r\n            <Text style={styles.fallbackSubText}>\r\n              Install react-native-youtube-iframe for native support\r\n            </Text>\r\n            <Text style={styles.fallbackHint}>\r\n              Try opening in the YouTube app\r\n            </Text>\r\n          </View>\r\n        )\r\n      )}\r\n    </View>\r\n  );\r\n});\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    backgroundColor: '#000',\r\n    borderRadius: 12,\r\n    overflow: 'hidden',\r\n    elevation: 4,\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 2 },\r\n    shadowOpacity: 0.25,\r\n    shadowRadius: 3.84,\r\n  },\r\n  webView: {\r\n    backgroundColor: '#000',\r\n    borderRadius: 12,\r\n  },\r\n  fallback: {\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    backgroundColor: '#1a1a1a',\r\n    borderWidth: 2,\r\n    borderColor: '#333',\r\n    borderStyle: 'dashed',\r\n  },\r\n  fallbackTitle: {\r\n    color: '#fff',\r\n    fontSize: 18,\r\n    fontWeight: 'bold',\r\n    textAlign: 'center',\r\n    marginBottom: 8,\r\n  },\r\n  fallbackText: {\r\n    color: '#ccc',\r\n    fontSize: 14,\r\n    textAlign: 'center',\r\n    marginBottom: 4,\r\n    fontFamily: 'monospace',\r\n  },\r\n  fallbackSubText: {\r\n    color: '#888',\r\n    fontSize: 12,\r\n    textAlign: 'center',\r\n    marginBottom: 8,\r\n  },\r\n  fallbackHint: {\r\n    color: '#666',\r\n    fontSize: 11,\r\n    textAlign: 'center',\r\n    fontStyle: 'italic',\r\n  },\r\n  debugOverlay: {\r\n    position: 'absolute',\r\n    top: 0,\r\n    right: 0,\r\n    backgroundColor: 'rgba(255, 0, 0, 0.8)',\r\n    padding: 4,\r\n    borderRadius: 4,\r\n    zIndex: 1000,\r\n  },\r\n  debugText: {\r\n    color: '#fff',\r\n    fontSize: 10,\r\n    fontFamily: 'monospace',\r\n  },\r\n});\r\n\r\nexport default UnifiedYouTubePlayer;\r\n","import React, { useCallback, useEffect, useRef, useState } from 'react';\r\nimport {\r\n  FlatList, Modal, ScrollView, StyleSheet, Text,\r\n  TouchableOpacity, View\r\n} from 'react-native';\r\nimport { useTheme } from '../context/ThemeContext';\r\nimport { CHORD_LIBRARY } from '../utils/chordLibrary';\r\nimport CompactRhythmTimeline from './CompactRhythmTimeline';\r\nimport EmbeddedRhythmSheet from './EmbeddedRhythmSheet';\r\nimport { ChordFingering, Fretboard } from './Fretboard.Enhanced';\r\nimport UnifiedYouTubePlayer, { YouTubePlayerRef } from './UnifiedYouTubePlayer';\r\n\r\ninterface ChordTiming {\r\n  chord: string;\r\n  startTime: number; // in seconds\r\n  duration: number; // in seconds\r\n}\r\n\r\ninterface SynchronizedChordPlayerProps {\r\n  videoId: string;\r\n  songTitle: string;\r\n  chordProgression: ChordTiming[];\r\n  onBack?: () => void;\r\n}\r\n\r\nexport const SynchronizedChordPlayer: React.FC<SynchronizedChordPlayerProps> = ({\r\n  videoId,\r\n  songTitle,\r\n  chordProgression,\r\n  onBack,\r\n}) => {\r\n  const { theme } = useTheme();\r\n  const [isPlaying, setIsPlaying] = useState(false);\r\n  const [currentTime, setCurrentTime] = useState(0);\r\n  const [currentChordIndex, setCurrentChordIndex] = useState(0);\r\n  const [isLooping, setIsLooping] = useState(false);\r\n  const [fingeringStyle, setFingeringStyle] = useState<'open' | 'barre' | 'movable'>('open');\r\n  const [fingeringLocked, setFingeringLocked] = useState(false);\r\n  const [showFingeringModal, setShowFingeringModal] = useState(false);\r\n  const [fretboardSize, setFretboardSize] = useState<'small' | 'medium' | 'large'>('large');\r\n  const [forcePlayerState, setForcePlayerState] = useState<'play' | 'pause' | 'idle'>('idle');\r\n  const [timingOffset, setTimingOffset] = useState(0); // Offset in seconds to align chords with song\r\n\r\n  const playerRef = useRef<YouTubePlayerRef>(null);\r\n\r\n  // Get current chord based on YouTube player time with improved accuracy and silence detection\r\n  const getCurrentChord = useCallback(() => {\r\n    if (chordProgression.length === 0) return null;\r\n    \r\n    // Apply timing offset\r\n    const adjustedTime = currentTime + timingOffset;\r\n    \r\n    // Find chord that should be playing at current time\r\n    const activeChord = chordProgression.find((chord, index) => {\r\n      const chordEndTime = chord.startTime + chord.duration;\r\n      const isInTimeRange = adjustedTime >= chord.startTime && adjustedTime < chordEndTime;\r\n      \r\n      if (isInTimeRange) {\r\n        console.log(` Current chord at ${adjustedTime.toFixed(1)}s: ${chord.chord} (${chord.startTime}s - ${chordEndTime.toFixed(1)}s)`);\r\n      }\r\n      \r\n      return isInTimeRange;\r\n    });\r\n    \r\n    // If no chord is found, we might be in a silence period\r\n    if (!activeChord) {\r\n      console.log(` No chord at ${adjustedTime.toFixed(1)}s - likely silence period`);\r\n    }\r\n    \r\n    return activeChord || null; // Return null instead of first chord when in silence\r\n  }, [currentTime, chordProgression, timingOffset]);\r\n\r\n  // Get next chord for preview\r\n  const getNextChord = useCallback(() => {\r\n    if (chordProgression.length === 0) return null;\r\n    \r\n    // Apply timing offset\r\n    const adjustedTime = currentTime + timingOffset;\r\n    \r\n    const currentIndex = chordProgression.findIndex(chord => {\r\n      const chordEndTime = chord.startTime + chord.duration;\r\n      return adjustedTime >= chord.startTime && adjustedTime < chordEndTime;\r\n    });\r\n    \r\n    return currentIndex >= 0 && currentIndex < chordProgression.length - 1 \r\n      ? chordProgression[currentIndex + 1] \r\n      : null;\r\n  }, [currentTime, chordProgression, timingOffset]);\r\n\r\n  // Update current chord index based on time with better tracking\r\n  useEffect(() => {\r\n    if (chordProgression.length === 0) return;\r\n    \r\n    // Apply timing offset to current time for chord matching\r\n    const adjustedTime = currentTime + timingOffset;\r\n    \r\n    // Find chord that should be playing at current time\r\n    const activeChordIndex = chordProgression.findIndex(chord => {\r\n      const chordEndTime = chord.startTime + chord.duration;\r\n      return adjustedTime >= chord.startTime && adjustedTime < chordEndTime;\r\n    });\r\n    \r\n    if (activeChordIndex !== -1 && activeChordIndex !== currentChordIndex) {\r\n      const activeChord = chordProgression[activeChordIndex];\r\n      console.log(' Chord progression update:', {\r\n        time: currentTime.toFixed(1),\r\n        adjustedTime: adjustedTime.toFixed(1),\r\n        chord: activeChord.chord,\r\n        index: activeChordIndex + 1,\r\n        total: chordProgression.length,\r\n        chordStart: activeChord.startTime,\r\n        chordEnd: (activeChord.startTime + activeChord.duration).toFixed(1),\r\n        nextChord: chordProgression[activeChordIndex + 1]?.chord || 'End'\r\n      });\r\n      setCurrentChordIndex(activeChordIndex);\r\n    } else if (activeChordIndex === -1 && currentChordIndex !== -1) {\r\n      // We're in a silence period\r\n      console.log(' Entering silence period at', adjustedTime.toFixed(1));\r\n      setCurrentChordIndex(-1);\r\n    }\r\n  }, [currentTime, chordProgression, currentChordIndex, timingOffset]);\r\n\r\n  // Handle YouTube player time updates - this syncs with actual video playback\r\n  const handlePlayerTimeUpdate = useCallback((time: number) => {\r\n    // Add debugging to see if time updates are being received\r\n    if (time % 2 < 0.5) { // Log every 2 seconds to avoid spam\r\n      console.log(' SynchronizedChordPlayer received time update:', time.toFixed(1));\r\n    }\r\n    setCurrentTime(time);\r\n  }, []);\r\n\r\n  // Handle YouTube player state changes\r\n  const handlePlayerStateChange = useCallback((playing: boolean) => {\r\n    console.log('SynchronizedChordPlayer state change - playing:', playing);\r\n    \r\n    // If YouTube starts playing but our state says not playing, sync up\r\n    if (playing && !isPlaying) {\r\n      console.log(' YouTube started playing - syncing chord player state');\r\n      setIsPlaying(true);\r\n    } else if (!playing && isPlaying) {\r\n      console.log(' YouTube paused - syncing chord player state');\r\n      setIsPlaying(false);\r\n    }\r\n    \r\n    if (playing && !fingeringLocked) {\r\n      setFingeringLocked(true);\r\n    }\r\n  }, [fingeringLocked, isPlaying]);\r\n\r\n  // Force player state changes when buttons are pressed\r\n  useEffect(() => {\r\n    if (forcePlayerState === 'play' && playerRef.current) {\r\n      console.log(' Forcing player to play');\r\n      playerRef.current.play();\r\n      setForcePlayerState('idle');\r\n    } else if (forcePlayerState === 'pause' && playerRef.current) {\r\n      console.log(' Forcing player to pause');\r\n      playerRef.current.pause();\r\n      setForcePlayerState('idle');\r\n    }\r\n  }, [forcePlayerState]);\r\n\r\n  // Get chord fingering based on style preference\r\n  const getChordFingering = useCallback((chordName: string): ChordFingering | null => {\r\n    const chordDef = CHORD_LIBRARY[chordName];\r\n    if (!chordDef || !chordDef.fingerings.length) {\r\n      console.warn('No chord definition found for:', chordName);\r\n      return null;\r\n    }\r\n\r\n    // Find fingering based on preferred style\r\n    const preferredFingering = chordDef.fingerings.find(f => f.type === fingeringStyle);\r\n    const result = preferredFingering || chordDef.fingerings[0];\r\n    console.log('Found fingering for', chordName, ':', result);\r\n    return result;\r\n  }, [fingeringStyle]);\r\n\r\n  const handleStartOver = () => {\r\n    console.log(' Starting over - resetting to beginning');\r\n    // Reset player and time\r\n    if (playerRef.current) {\r\n      playerRef.current.seekTo(0);\r\n    }\r\n    setCurrentTime(0);\r\n    setCurrentChordIndex(0);\r\n    setIsPlaying(false);\r\n    setForcePlayerState('pause');\r\n  };\r\n\r\n  const handleLoop = () => {\r\n    setIsLooping(!isLooping);\r\n    // Note: Loop will be handled by the YouTube player's onStateChange\r\n  };\r\n\r\n  // Handle seeking to specific chord\r\n  const handleSeekToChord = (chordIndex: number) => {\r\n    const chord = chordProgression[chordIndex];\r\n    if (chord && playerRef.current) {\r\n      playerRef.current.seekTo(chord.startTime);\r\n      setCurrentTime(chord.startTime);\r\n      setCurrentChordIndex(chordIndex);\r\n    }\r\n  };\r\n\r\n  const renderChordProgress = () => {\r\n    return (\r\n      <View style={styles.progressContainer}>\r\n        <ScrollView horizontal showsHorizontalScrollIndicator={false}>\r\n          {chordProgression.map((item, index) => {\r\n            const isActive = index === currentChordIndex;\r\n            const isPast = currentTime > item.startTime + item.duration;\r\n            const isUpcoming = currentTime < item.startTime;\r\n            \r\n            return (\r\n              <TouchableOpacity\r\n                key={index}\r\n                style={[\r\n                  styles.chordProgressItem,\r\n                  {\r\n                    backgroundColor: isActive \r\n                      ? theme.primary \r\n                      : isPast \r\n                        ? theme.primary + '40'\r\n                        : theme.surface,\r\n                    borderColor: isActive ? theme.primary : theme.divider,\r\n                  }\r\n                ]}\r\n                onPress={() => handleSeekToChord(index)}\r\n              >\r\n                <Text style={[\r\n                  styles.chordProgressText,\r\n                  { \r\n                    color: isActive ? '#fff' : theme.text,\r\n                    fontWeight: isActive ? 'bold' : 'normal'\r\n                  }\r\n                ]}>\r\n                  {item.chord}\r\n                </Text>\r\n                <Text style={[\r\n                  styles.chordTimeText,\r\n                  { color: isActive ? '#fff' : theme.secondaryText }\r\n                ]}>\r\n                  {Math.floor(item.startTime)}s\r\n                </Text>\r\n              </TouchableOpacity>\r\n            );\r\n          })}\r\n        </ScrollView>\r\n      </View>\r\n    );\r\n  };\r\n\r\n  const renderFingeringModal = () => {\r\n    const currentChord = getCurrentChord();\r\n    if (!currentChord) return null;\r\n\r\n    const chordDef = CHORD_LIBRARY[currentChord.chord];\r\n    if (!chordDef) return null;\r\n\r\n    return (\r\n      <Modal\r\n        visible={showFingeringModal}\r\n        transparent\r\n        animationType=\"slide\"\r\n        onRequestClose={() => setShowFingeringModal(false)}\r\n      >\r\n        <View style={styles.modalOverlay}>\r\n          <View style={[styles.modalContent, { backgroundColor: theme.surface }]}>\r\n            <View style={styles.modalHeader}>\r\n              <Text style={[styles.modalTitle, { color: theme.text }]}>\r\n                Choose {currentChord.chord} Fingering Style\r\n              </Text>\r\n              <TouchableOpacity\r\n                onPress={() => setShowFingeringModal(false)}\r\n                style={styles.closeButton}\r\n              >\r\n                <Text style={[styles.closeButtonText, { color: theme.text }]}></Text>\r\n              </TouchableOpacity>\r\n            </View>\r\n\r\n            <FlatList\r\n              data={chordDef.fingerings}\r\n              keyExtractor={(item, index) => `${item.type}-${index}`}\r\n              renderItem={({ item, index }) => (\r\n                <TouchableOpacity\r\n                  style={[\r\n                    styles.fingeringOption,\r\n                    {\r\n                      backgroundColor: fingeringStyle === item.type ? theme.primary + '20' : 'transparent',\r\n                      borderColor: fingeringStyle === item.type ? theme.primary : theme.divider,\r\n                    }\r\n                  ]}\r\n                  onPress={() => {\r\n                    setFingeringStyle(item.type);\r\n                    setShowFingeringModal(false);\r\n                  }}\r\n                >\r\n                  <View style={styles.fingeringPreview}>\r\n                    <Fretboard\r\n                      chord={currentChord.chord}\r\n                      fingering={item}\r\n                      theme={theme}\r\n                      size=\"small\"\r\n                    />\r\n                  </View>\r\n                  <Text style={[styles.fingeringLabel, { color: theme.text }]}>\r\n                    {item.type.charAt(0).toUpperCase() + item.type.slice(1)} - {item.name}\r\n                  </Text>\r\n                </TouchableOpacity>\r\n              )}\r\n            />\r\n          </View>\r\n        </View>\r\n      </Modal>\r\n    );\r\n  };\r\n\r\n  const currentChord = getCurrentChord();\r\n  const currentFingering = currentChord ? getChordFingering(currentChord.chord) : null;\r\n\r\n  return (\r\n    <View style={[styles.container, { backgroundColor: theme.background }]}>\r\n      {/* Header */}\r\n      <View style={[styles.header, { backgroundColor: theme.surface }]}>\r\n        <TouchableOpacity onPress={onBack} style={styles.backButton}>\r\n          <Text style={[styles.backButtonText, { color: theme.primary }]}> Back</Text>\r\n        </TouchableOpacity>\r\n        <Text style={[styles.songTitle, { color: theme.text }]} numberOfLines={2}>\r\n          {songTitle}\r\n        </Text>\r\n        <Text style={{ color: theme.secondaryText, fontSize: 12, fontFamily: 'monospace' }}>\r\n          Debug: {currentTime.toFixed(1)}s | Chord {currentChordIndex + 1}/{chordProgression.length} | Playing: {isPlaying ? 'Yes' : 'No'} | Offset: {timingOffset > 0 ? '+' : ''}{timingOffset}s\r\n          {chordProgression[currentChordIndex] && (\r\n            <Text> | Current: {chordProgression[currentChordIndex].chord} ({chordProgression[currentChordIndex].startTime}s)</Text>\r\n          )}\r\n        </Text>\r\n      </View>\r\n\r\n      <ScrollView style={styles.content}>\r\n        {/* YouTube Player */}\r\n        <View style={styles.playerContainer}>\r\n          <UnifiedYouTubePlayer\r\n            ref={playerRef}\r\n            videoId={videoId}\r\n            height={200}\r\n            playing={isPlaying}\r\n            onTimeUpdate={handlePlayerTimeUpdate}\r\n            onPlayingChange={handlePlayerStateChange}\r\n            onChangeState={(state) => {\r\n              console.log('Player state changed:', state);\r\n            }}\r\n          />\r\n        </View>\r\n\r\n        {/* Controls */}\r\n        <View style={[styles.controls, { backgroundColor: theme.surface }]}>\r\n          <TouchableOpacity\r\n            style={[\r\n              styles.controlButton, \r\n              { \r\n                backgroundColor: isPlaying ? theme.secondary : theme.primary,\r\n                flex: 1 \r\n              }\r\n            ]}\r\n            onPress={() => {\r\n              console.log(' Play/Pause button pressed, current state:', isPlaying);\r\n              if (isPlaying) {\r\n                // Pause playback\r\n                console.log(' Pausing playback');\r\n                setIsPlaying(false);\r\n                setForcePlayerState('pause');\r\n              } else {\r\n                // Start playback and chord progression\r\n                console.log(' Starting synchronized playback');\r\n                setIsPlaying(true);\r\n                setForcePlayerState('play');\r\n              }\r\n            }}\r\n          >\r\n            <Text style={styles.controlButtonText}>\r\n              {isPlaying ? ' Pause' : ' Start Playing'} \r\n            </Text>\r\n          </TouchableOpacity>\r\n\r\n          <TouchableOpacity\r\n            style={[styles.controlButton, { backgroundColor: theme.secondary }]}\r\n            onPress={handleStartOver}\r\n          >\r\n            <Text style={styles.controlButtonText}> Start Over</Text>\r\n          </TouchableOpacity>\r\n\r\n          <TouchableOpacity\r\n            style={[\r\n              styles.controlButton,\r\n              { backgroundColor: isLooping ? theme.primary : theme.secondary }\r\n            ]}\r\n            onPress={handleLoop}\r\n          >\r\n            <Text style={styles.controlButtonText}> Loop</Text>\r\n          </TouchableOpacity>\r\n\r\n          {!fingeringLocked && (\r\n            <TouchableOpacity\r\n              style={[styles.controlButton, { backgroundColor: theme.primary }]}\r\n              onPress={() => setShowFingeringModal(true)}\r\n            >\r\n              <Text style={styles.controlButtonText}> Style</Text>\r\n            </TouchableOpacity>\r\n          )}\r\n\r\n          {/* Timing adjustment controls */}\r\n          <TouchableOpacity\r\n            style={[styles.controlButton, { backgroundColor: theme.secondary }]}\r\n            onPress={() => setTimingOffset(offset => Math.max(-10, offset - 0.5))}\r\n          >\r\n            <Text style={styles.controlButtonText}> -0.5s</Text>\r\n          </TouchableOpacity>\r\n\r\n          <TouchableOpacity\r\n            style={[styles.controlButton, { backgroundColor: theme.secondary }]}\r\n            onPress={() => setTimingOffset(offset => Math.min(10, offset + 0.5))}\r\n          >\r\n            <Text style={styles.controlButtonText}> +0.5s</Text>\r\n          </TouchableOpacity>\r\n\r\n          {timingOffset !== 0 && (\r\n            <TouchableOpacity\r\n              style={[styles.controlButton, { backgroundColor: '#ff6b6b' }]}\r\n              onPress={() => setTimingOffset(0)}\r\n            >\r\n              <Text style={styles.controlButtonText}> Reset</Text>\r\n            </TouchableOpacity>\r\n          )}\r\n        </View>\r\n\r\n        {/* Unified View: Rhythm Timeline + Sheet + Fretboard */}\r\n        \r\n        {/* Compact Rhythm Timeline */}\r\n        <CompactRhythmTimeline\r\n          chordProgression={chordProgression}\r\n          currentTime={currentTime + timingOffset}\r\n          isPlaying={isPlaying}\r\n          theme={theme}\r\n          onSeekToTime={(time) => {\r\n            if (playerRef.current) {\r\n              playerRef.current.seekTo(time - timingOffset); // Adjust for offset when seeking\r\n              setCurrentTime(time - timingOffset);\r\n            }\r\n          }}\r\n        />\r\n\r\n        {/* Embedded Rhythm Sheet */}\r\n        <EmbeddedRhythmSheet\r\n          chordProgression={chordProgression}\r\n          currentTime={currentTime + timingOffset}\r\n          isPlaying={isPlaying}\r\n          theme={theme}\r\n          onSeekToTime={(time) => {\r\n            if (playerRef.current) {\r\n              playerRef.current.seekTo(time - timingOffset); // Adjust for offset when seeking\r\n              setCurrentTime(time - timingOffset);\r\n            }\r\n          }}\r\n        />\r\n\r\n        {/* Current Chord Display with Next Chord Preview */}\r\n        {(() => {\r\n          const currentChord = getCurrentChord();\r\n          const nextChord = getNextChord();\r\n          const currentFingering = currentChord ? getChordFingering(currentChord.chord) : null;\r\n          const nextFingering = nextChord ? getChordFingering(nextChord.chord) : null;\r\n          \r\n          // Show silence indicator when no chord is playing\r\n          if (!currentChord) {\r\n            return (\r\n              <View style={[styles.chordDisplay, { backgroundColor: theme.surface }]}>\r\n                <Text style={[styles.currentChordLabel, { color: theme.secondaryText }]}>\r\n                   Silence Period\r\n                </Text>\r\n                <Text style={[styles.fingeringStyle, { color: theme.secondaryText }]}>\r\n                  No chords playing - this might be an instrumental break or quiet section\r\n                </Text>\r\n                {nextChord && (\r\n                  <View style={styles.nextChordPreview}>\r\n                    <Text style={[styles.nextChordLabel, { color: theme.text }]}>\r\n                      Next chord: {nextChord.chord} at {nextChord.startTime}s\r\n                    </Text>\r\n                  </View>\r\n                )}\r\n              </View>\r\n            );\r\n          }\r\n          \r\n          return currentFingering ? (\r\n              <View style={[styles.chordDisplay, { backgroundColor: theme.surface }]}>\r\n                <View style={styles.currentNextContainer}>\r\n                  {/* Current Chord */}\r\n                  <View style={styles.currentChordSection}>\r\n                    <Text style={[styles.currentChordLabel, { color: theme.text }]}>\r\n                      Now Playing\r\n                    </Text>\r\n                    <Text style={[styles.chordName, { color: theme.primary }]}>\r\n                      {currentChord.chord}\r\n                    </Text>\r\n                    <View style={styles.fretboardContainer}>\r\n                      <Fretboard\r\n                        chord={currentChord.chord}\r\n                        fingering={currentFingering}\r\n                        theme={theme}\r\n                        size={fretboardSize}\r\n                        isHighlighted={isPlaying}\r\n                        animationDelay={0}\r\n                      />\r\n                    </View>\r\n                  </View>\r\n\r\n                  {/* Next Chord Preview */}\r\n                  {nextChord && nextFingering && (\r\n                    <View style={styles.nextChordSection}>\r\n                      <Text style={[styles.nextChordLabel, { color: theme.secondaryText }]}>\r\n                        Next Up\r\n                      </Text>\r\n                      <Text style={[styles.nextChordName, { color: theme.text }]}>\r\n                        {nextChord.chord}\r\n                      </Text>\r\n                      <Text style={[styles.nextChordTime, { color: theme.secondaryText }]}>\r\n                        in {Math.max(0, Math.floor(nextChord.startTime - currentTime))}s\r\n                      </Text>\r\n                      <View style={styles.nextFretboardContainer}>\r\n                        <Fretboard\r\n                          chord={nextChord.chord}\r\n                          fingering={nextFingering}\r\n                          theme={theme}\r\n                          size=\"small\"\r\n                          isHighlighted={false}\r\n                          animationDelay={0}\r\n                        />\r\n                      </View>\r\n                    </View>\r\n                  )}\r\n                </View>\r\n\r\n                <Text style={[styles.fingeringStyle, { color: theme.secondaryText }]}>\r\n                  {fingeringStyle.charAt(0).toUpperCase() + fingeringStyle.slice(1)} Style\r\n                  {fingeringLocked && ' (Locked)'}\r\n                </Text>\r\n\r\n                {/* Fretboard Size Controls */}\r\n                <View style={styles.sizeControls}>\r\n                  {(['small', 'medium', 'large'] as const).map((size) => (\r\n                    <TouchableOpacity\r\n                      key={size}\r\n                      style={[\r\n                        styles.sizeButton,\r\n                        {\r\n                          backgroundColor: fretboardSize === size ? theme.primary : theme.secondary,\r\n                        }\r\n                      ]}\r\n                      onPress={() => setFretboardSize(size)}\r\n                    >\r\n                      <Text style={styles.sizeButtonText}>\r\n                        {size.charAt(0).toUpperCase() + size.slice(1)}\r\n                      </Text>\r\n                    </TouchableOpacity>\r\n                  ))}\r\n                </View>\r\n              </View>\r\n              ) : null;\r\n            })()}\r\n      </ScrollView>\r\n\r\n      {renderFingeringModal()}\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n  },\r\n  header: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    padding: 16,\r\n    paddingTop: 50,\r\n    elevation: 2,\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 2 },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 4,\r\n  },\r\n  backButton: {\r\n    marginRight: 16,\r\n  },\r\n  backButtonText: {\r\n    fontSize: 16,\r\n    fontWeight: 'bold',\r\n  },\r\n  songTitle: {\r\n    flex: 1,\r\n    fontSize: 18,\r\n    fontWeight: 'bold',\r\n  },\r\n  content: {\r\n    flex: 1,\r\n  },\r\n  playerContainer: {\r\n    margin: 16,\r\n    borderRadius: 12,\r\n    overflow: 'hidden',\r\n  },\r\n  controls: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-around',\r\n    padding: 16,\r\n    marginHorizontal: 16,\r\n    borderRadius: 12,\r\n    marginBottom: 16,\r\n  },\r\n  controlButton: {\r\n    paddingHorizontal: 16,\r\n    paddingVertical: 12,\r\n    borderRadius: 8,\r\n    minWidth: 80,\r\n    alignItems: 'center',\r\n  },\r\n  controlButtonText: {\r\n    color: '#fff',\r\n    fontWeight: 'bold',\r\n    fontSize: 12,\r\n  },\r\n  progressContainer: {\r\n    marginHorizontal: 16,\r\n    marginBottom: 16,\r\n  },\r\n  chordProgressItem: {\r\n    padding: 12,\r\n    marginRight: 8,\r\n    borderRadius: 8,\r\n    borderWidth: 2,\r\n    minWidth: 60,\r\n    alignItems: 'center',\r\n  },\r\n  chordProgressText: {\r\n    fontSize: 16,\r\n    fontWeight: 'bold',\r\n  },\r\n  chordTimeText: {\r\n    fontSize: 10,\r\n    marginTop: 2,\r\n  },\r\n  chordDisplay: {\r\n    margin: 16,\r\n    padding: 20,\r\n    borderRadius: 12,\r\n    alignItems: 'center',\r\n  },\r\n  currentChordLabel: {\r\n    fontSize: 24,\r\n    fontWeight: 'bold',\r\n    marginBottom: 8,\r\n  },\r\n  fingeringStyle: {\r\n    fontSize: 14,\r\n    marginBottom: 20,\r\n  },\r\n  fretboardContainer: {\r\n    alignItems: 'center',\r\n    marginBottom: 20,\r\n  },\r\n  sizeControls: {\r\n    flexDirection: 'row',\r\n    gap: 8,\r\n  },\r\n  sizeButton: {\r\n    paddingHorizontal: 12,\r\n    paddingVertical: 6,\r\n    borderRadius: 6,\r\n  },\r\n  sizeButtonText: {\r\n    color: '#fff',\r\n    fontWeight: 'bold',\r\n    fontSize: 12,\r\n  },\r\n  modalOverlay: {\r\n    flex: 1,\r\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  modalContent: {\r\n    width: '90%',\r\n    maxHeight: '80%',\r\n    borderRadius: 12,\r\n    padding: 20,\r\n  },\r\n  modalHeader: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginBottom: 20,\r\n  },\r\n  modalTitle: {\r\n    fontSize: 18,\r\n    fontWeight: 'bold',\r\n    flex: 1,\r\n  },\r\n  closeButton: {\r\n    padding: 4,\r\n  },\r\n  closeButtonText: {\r\n    fontSize: 20,\r\n    fontWeight: 'bold',\r\n  },\r\n  fingeringOption: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    padding: 12,\r\n    borderRadius: 8,\r\n    borderWidth: 1,\r\n    marginBottom: 8,\r\n  },\r\n  fingeringPreview: {\r\n    marginRight: 16,\r\n  },\r\n  fingeringLabel: {\r\n    flex: 1,\r\n    fontSize: 16,\r\n  },\r\n  chordPreviewSection: {\r\n    margin: 16,\r\n    padding: 16,\r\n    borderRadius: 12,\r\n  },\r\n  sectionTitle: {\r\n    fontSize: 18,\r\n    fontWeight: 'bold',\r\n    marginBottom: 12,\r\n    textAlign: 'center',\r\n  },\r\n  chordPreviewContainer: {\r\n    flexDirection: 'row',\r\n  },\r\n  chordPreviewItem: {\r\n    alignItems: 'center',\r\n    marginRight: 16,\r\n    padding: 8,\r\n    minWidth: 80,\r\n  },\r\n  previewChordName: {\r\n    fontSize: 14,\r\n    fontWeight: '600',\r\n    marginBottom: 4,\r\n  },\r\n  previewTimeText: {\r\n    fontSize: 10,\r\n    marginBottom: 8,\r\n  },\r\n  miniatureFretboard: {\r\n    borderWidth: 2,\r\n    borderRadius: 8,\r\n    padding: 4,\r\n  },\r\n  currentNextContainer: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'flex-start',\r\n    marginBottom: 20,\r\n  },\r\n  currentChordSection: {\r\n    flex: 2,\r\n    alignItems: 'center',\r\n    marginRight: 16,\r\n  },\r\n  nextChordSection: {\r\n    flex: 1,\r\n    alignItems: 'center',\r\n    padding: 12,\r\n    backgroundColor: 'rgba(255, 255, 255, 0.05)',\r\n    borderRadius: 8,\r\n    borderWidth: 1,\r\n    borderColor: 'rgba(255, 255, 255, 0.1)',\r\n  },\r\n  chordName: {\r\n    fontSize: 32,\r\n    fontWeight: 'bold',\r\n    marginBottom: 16,\r\n  },\r\n  nextChordLabel: {\r\n    fontSize: 12,\r\n    textTransform: 'uppercase',\r\n    marginBottom: 4,\r\n  },\r\n  nextChordName: {\r\n    fontSize: 18,\r\n    fontWeight: 'bold',\r\n    marginBottom: 4,\r\n  },\r\n  nextChordTime: {\r\n    fontSize: 11,\r\n    marginBottom: 8,\r\n  },\r\n  nextFretboardContainer: {\r\n    alignItems: 'center',\r\n  },\r\n  nextIndicator: {\r\n    fontSize: 8,\r\n    fontWeight: 'bold',\r\n    marginTop: 2,\r\n  },\r\n  progressIndicator: {\r\n    marginTop: 16,\r\n    paddingHorizontal: 16,\r\n  },\r\n  progressText: {\r\n    fontSize: 12,\r\n    textAlign: 'center',\r\n    marginBottom: 8,\r\n  },\r\n  progressBar: {\r\n    height: 4,\r\n    borderRadius: 2,\r\n    overflow: 'hidden',\r\n  },\r\n  progressFill: {\r\n    height: '100%',\r\n    borderRadius: 2,\r\n  },\r\n  nextChordPreview: {\r\n    marginTop: 16,\r\n    padding: 12,\r\n    backgroundColor: 'rgba(255, 255, 255, 0.05)',\r\n    borderRadius: 8,\r\n    alignItems: 'center',\r\n  },\r\n});\r\n\r\nexport default SynchronizedChordPlayer;\r\n","import React, { useEffect, useState } from 'react';\r\nimport { ActivityIndicator, StyleSheet, Text, View } from 'react-native';\r\nimport { analyzeChords, ChordData } from '../api/chords';\r\nimport { SynchronizedChordPlayer } from '../components/SynchronizedChordPlayer';\r\n\r\ninterface ChordTiming {\r\n  chord: string;\r\n  startTime: number;\r\n  duration: number;\r\n}\r\n\r\nconst ChordPlayerScreen = ({ route, navigation }: any) => {\r\n  const { youtubeUrl, songTitle, thumbnail, channel } = route.params;\r\n  const [chordProgression, setChordProgression] = useState<ChordTiming[]>([]);\r\n  const [isAnalyzing, setIsAnalyzing] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  \r\n  // Extract video ID from YouTube URL\r\n  const getVideoId = (url: string) => {\r\n    const match = url.match(/(?:youtube\\.com\\/watch\\?v=|youtu\\.be\\/)([^&\\n?#]+)/);\r\n    return match ? match[1] : '';\r\n  };\r\n\r\n  // Convert ChordData to ChordTiming format\r\n  const convertToChordTiming = (chordData: ChordData[]): ChordTiming[] => {\r\n    return chordData.map((chord, index) => {\r\n      const nextChord = chordData[index + 1];\r\n      const duration = nextChord ? nextChord.time - chord.time : 4; // Default 4 seconds for last chord\r\n      \r\n      return {\r\n        chord: chord.chord,\r\n        startTime: chord.time,\r\n        duration: Math.max(0.5, duration), // Minimum 0.5 seconds\r\n      };\r\n    });\r\n  };\r\n\r\n  // Generate realistic chord progression based on song analysis with silence detection\r\n  const generateRealisticProgression = (songTitle: string, duration: number = 240): ChordTiming[] => {\r\n    console.log(' Generating chord progression for:', songTitle);\r\n    \r\n    // Song structures with verses, chorus, bridge patterns and silence periods\r\n    const songStructures = {\r\n      hotel_california: {\r\n        intro: ['Am', 'E', 'G', 'D', 'F', 'C', 'Dm', 'E'],\r\n        verse: ['Am', 'E', 'G', 'D', 'F', 'C', 'Dm', 'E'],\r\n        chorus: ['F', 'C', 'E', 'Am', 'F', 'C', 'Dm', 'E'],\r\n        bridge: ['Am', 'E', 'G', 'D', 'F', 'C', 'Dm', 'E'],\r\n        outro: ['Am', 'E', 'G', 'D', 'F', 'C', 'Dm', 'E', 'Am'],\r\n        silencePeriods: [\r\n          { start: 0, end: 8 },      // Quiet intro\r\n          { start: 120, end: 125 },  // Brief pause mid-song\r\n          { start: 200, end: 210 }   // Outro fade\r\n        ]\r\n      },\r\n      wonderwall: {\r\n        intro: ['Em7', 'G', 'D', 'C'],\r\n        verse: ['Em7', 'G', 'D', 'C', 'Em7', 'G', 'D', 'C'],\r\n        chorus: ['C', 'D', 'G', 'Em7', 'C', 'D', 'G', 'G'],\r\n        bridge: ['C', 'D', 'G', 'Em7', 'C', 'D', 'Em7', 'Em7'],\r\n        outro: ['Em7', 'G', 'D', 'C', 'Em7'],\r\n        silencePeriods: [\r\n          { start: 0, end: 4 },      // Short intro\r\n          { start: 180, end: 190 }   // Outro fade\r\n        ]\r\n      },\r\n      default: {\r\n        intro: ['C', 'G', 'Am', 'F'],\r\n        verse: ['C', 'G', 'Am', 'F', 'C', 'G', 'F', 'C'],\r\n        chorus: ['F', 'C', 'G', 'Am', 'F', 'C', 'G', 'G'],\r\n        bridge: ['Am', 'F', 'C', 'G', 'Am', 'F', 'G', 'G'],\r\n        outro: ['C', 'G', 'Am', 'F', 'C'],\r\n        silencePeriods: [\r\n          { start: 0, end: 2 },      // Brief intro\r\n          { start: 160, end: 170 }   // Outro fade\r\n        ]\r\n      }\r\n    };\r\n\r\n    // Detect song structure\r\n    const title = songTitle.toLowerCase();\r\n    let structure = songStructures.default;\r\n    \r\n    if (title.includes('hotel') || title.includes('california')) {\r\n      structure = songStructures.hotel_california;\r\n      console.log(' Using Hotel California structure');\r\n    } else if (title.includes('wonderwall')) {\r\n      structure = songStructures.wonderwall;\r\n      console.log(' Using Wonderwall structure');\r\n    } else {\r\n      console.log(' Using default structure');\r\n    }\r\n\r\n    // Create full song progression with typical song structure\r\n    const fullProgression: string[] = [];\r\n    \r\n    // Intro (8-16 seconds)\r\n    fullProgression.push(...structure.intro);\r\n    console.log('After intro:', fullProgression.length, 'chords');\r\n    \r\n    // Verse 1 (16-32 seconds)  \r\n    fullProgression.push(...structure.verse);\r\n    console.log('After verse 1:', fullProgression.length, 'chords');\r\n    \r\n    // Chorus 1 (16-24 seconds)\r\n    fullProgression.push(...structure.chorus);\r\n    console.log('After chorus 1:', fullProgression.length, 'chords');\r\n    \r\n    // Verse 2 (16-32 seconds)\r\n    fullProgression.push(...structure.verse);\r\n    console.log('After verse 2:', fullProgression.length, 'chords');\r\n    \r\n    // Chorus 2 (16-24 seconds)\r\n    fullProgression.push(...structure.chorus);\r\n    console.log('After chorus 2:', fullProgression.length, 'chords');\r\n    \r\n    // Bridge/Solo (16-32 seconds)\r\n    fullProgression.push(...structure.bridge);\r\n    console.log('After bridge:', fullProgression.length, 'chords');\r\n    \r\n    // Final Chorus (16-24 seconds)\r\n    fullProgression.push(...structure.chorus);\r\n    console.log('After final chorus:', fullProgression.length, 'chords');\r\n    \r\n    // Outro (8-16 seconds)\r\n    fullProgression.push(...structure.outro);\r\n    console.log('Final progression length:', fullProgression.length, 'chords');\r\n\r\n    // Convert to timed progression with silence detection\r\n    const chords: ChordTiming[] = [];\r\n    let currentTime = 0;\r\n    \r\n    // Helper function to check if a time is in a silence period\r\n    const isInSilencePeriod = (time: number): boolean => {\r\n      if (!structure.silencePeriods) return false;\r\n      return structure.silencePeriods.some(period => \r\n        time >= period.start && time < period.end\r\n      );\r\n    };\r\n    \r\n    fullProgression.forEach((chord, index) => {\r\n      // Skip adding chord if we're in a silence period\r\n      if (isInSilencePeriod(currentTime)) {\r\n        console.log(` Skipping chord ${chord} at ${currentTime}s - in silence period`);\r\n        currentTime += 2; // Short gap during silence\r\n        return;\r\n      }\r\n      \r\n      // More realistic chord duration based on song section and musical timing\r\n      let chordDuration = 4; // Base duration (one measure in 4/4 time)\r\n      \r\n      // Intro chords often last longer for atmosphere\r\n      if (index < structure.intro.length) {\r\n        chordDuration = Math.random() > 0.5 ? 8 : 6; // 2 measures or 1.5 measures\r\n      }\r\n      // Outro chords fade out slowly\r\n      else if (index >= fullProgression.length - structure.outro.length) {\r\n        chordDuration = Math.random() > 0.3 ? 8 : 6;\r\n      }\r\n      // Verse chords are steady\r\n      else if (index < structure.intro.length + structure.verse.length * 2) {\r\n        chordDuration = Math.random() > 0.8 ? 2 : 4; // Occasional quick changes\r\n      }\r\n      // Chorus chords can be varied for energy\r\n      else {\r\n        const rand = Math.random();\r\n        if (rand > 0.9) chordDuration = 2;      // Quick change (half measure)\r\n        else if (rand > 0.7) chordDuration = 8; // Long chord (two measures)\r\n        else chordDuration = 4;                 // Standard (one measure)\r\n      }\r\n      \r\n      chords.push({\r\n        chord,\r\n        startTime: currentTime,\r\n        duration: chordDuration,\r\n      });\r\n      \r\n      currentTime += chordDuration;\r\n    });\r\n    \r\n    // Filter out any chords that would be entirely in silence periods\r\n    const filteredChords = chords.filter(chord => {\r\n      const chordEnd = chord.startTime + chord.duration;\r\n      // Keep chord if any part of it is NOT in a silence period\r\n      for (let t = chord.startTime; t < chordEnd; t += 0.5) {\r\n        if (!isInSilencePeriod(t)) {\r\n          return true;\r\n        }\r\n      }\r\n      return false;\r\n    });\r\n    \r\n    console.log('Generated chord progression:', filteredChords.length, 'chords, total duration:', currentTime, 'seconds');\r\n    console.log('Silence periods:', structure.silencePeriods || 'None');\r\n    console.log('Filtered out', chords.length - filteredChords.length, 'chords in silence periods');\r\n    console.log('Structure used:', {\r\n      intro: structure.intro.length,\r\n      verse: structure.verse.length,\r\n      chorus: structure.chorus.length,\r\n      bridge: structure.bridge.length,\r\n      outro: structure.outro.length\r\n    });\r\n    console.log('First 10 chords:', filteredChords.slice(0, 10));\r\n    console.log('Last 10 chords:', filteredChords.slice(-10));\r\n    \r\n    return filteredChords;\r\n  };\r\n\r\n  // Analyze chords when component mounts\r\n  useEffect(() => {\r\n    const analyzeVideo = async () => {\r\n      try {\r\n        setIsAnalyzing(true);\r\n        setError(null);\r\n        \r\n        // Try to get real chord analysis\r\n        const chordData = await analyzeChords(youtubeUrl);\r\n        \r\n        if (chordData.length < 10) { // Minimum threshold for realistic song\r\n          console.log(' API returned insufficient chords:', chordData.length, '- using fallback');\r\n          // Generate realistic progression based on song title\r\n          const realisticProgression = generateRealisticProgression(songTitle, 180);\r\n          console.log('Generated realistic progression:', realisticProgression);\r\n          setChordProgression(realisticProgression);\r\n        } else {\r\n          console.log(' Using API chord data:', chordData.length, 'chords');\r\n          const chordTiming = convertToChordTiming(chordData);\r\n          console.log('Converted chord timing:', chordTiming);\r\n          setChordProgression(chordTiming);\r\n        }\r\n      } catch (error) {\r\n        console.error('Chord analysis failed:', error);\r\n        setError(error instanceof Error ? error.message : 'Analysis failed');\r\n        \r\n        // Generate realistic fallback based on song title\r\n        const realisticProgression = generateRealisticProgression(songTitle, 180);\r\n        console.log('Fallback realistic progression:', realisticProgression);\r\n        setChordProgression(realisticProgression);\r\n      } finally {\r\n        setIsAnalyzing(false);\r\n      }\r\n    };\r\n\r\n    analyzeVideo();\r\n  }, [youtubeUrl]);\r\n\r\n  const videoId = getVideoId(youtubeUrl);\r\n\r\n  if (isAnalyzing) {\r\n    return (\r\n      <View style={styles.loadingContainer}>\r\n        <ActivityIndicator size=\"large\" color=\"#007bff\" />\r\n        <Text style={styles.loadingText}>Analyzing chord progression...</Text>\r\n        <Text style={styles.loadingSubtext}>This may take a few moments</Text>\r\n      </View>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <View style={styles.errorContainer}>\r\n        <Text style={styles.errorText}>Analysis Error</Text>\r\n        <Text style={styles.errorMessage}>{error}</Text>\r\n        <Text style={styles.errorSubtext}>Using fallback chord progression</Text>\r\n      </View>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <View style={styles.container}>\r\n      <SynchronizedChordPlayer\r\n        videoId={videoId}\r\n        songTitle={songTitle}\r\n        chordProgression={chordProgression}\r\n        onBack={() => navigation.goBack()}\r\n      />\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n  },\r\n  loadingContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    backgroundColor: '#1a1a1a',\r\n    padding: 20,\r\n  },\r\n  loadingText: {\r\n    color: '#fff',\r\n    fontSize: 18,\r\n    fontWeight: '600',\r\n    marginTop: 20,\r\n    textAlign: 'center',\r\n  },\r\n  loadingSubtext: {\r\n    color: '#888',\r\n    fontSize: 14,\r\n    marginTop: 8,\r\n    textAlign: 'center',\r\n  },\r\n  errorContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    backgroundColor: '#1a1a1a',\r\n    padding: 20,\r\n  },\r\n  errorText: {\r\n    color: '#ff6b6b',\r\n    fontSize: 18,\r\n    fontWeight: '600',\r\n    marginBottom: 10,\r\n    textAlign: 'center',\r\n  },\r\n  errorMessage: {\r\n    color: '#fff',\r\n    fontSize: 14,\r\n    marginBottom: 10,\r\n    textAlign: 'center',\r\n  },\r\n  errorSubtext: {\r\n    color: '#888',\r\n    fontSize: 12,\r\n    textAlign: 'center',\r\n  },\r\n});\r\n\r\nexport default ChordPlayerScreen;","import { useNavigation } from '@react-navigation/native';\r\nimport { NativeStackNavigationProp } from '@react-navigation/native-stack';\r\nimport React from 'react';\r\nimport {\r\n  ScrollView, StyleSheet, Text, TouchableOpacity, View\r\n} from 'react-native';\r\nimport { useAuth } from '../context/AuthProvider';\r\nimport { RootStackParamList } from '../navigation/types';\r\n\r\ntype HomeScreenNavigationProp = NativeStackNavigationProp<\r\n  RootStackParamList,\r\n  'Home'\r\n>;\r\n\r\nexport default function HomeScreen() {\r\n  const navigation = useNavigation<HomeScreenNavigationProp>();\r\n  const { user, logout, isConnected, isLoading } = useAuth();\r\n\r\n  const handleAuthAction = () => {\r\n    if (user) {\r\n      logout();\r\n    } else {\r\n      navigation.navigate('Auth');\r\n    }\r\n  };\r\n\r\n  const handleSearchPress = () => {\r\n    navigation.navigate('Search');\r\n  };\r\n\r\n\r\n\r\n  return (\r\n    <ScrollView style={styles.container}>\r\n      {/* User Welcome Section */}\r\n      <View style={styles.header}>\r\n        <Text style={styles.welcomeText}>\r\n          {user ? `Welcome back, ${user?.email?.split('@')[0]}!` : 'Welcome to ChordsLegend!'}\r\n        </Text>\r\n        <Text style={styles.subtitle}>\r\n          Discover chords for your favorite songs\r\n        </Text>\r\n      </View>\r\n\r\n      <View style={styles.quickActions}>\r\n        <TouchableOpacity\r\n          style={styles.actionButton}\r\n          onPress={() => navigation.navigate('Search')}\r\n        >\r\n          <Text style={styles.actionIcon}></Text>\r\n          <Text style={styles.actionText}>Search Songs</Text>\r\n        </TouchableOpacity>\r\n\r\n        <TouchableOpacity\r\n          style={styles.actionButton}\r\n          onPress={() => navigation.navigate('Library')}\r\n        >\r\n          <Text style={styles.actionIcon}></Text>\r\n          <Text style={styles.actionText}>My Library</Text>\r\n        </TouchableOpacity>\r\n\r\n\r\n\r\n        <TouchableOpacity\r\n          style={styles.actionButton}\r\n          onPress={handleAuthAction}\r\n        >\r\n          <Text style={styles.actionIcon}>{user ? '' : ''}</Text>\r\n          <Text style={styles.actionText}>{user ? 'Logout' : 'Login / Sign Up'}</Text>\r\n        </TouchableOpacity>\r\n      </View>\r\n\r\n      <View style={styles.section}>\r\n        <Text style={styles.sectionTitle}>How It Works</Text>\r\n        <View style={styles.howItWorks}>\r\n          <View style={styles.step}>\r\n            <Text style={styles.stepNumber}>1</Text>\r\n            <Text style={styles.stepText}>Search for any song</Text>\r\n          </View>\r\n          <View style={styles.step}>\r\n            <Text style={styles.stepNumber}>2</Text>\r\n            <Text style={styles.stepText}>Get instant chord analysis</Text>\r\n          </View>\r\n          <View style={styles.step}>\r\n            <Text style={styles.stepNumber}>3</Text>\r\n            <Text style={styles.stepText}>Play along with chords</Text>\r\n          </View>\r\n        </View>\r\n      </View>\r\n    </ScrollView>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: '#1a1a1a',\r\n  },\r\n  header: {\r\n    padding: 20,\r\n    paddingTop: 40,\r\n  },\r\n  welcomeText: {\r\n    fontSize: 24,\r\n    fontWeight: 'bold',\r\n    color: '#fff',\r\n    marginBottom: 8,\r\n  },\r\n  subtitle: {\r\n    fontSize: 16,\r\n    color: '#888',\r\n  },\r\n  quickActions: {\r\n    flexDirection: 'row',\r\n    padding: 20,\r\n    gap: 15,\r\n  },\r\n  actionButton: {\r\n    flex: 1,\r\n    backgroundColor: '#333',\r\n    padding: 20,\r\n    borderRadius: 15,\r\n    alignItems: 'center',\r\n  },\r\n  actionIcon: {\r\n    fontSize: 30,\r\n    marginBottom: 10,\r\n  },\r\n  actionText: {\r\n    color: '#fff',\r\n    fontSize: 16,\r\n    fontWeight: '500',\r\n  },\r\n  section: {\r\n    padding: 20,\r\n  },\r\n  sectionTitle: {\r\n    fontSize: 20,\r\n    fontWeight: 'bold',\r\n    color: '#fff',\r\n    marginBottom: 15,\r\n  },\r\n  sectionSubtitle: {\r\n    fontSize: 14,\r\n    color: '#888',\r\n    marginBottom: 15,\r\n  },\r\n  featuredItem: {\r\n    width: 160,\r\n    marginRight: 15,\r\n  },\r\n  featuredImage: {\r\n    width: 160,\r\n    height: 120,\r\n    borderRadius: 10,\r\n    marginBottom: 8,\r\n  },\r\n  featuredTitle: {\r\n    color: '#fff',\r\n    fontSize: 14,\r\n    fontWeight: '500',\r\n  },\r\n  debugButton: {\r\n    backgroundColor: '#ff6b35',\r\n  },\r\n  howItWorks: {\r\n    gap: 15,\r\n  },\r\n  step: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n  },\r\n  stepNumber: {\r\n    width: 30,\r\n    height: 30,\r\n    backgroundColor: '#007AFF',\r\n    color: '#fff',\r\n    textAlign: 'center',\r\n    lineHeight: 30,\r\n    borderRadius: 15,\r\n    fontWeight: 'bold',\r\n    marginRight: 15,\r\n  },\r\n  stepText: {\r\n    color: '#fff',\r\n    fontSize: 16,\r\n    marginLeft: 15,\r\n    flex: 1,\r\n  },\r\n  statusContainer: {\r\n    padding: 10,\r\n    margin: 15,\r\n    borderRadius: 5,\r\n    borderWidth: 1,\r\n  },\r\n  statusText: {\r\n    fontSize: 16,\r\n    fontWeight: 'bold',\r\n    textAlign: 'center',\r\n  },\r\n});","import AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport { useFocusEffect, useNavigation } from '@react-navigation/native';\r\nimport { NativeStackNavigationProp } from '@react-navigation/native-stack';\r\nimport React, { useState } from 'react';\r\nimport {\r\n    Alert, FlatList, Image, StyleSheet, Text, TouchableOpacity, View\r\n} from 'react-native';\r\nimport { RootStackParamList } from '../navigation/types';\r\n\r\ntype LibraryScreenNavigationProp = NativeStackNavigationProp<\r\n  RootStackParamList,\r\n  'Library'\r\n>;\r\n\r\ninterface FavoriteSong {\r\n  id: string;\r\n  title: string;\r\n  thumbnail: string;\r\n  channelTitle: string;\r\n  dateAdded: string;\r\n}\r\n\r\nexport default function LibraryScreen() {\r\n  const [favorites, setFavorites] = useState<FavoriteSong[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const navigation = useNavigation<LibraryScreenNavigationProp>();\r\n\r\n  useFocusEffect(\r\n    React.useCallback(() => {\r\n      loadFavorites();\r\n    }, [])\r\n  );\r\n\r\n  const loadFavorites = async () => {\r\n    try {\r\n      const savedFavorites = await AsyncStorage.getItem('favorites');\r\n      if (savedFavorites) {\r\n        setFavorites(JSON.parse(savedFavorites));\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading favorites:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const removeFavorite = async (songId: string) => {\r\n    Alert.alert(\r\n      'Remove Favorite',\r\n      'Are you sure you want to remove this song from favorites?',\r\n      [\r\n        { text: 'Cancel', style: 'cancel' },\r\n        {\r\n          text: 'Remove',\r\n          style: 'destructive',\r\n          onPress: async () => {\r\n            try {\r\n              const updatedFavorites = favorites.filter(song => song.id !== songId);\r\n              setFavorites(updatedFavorites);\r\n              await AsyncStorage.setItem('favorites', JSON.stringify(updatedFavorites));\r\n            } catch (error) {\r\n              console.error('Error removing favorite:', error);\r\n            }\r\n          },\r\n        },\r\n      ]\r\n    );\r\n  };\r\n\r\n  const handleSelectSong = (song: FavoriteSong) => {\r\n    navigation.navigate('ChordPlayer', {\r\n      youtubeUrl: `https://www.youtube.com/watch?v=${song.id}`,\r\n      songTitle: song.title,\r\n      thumbnail: song.thumbnail,\r\n      channel: song.channelTitle,\r\n      chords: [],\r\n    });\r\n  };\r\n\r\n  const renderFavoriteItem = ({ item }: { item: FavoriteSong }) => (\r\n    <TouchableOpacity\r\n      style={styles.favoriteItem}\r\n      onPress={() => handleSelectSong(item)}\r\n    >\r\n      <Image source={{ uri: item.thumbnail }} style={styles.thumbnail} />\r\n      <View style={styles.songInfo}>\r\n        <Text style={styles.songTitle} numberOfLines={2}>\r\n          {item.title}\r\n        </Text>\r\n        <Text style={styles.channelTitle} numberOfLines={1}>\r\n          {item.channelTitle}\r\n        </Text>\r\n        <Text style={styles.dateAdded}>\r\n          Added {new Date(item.dateAdded).toLocaleDateString()}\r\n        </Text>\r\n      </View>\r\n      <TouchableOpacity\r\n        style={styles.removeButton}\r\n        onPress={() => removeFavorite(item.id)}\r\n      >\r\n        <Text style={styles.removeButtonText}></Text>\r\n      </TouchableOpacity>\r\n    </TouchableOpacity>\r\n  );\r\n\r\n  if (loading) {\r\n    return (\r\n      <View style={styles.centerContainer}>\r\n        <Text style={styles.loadingText}>Loading favorites...</Text>\r\n      </View>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <View style={styles.container}>\r\n      <View style={styles.header}>\r\n        <Text style={styles.headerTitle}>My Favorites</Text>\r\n        <Text style={styles.headerSubtitle}>\r\n          {favorites.length} song{favorites.length !== 1 ? 's' : ''}\r\n        </Text>\r\n      </View>\r\n\r\n      <FlatList\r\n        data={favorites}\r\n        keyExtractor={(item) => item.id}\r\n        renderItem={renderFavoriteItem}\r\n        contentContainerStyle={favorites.length === 0 ? styles.emptyContainer : undefined}\r\n        ListEmptyComponent={\r\n          <View style={styles.emptyState}>\r\n            <Text style={styles.emptyIcon}></Text>\r\n            <Text style={styles.emptyTitle}>No favorites yet</Text>\r\n            <Text style={styles.emptyText}>\r\n              Search for songs and add them to your favorites to see them here\r\n            </Text>\r\n            <TouchableOpacity\r\n              style={styles.searchButton}\r\n              onPress={() => navigation.navigate('Search')}\r\n            >\r\n              <Text style={styles.searchButtonText}>Start Searching</Text>\r\n            </TouchableOpacity>\r\n          </View>\r\n        }\r\n      />\r\n    </View>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: '#1a1a1a',\r\n  },\r\n  centerContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    backgroundColor: '#1a1a1a',\r\n  },\r\n  loadingText: {\r\n    color: '#888',\r\n    fontSize: 16,\r\n  },\r\n  header: {\r\n    padding: 20,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: '#333',\r\n  },\r\n  headerTitle: {\r\n    fontSize: 24,\r\n    fontWeight: 'bold',\r\n    color: '#fff',\r\n    marginBottom: 4,\r\n  },\r\n  headerSubtitle: {\r\n    fontSize: 16,\r\n    color: '#888',\r\n  },\r\n  favoriteItem: {\r\n    flexDirection: 'row',\r\n    padding: 16,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: '#333',\r\n    alignItems: 'center',\r\n  },\r\n  thumbnail: {\r\n    width: 80,\r\n    height: 60,\r\n    borderRadius: 8,\r\n    marginRight: 12,\r\n  },\r\n  songInfo: {\r\n    flex: 1,\r\n  },\r\n  songTitle: {\r\n    color: '#fff',\r\n    fontSize: 16,\r\n    fontWeight: '500',\r\n    marginBottom: 4,\r\n  },\r\n  channelTitle: {\r\n    color: '#888',\r\n    fontSize: 14,\r\n    marginBottom: 2,\r\n  },\r\n  dateAdded: {\r\n    color: '#666',\r\n    fontSize: 12,\r\n  },\r\n  removeButton: {\r\n    width: 30,\r\n    height: 30,\r\n    backgroundColor: '#333',\r\n    borderRadius: 15,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  removeButtonText: {\r\n    color: '#ff4444',\r\n    fontSize: 20,\r\n    fontWeight: 'bold',\r\n  },\r\n  emptyContainer: {\r\n    flex: 1,\r\n  },\r\n  emptyState: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    padding: 40,\r\n  },\r\n  emptyIcon: {\r\n    fontSize: 60,\r\n    marginBottom: 20,\r\n  },\r\n  emptyTitle: {\r\n    fontSize: 20,\r\n    fontWeight: 'bold',\r\n    color: '#fff',\r\n    marginBottom: 10,\r\n    textAlign: 'center',\r\n  },\r\n  emptyText: {\r\n    fontSize: 16,\r\n    color: '#888',\r\n    textAlign: 'center',\r\n    lineHeight: 24,\r\n    marginBottom: 30,\r\n  },\r\n  searchButton: {\r\n    backgroundColor: '#007AFF',\r\n    paddingHorizontal: 30,\r\n    paddingVertical: 15,\r\n    borderRadius: 25,\r\n  },\r\n  searchButtonText: {\r\n    color: '#fff',\r\n    fontSize: 16,\r\n    fontWeight: 'bold',\r\n  },\r\n});","import axios from 'axios';\r\nimport Constants from 'expo-constants';\r\n\r\nconst API_KEY = Constants.expoConfig?.extra?.YOUTUBE_API_KEY;\r\n\r\nexport const searchYouTube = async (query: string) => {\r\n  try {\r\n    const response = await axios.get(\r\n      `https://www.googleapis.com/youtube/v3/search?part=snippet&maxResults=25&q=${encodeURIComponent(\r\n        query\r\n      )}&type=video&key=${API_KEY}`\r\n    );\r\n    return response.data.items.map((item: any) => ({\r\n      id: item.id.videoId,\r\n      title: item.snippet.title,\r\n      thumbnail: item.snippet.thumbnails.medium?.url || item.snippet.thumbnails.default.url,\r\n      channelTitle: item.snippet.channelTitle,\r\n      publishedAt: item.snippet.publishedAt,\r\n    }));\r\n  } catch (error) {\r\n    console.error('YouTube search error:', error);\r\n    throw new Error('Failed to search YouTube');\r\n  }\r\n};","import AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport { useNavigation } from '@react-navigation/native';\r\nimport { NativeStackNavigationProp } from '@react-navigation/native-stack';\r\nimport React, { useState } from 'react';\r\nimport {\r\n  Alert, FlatList, Image, StyleSheet, Text,\r\n  TextInput,\r\n  TouchableOpacity, View\r\n} from 'react-native';\r\nimport { searchYouTube } from '../api/youtube';\r\nimport { RootStackParamList } from '../navigation/types';\r\n\r\ntype SearchScreenNavigationProp = NativeStackNavigationProp<\r\n  RootStackParamList,\r\n  'Search'\r\n>;\r\n\r\ninterface SearchResult {\r\n  id: string;\r\n  title: string;\r\n  thumbnail: string;\r\n  channelTitle: string;\r\n}\r\n\r\nexport default function SearchScreen() {\r\n  const [query, setQuery] = useState('');\r\n  const [results, setResults] = useState<SearchResult[]>([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [favorites, setFavorites] = useState<string[]>([]);\r\n  const navigation = useNavigation<SearchScreenNavigationProp>();\r\n\r\n  // Load favorites on component mount\r\n  React.useEffect(() => {\r\n    loadFavorites();\r\n  }, []);\r\n\r\n  const loadFavorites = async () => {\r\n    try {\r\n      const savedFavorites = await AsyncStorage.getItem('favorites');\r\n      if (savedFavorites) {\r\n        const favoritesData = JSON.parse(savedFavorites);\r\n        setFavorites(favoritesData.map((fav: any) => fav.id));\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading favorites:', error);\r\n    }\r\n  };\r\n\r\n  const toggleFavorite = async (item: SearchResult) => {\r\n    try {\r\n      const savedFavorites = await AsyncStorage.getItem('favorites');\r\n      let favoritesData = savedFavorites ? JSON.parse(savedFavorites) : [];\r\n      \r\n      const isAlreadyFavorite = favoritesData.some((fav: any) => fav.id === item.id);\r\n      \r\n      if (isAlreadyFavorite) {\r\n        // Remove from favorites\r\n        favoritesData = favoritesData.filter((fav: any) => fav.id !== item.id);\r\n        setFavorites(favorites.filter(id => id !== item.id));\r\n        Alert.alert('Removed', 'Song removed from favorites');\r\n      } else {\r\n        // Add to favorites\r\n        const favoriteItem = {\r\n          id: item.id,\r\n          title: item.title,\r\n          thumbnail: item.thumbnail,\r\n          channelTitle: item.channelTitle,\r\n          dateAdded: new Date().toISOString(),\r\n        };\r\n        favoritesData.push(favoriteItem);\r\n        setFavorites([...favorites, item.id]);\r\n        Alert.alert('Added', 'Song added to favorites');\r\n      }\r\n      \r\n      await AsyncStorage.setItem('favorites', JSON.stringify(favoritesData));\r\n    } catch (error) {\r\n      console.error('Error toggling favorite:', error);\r\n      Alert.alert('Error', 'Failed to update favorites');\r\n    }\r\n  };\r\n\r\n  const handleSearch = async () => {\r\n    if (!query.trim()) {\r\n      Alert.alert('Error', 'Please enter a search term');\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    try {\r\n      const searchResults = await searchYouTube(query);\r\n      setResults(searchResults);\r\n    } catch (error) {\r\n      Alert.alert('Error', 'Failed to search. Please try again.');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleSelectSong = (item: SearchResult) => {\r\n    // Convert YouTube video ID to full URL format expected by ChordPlayerScreen\r\n    const youtubeUrl = `https://www.youtube.com/watch?v=${item.id}`;\r\n    \r\n    navigation.navigate('ChordPlayer', {\r\n      youtubeUrl,\r\n      songTitle: item.title,\r\n      thumbnail: item.thumbnail,\r\n      channel: item.channelTitle,\r\n      chords: [], // Empty chords array - will be analyzed by ChordPlayerScreen\r\n    });\r\n  };\r\n\r\n  const renderSearchResult = ({ item }: { item: SearchResult }) => {\r\n    const isFavorite = favorites.includes(item.id);\r\n    \r\n    return (\r\n      <TouchableOpacity\r\n        style={styles.resultItem}\r\n        onPress={() => handleSelectSong(item)}\r\n      >\r\n        <Image source={{ uri: item.thumbnail }} style={styles.thumbnail} />\r\n        <View style={styles.resultInfo}>\r\n          <Text style={styles.resultTitle} numberOfLines={2}>\r\n            {item.title}\r\n          </Text>\r\n          <Text style={styles.resultChannel} numberOfLines={1}>\r\n            {item.channelTitle}\r\n          </Text>\r\n        </View>\r\n        <TouchableOpacity\r\n          style={styles.favoriteButton}\r\n          onPress={() => toggleFavorite(item)}\r\n        >\r\n          <Text style={[styles.favoriteIcon, isFavorite && styles.favoriteIconActive]}>\r\n            {isFavorite ? '' : ''}\r\n          </Text>\r\n        </TouchableOpacity>\r\n      </TouchableOpacity>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <View style={styles.container}>\r\n      <View style={styles.searchContainer}>\r\n        <TextInput\r\n          style={styles.searchInput}\r\n          placeholder=\"Search for songs...\"\r\n          placeholderTextColor=\"#888\"\r\n          value={query}\r\n          onChangeText={setQuery}\r\n          onSubmitEditing={handleSearch}\r\n        />\r\n        <TouchableOpacity\r\n          style={[styles.searchButton, loading && styles.searchButtonDisabled]}\r\n          onPress={handleSearch}\r\n          disabled={loading}\r\n        >\r\n          <Text style={styles.searchButtonText}>\r\n            {loading ? 'Searching...' : 'Search'}\r\n          </Text>\r\n        </TouchableOpacity>\r\n      </View>\r\n\r\n      <FlatList\r\n        data={results}\r\n        keyExtractor={(item) => item.id}\r\n        renderItem={renderSearchResult}\r\n        style={styles.resultsList}\r\n        showsVerticalScrollIndicator={false}\r\n        ListEmptyComponent={\r\n          <View style={styles.emptyContainer}>\r\n            <Text style={styles.emptyText}>\r\n              {loading ? 'Searching...' : 'Search for your favorite songs'}\r\n            </Text>\r\n          </View>\r\n        }\r\n      />\r\n    </View>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: '#1a1a1a',\r\n  },\r\n  searchContainer: {\r\n    flexDirection: 'row',\r\n    padding: 16,\r\n    gap: 12,\r\n  },\r\n  searchInput: {\r\n    flex: 1,\r\n    backgroundColor: '#333',\r\n    color: '#fff',\r\n    padding: 12,\r\n    borderRadius: 8,\r\n    fontSize: 16,\r\n  },\r\n  searchButton: {\r\n    backgroundColor: '#007AFF',\r\n    paddingHorizontal: 20,\r\n    paddingVertical: 12,\r\n    borderRadius: 8,\r\n    justifyContent: 'center',\r\n  },\r\n  searchButtonDisabled: {\r\n    backgroundColor: '#555',\r\n  },\r\n  searchButtonText: {\r\n    color: '#fff',\r\n    fontWeight: 'bold',\r\n  },\r\n  resultsList: {\r\n    flex: 1,\r\n  },\r\n  resultItem: {\r\n    flexDirection: 'row',\r\n    padding: 16,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: '#333',\r\n    alignItems: 'center',\r\n  },\r\n  thumbnail: {\r\n    width: 80,\r\n    height: 60,\r\n    borderRadius: 8,\r\n    marginRight: 12,\r\n  },\r\n  resultInfo: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n  },\r\n  resultTitle: {\r\n    color: '#fff',\r\n    fontSize: 16,\r\n    fontWeight: '500',\r\n    marginBottom: 4,\r\n  },\r\n  resultChannel: {\r\n    color: '#888',\r\n    fontSize: 14,\r\n  },\r\n  emptyContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    paddingTop: 100,\r\n  },\r\n  emptyText: {\r\n    color: '#888',\r\n    fontSize: 16,\r\n    textAlign: 'center',\r\n  },\r\n  favoriteButton: {\r\n    padding: 8,\r\n    marginLeft: 8,\r\n  },\r\n  favoriteIcon: {\r\n    fontSize: 24,\r\n  },\r\n  favoriteIconActive: {\r\n    fontSize: 24,\r\n  },\r\n});","import AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport React, { useState } from 'react';\r\nimport {\r\n    Alert,\r\n    ScrollView, StyleSheet, Switch, Text, TouchableOpacity, View\r\n} from 'react-native';\r\nimport { useAuth } from '../context/AuthProvider';\r\n\r\nexport default function SettingsScreen() {\r\n  const [darkMode, setDarkMode] = useState(true); // Default to dark mode\r\n  const [notifications, setNotifications] = useState(true);\r\n  const { user, logout } = useAuth();\r\n\r\n  const handleLogout = () => {\r\n    Alert.alert(\r\n      'Logout',\r\n      'Are you sure you want to logout?',\r\n      [\r\n        { text: 'Cancel', style: 'cancel' },\r\n        { text: 'Logout', style: 'destructive', onPress: logout },\r\n      ]\r\n    );\r\n  };\r\n\r\n  const clearCache = async () => {\r\n    Alert.alert(\r\n      'Clear Cache',\r\n      'This will remove all cached data including favorites. Continue?',\r\n      [\r\n        { text: 'Cancel', style: 'cancel' },\r\n        {\r\n          text: 'Clear',\r\n          style: 'destructive',\r\n          onPress: async () => {\r\n            try {\r\n              await AsyncStorage.clear();\r\n              Alert.alert('Success', 'Cache cleared successfully');\r\n            } catch (error) {\r\n              Alert.alert('Error', 'Failed to clear cache');\r\n            }\r\n          },\r\n        },\r\n      ]\r\n    );\r\n  };\r\n\r\n  const SettingItem = ({ \r\n    title, \r\n    subtitle, \r\n    onPress, \r\n    showSwitch = false, \r\n    switchValue = false, \r\n    onSwitchChange \r\n  }: {\r\n    title: string;\r\n    subtitle?: string;\r\n    onPress?: () => void;\r\n    showSwitch?: boolean;\r\n    switchValue?: boolean;\r\n    onSwitchChange?: (value: boolean) => void;\r\n  }) => (\r\n    <TouchableOpacity\r\n      style={styles.settingItem}\r\n      onPress={onPress}\r\n      disabled={showSwitch}\r\n    >\r\n      <View style={styles.settingContent}>\r\n        <Text style={styles.settingTitle}>{title}</Text>\r\n        {subtitle && <Text style={styles.settingSubtitle}>{subtitle}</Text>}\r\n      </View>\r\n      {showSwitch && (\r\n        <Switch\r\n          value={switchValue}\r\n          onValueChange={onSwitchChange}\r\n          trackColor={{ false: '#333', true: '#007AFF' }}\r\n          thumbColor=\"#fff\"\r\n        />\r\n      )}\r\n    </TouchableOpacity>\r\n  );\r\n\r\n  return (\r\n    <ScrollView style={styles.container}>\r\n      <View style={styles.header}>\r\n        <Text style={styles.headerTitle}>Settings</Text>\r\n        <Text style={styles.headerSubtitle}>\r\n          Signed in as {user?.email}\r\n        </Text>\r\n      </View>\r\n\r\n      <View style={styles.section}>\r\n        <Text style={styles.sectionTitle}>Appearance</Text>\r\n        <SettingItem\r\n          title=\"Dark Mode\"\r\n          subtitle=\"Use dark theme throughout the app\"\r\n          showSwitch\r\n          switchValue={darkMode}\r\n          onSwitchChange={setDarkMode}\r\n        />\r\n      </View>\r\n\r\n      <View style={styles.section}>\r\n        <Text style={styles.sectionTitle}>Notifications</Text>\r\n        <SettingItem\r\n          title=\"Push Notifications\"\r\n          subtitle=\"Get notified about new features and updates\"\r\n          showSwitch\r\n          switchValue={notifications}\r\n          onSwitchChange={setNotifications}\r\n        />\r\n      </View>\r\n\r\n      <View style={styles.section}>\r\n        <Text style={styles.sectionTitle}>Data & Storage</Text>\r\n        <SettingItem\r\n          title=\"Clear Cache\"\r\n          subtitle=\"Remove cached data and favorites\"\r\n          onPress={clearCache}\r\n        />\r\n      </View>\r\n\r\n      <View style={styles.section}>\r\n        <Text style={styles.sectionTitle}>Legal & Privacy</Text>\r\n        <SettingItem\r\n          title=\"Terms of Service\"\r\n          subtitle=\"Read our terms and conditions\"\r\n          onPress={() => Alert.alert('Terms of Service', 'Please visit our website or check the legal folder in the app documentation for the complete Terms of Service.')}\r\n        />\r\n        <SettingItem\r\n          title=\"Privacy Policy\"\r\n          subtitle=\"How we protect your data\"\r\n          onPress={() => Alert.alert('Privacy Policy', 'Please visit our website or check the legal folder in the app documentation for our complete Privacy Policy.')}\r\n        />\r\n        <SettingItem\r\n          title=\"App Version\"\r\n          subtitle=\"2.0.0 - Pi Network Ready\"\r\n        />\r\n      </View>\r\n\r\n      <View style={styles.section}>\r\n        <Text style={styles.sectionTitle}>Pi Network Integration</Text>\r\n        <SettingItem\r\n          title=\"Connect Pi Wallet\"\r\n          subtitle=\"Coming soon - Connect your Pi Network account\"\r\n          onPress={() => Alert.alert('Coming Soon', 'Pi Network integration will be available when Pi Network launches their mainnet')}\r\n        />\r\n      </View>\r\n\r\n      <TouchableOpacity style={styles.logoutButton} onPress={handleLogout}>\r\n        <Text style={styles.logoutText}>Logout</Text>\r\n      </TouchableOpacity>\r\n    </ScrollView>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: '#1a1a1a',\r\n  },\r\n  header: {\r\n    padding: 20,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: '#333',\r\n  },\r\n  headerTitle: {\r\n    fontSize: 24,\r\n    fontWeight: 'bold',\r\n    color: '#fff',\r\n    marginBottom: 4,\r\n  },\r\n  headerSubtitle: {\r\n    fontSize: 16,\r\n    color: '#888',\r\n  },\r\n  section: {\r\n    marginTop: 20,\r\n  },\r\n  sectionTitle: {\r\n    fontSize: 18,\r\n    fontWeight: 'bold',\r\n    color: '#fff',\r\n    marginBottom: 10,\r\n    marginHorizontal: 20,\r\n  },\r\n  settingItem: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    paddingHorizontal: 20,\r\n    paddingVertical: 15,\r\n    backgroundColor: '#2a2a2a',\r\n    marginHorizontal: 20,\r\n    marginBottom: 2,\r\n    borderRadius: 8,\r\n  },\r\n  settingContent: {\r\n    flex: 1,\r\n  },\r\n  settingTitle: {\r\n    fontSize: 16,\r\n    fontWeight: '500',\r\n    color: '#fff',\r\n    marginBottom: 2,\r\n  },\r\n  settingSubtitle: {\r\n    fontSize: 14,\r\n    color: '#888',\r\n  },\r\n  logoutButton: {\r\n    margin: 20,\r\n    padding: 15,\r\n    backgroundColor: '#333',\r\n    borderRadius: 10,\r\n    alignItems: 'center',\r\n    marginTop: 40,\r\n  },\r\n  logoutText: {\r\n    color: '#ff4444',\r\n    fontSize: 16,\r\n    fontWeight: 'bold',\r\n  },\r\n});","// src/navigation/RootStack.tsx\r\nimport { createNativeStackNavigator } from '@react-navigation/native-stack';\r\nimport React from 'react';\r\nimport AuthScreen from '../screens/AuthScreen';\r\nimport ChordPlayerScreen from '../screens/ChordPlayerScreen';\r\nimport HomeScreen from '../screens/HomeScreen';\r\nimport LibraryScreen from '../screens/LibraryScreen';\r\nimport SearchScreen from '../screens/SearchScreen';\r\nimport SettingsScreen from '../screens/SettingsScreen';\r\n\r\nconst Stack = createNativeStackNavigator();\r\n\r\nexport default function RootStack() {\r\n  return (\r\n    <Stack.Navigator \r\n      initialRouteName=\"Home\"\r\n      screenOptions={{\r\n        headerStyle: {\r\n          backgroundColor: '#4CAF50',\r\n        },\r\n        headerTintColor: '#fff',\r\n        headerTitleStyle: {\r\n          fontWeight: 'bold',\r\n        },\r\n      }}\r\n    >\r\n      <Stack.Screen \r\n        name=\"Home\" \r\n        component={HomeScreen} \r\n        options={{ title: ' ChordsLegend' }}\r\n      />\r\n      <Stack.Screen \r\n        name=\"Search\" \r\n        component={SearchScreen} \r\n        options={{ title: ' Search' }}\r\n      />\r\n      <Stack.Screen \r\n        name=\"Settings\" \r\n        component={SettingsScreen} \r\n        options={{ title: ' Settings' }}\r\n      />\r\n      <Stack.Screen \r\n        name=\"ChordPlayer\" \r\n        component={ChordPlayerScreen} \r\n        options={{ title: ' Chord Player' }}\r\n      />\r\n      <Stack.Screen \r\n        name=\"Library\" \r\n        component={LibraryScreen} \r\n        options={{ title: ' My Favorites' }}\r\n      />\r\n      <Stack.Screen \r\n        name=\"Auth\" \r\n        component={AuthScreen} \r\n        options={{ title: ' Sign In' }}\r\n      />\r\n    </Stack.Navigator>\r\n  );\r\n}","// Cross-device compatibility utilities\r\nimport { Dimensions, Platform } from 'react-native';\r\n\r\nexport interface DeviceInfo {\r\n  platform: string;\r\n  isWeb: boolean;\r\n  isMobile: boolean;\r\n  isTablet: boolean;\r\n  isDesktop: boolean;\r\n  screenWidth: number;\r\n  screenHeight: number;\r\n  userAgent: string;\r\n  supportedFeatures: {\r\n    audio: boolean;\r\n    video: boolean;\r\n    localStorage: boolean;\r\n    serviceWorker: boolean;\r\n    notifications: boolean;\r\n  };\r\n}\r\n\r\nexport const getDeviceInfo = (): DeviceInfo => {\r\n  const { width, height } = Dimensions.get('window');\r\n  const isWeb = Platform.OS === 'web';\r\n  \r\n  // Determine device type based on screen size and platform\r\n  const isMobile = width < 768;\r\n  const isTablet = width >= 768 && width < 1024;\r\n  const isDesktop = width >= 1024;\r\n  \r\n  let userAgent = 'Unknown';\r\n  let supportedFeatures = {\r\n    audio: false,\r\n    video: false,\r\n    localStorage: false,\r\n    serviceWorker: false,\r\n    notifications: false,\r\n  };\r\n\r\n  if (isWeb && typeof window !== 'undefined') {\r\n    userAgent = navigator.userAgent || 'Unknown';\r\n    \r\n    // Check for feature support\r\n    supportedFeatures = {\r\n      audio: !!(window as any).Audio || !!(document.createElement('audio').canPlayType),\r\n      video: !!(document.createElement('video').canPlayType),\r\n      localStorage: typeof Storage !== 'undefined',\r\n      serviceWorker: 'serviceWorker' in navigator,\r\n      notifications: 'Notification' in window,\r\n    };\r\n  }\r\n\r\n  return {\r\n    platform: Platform.OS,\r\n    isWeb,\r\n    isMobile,\r\n    isTablet,\r\n    isDesktop,\r\n    screenWidth: width,\r\n    screenHeight: height,\r\n    userAgent,\r\n    supportedFeatures,\r\n  };\r\n};\r\n\r\nexport const getOptimalPlayerSize = (deviceInfo: DeviceInfo) => {\r\n  const { screenWidth, isMobile, isTablet } = deviceInfo;\r\n  \r\n  if (isMobile) {\r\n    return {\r\n      width: Math.min(screenWidth - 40, 360),\r\n      height: 200,\r\n    };\r\n  } else if (isTablet) {\r\n    return {\r\n      width: Math.min(screenWidth - 80, 500),\r\n      height: 280,\r\n    };\r\n  } else {\r\n    return {\r\n      width: Math.min(screenWidth - 120, 640),\r\n      height: 360,\r\n    };\r\n  }\r\n};\r\n\r\nexport const getBrowserCompatibility = () => {\r\n  if (Platform.OS !== 'web' || typeof window === 'undefined') {\r\n    return { compatible: true, issues: [] };\r\n  }\r\n\r\n  const issues: string[] = [];\r\n  const userAgent = navigator.userAgent.toLowerCase();\r\n\r\n  // Check for known compatibility issues\r\n  if (userAgent.includes('internet explorer') || userAgent.includes('msie')) {\r\n    issues.push('Internet Explorer is not supported. Please use a modern browser.');\r\n  }\r\n\r\n  if (userAgent.includes('safari') && !userAgent.includes('chrome') && \r\n      !window.AudioContext && !(window as any).webkitAudioContext) {\r\n    issues.push('Audio features may not work properly in this version of Safari.');\r\n  }\r\n\r\n  // Check for essential APIs\r\n  if (!window.fetch) {\r\n    issues.push('This browser does not support modern networking features.');\r\n  }\r\n\r\n  if (!window.Promise) {\r\n    issues.push('This browser does not support modern JavaScript features.');\r\n  }\r\n\r\n  return {\r\n    compatible: issues.length === 0,\r\n    issues,\r\n  };\r\n};\r\n\r\nexport const enhanceForPWA = () => {\r\n  if (Platform.OS !== 'web' || typeof window === 'undefined') {\r\n    return;\r\n  }\r\n\r\n  // Add viewport meta tag if not present\r\n  let viewport = document.querySelector('meta[name=\"viewport\"]');\r\n  if (!viewport) {\r\n    viewport = document.createElement('meta');\r\n    viewport.setAttribute('name', 'viewport');\r\n    viewport.setAttribute('content', 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no');\r\n    document.head.appendChild(viewport);\r\n  }\r\n\r\n  // Add theme color meta tag\r\n  let themeColor = document.querySelector('meta[name=\"theme-color\"]');\r\n  if (!themeColor) {\r\n    themeColor = document.createElement('meta');\r\n    themeColor.setAttribute('name', 'theme-color');\r\n    themeColor.setAttribute('content', '#1a1a2e');\r\n    document.head.appendChild(themeColor);\r\n  }\r\n\r\n  // Add apple-mobile-web-app-capable for iOS\r\n  let appleMobile = document.querySelector('meta[name=\"apple-mobile-web-app-capable\"]');\r\n  if (!appleMobile) {\r\n    appleMobile = document.createElement('meta');\r\n    appleMobile.setAttribute('name', 'apple-mobile-web-app-capable');\r\n    appleMobile.setAttribute('content', 'yes');\r\n    document.head.appendChild(appleMobile);\r\n  }\r\n\r\n  // Prevent zoom on double tap for better UX\r\n  let style = document.getElementById('pwa-enhancements');\r\n  if (!style) {\r\n    style = document.createElement('style');\r\n    style.id = 'pwa-enhancements';\r\n    style.textContent = `\r\n      * {\r\n        touch-action: manipulation;\r\n      }\r\n      \r\n      body {\r\n        -webkit-user-select: none;\r\n        -webkit-touch-callout: none;\r\n        -webkit-tap-highlight-color: transparent;\r\n      }\r\n      \r\n      input, textarea {\r\n        -webkit-user-select: auto;\r\n      }\r\n    `;\r\n    document.head.appendChild(style);\r\n  }\r\n};\r\n\r\nexport const logDeviceCapabilities = () => {\r\n  const deviceInfo = getDeviceInfo();\r\n  const compatibility = getBrowserCompatibility();\r\n  \r\n  console.log(' ChordsLegend Device Compatibility Report');\r\n  console.log('==========================================');\r\n  console.log('Platform:', deviceInfo.platform);\r\n  console.log('Screen Size:', `${deviceInfo.screenWidth}x${deviceInfo.screenHeight}`);\r\n  console.log('Device Type:', {\r\n    mobile: deviceInfo.isMobile,\r\n    tablet: deviceInfo.isTablet,\r\n    desktop: deviceInfo.isDesktop,\r\n  });\r\n  console.log('User Agent:', deviceInfo.userAgent);\r\n  console.log('Supported Features:', deviceInfo.supportedFeatures);\r\n  console.log('Browser Compatibility:', compatibility);\r\n  console.log('==========================================');\r\n  \r\n  return { deviceInfo, compatibility };\r\n};\r\n","import { registerRootComponent } from 'expo';\nimport App from './App';\n\n// Register the root component\nregisterRootComponent(App);","import { NavigationContainer } from '@react-navigation/native';\r\nimport React, { useEffect, useState } from 'react';\r\nimport { AuthProvider } from './src/context/AuthProvider';\r\n// import { MockAuthProvider as AuthProvider } from './src/context/MockAuthProvider';\r\nimport { Platform } from 'react-native';\r\nimport EnhancedErrorBoundary from './src/components/EnhancedErrorBoundary';\r\nimport { PI_CONFIG } from './src/config/piConfig';\r\nimport RootStack from './src/navigation/RootStack';\r\nimport { enhanceForPWA, getBrowserCompatibility, logDeviceCapabilities } from './src/utils/deviceCompatibility';\r\n\r\nexport default function App() {\r\n  const [isPiEnvironment, setIsPiEnvironment] = useState(false);\r\n  const [deviceCompatibility, setDeviceCompatibility] = useState(null);\r\n\r\n  useEffect(() => {\r\n    // Initialize cross-device compatibility and PWA enhancements\r\n    const initCompatibility = () => {\r\n      try {\r\n        // Enhance for PWA if on web\r\n        enhanceForPWA();\r\n        \r\n        // Log device capabilities for debugging\r\n        const compatibility = logDeviceCapabilities();\r\n        setDeviceCompatibility(compatibility);\r\n        \r\n        // Check browser compatibility and warn if needed\r\n        const browserCheck = getBrowserCompatibility();\r\n        if (!browserCheck.compatible && Platform.OS === 'web') {\r\n          console.warn('Browser compatibility issues detected:', browserCheck.issues);\r\n          // Show compatibility warning to user if needed\r\n          if (typeof window !== 'undefined' && browserCheck.issues.length > 0) {\r\n            console.log('ChordsLegend may not work optimally in this browser. Consider using Chrome, Firefox, or Safari.');\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error('Error initializing compatibility features:', error);\r\n      }\r\n    };\r\n\r\n    // Initialize Pi Browser integration if running in Pi environment\r\n    const initPi = async () => {\r\n      try {\r\n        const isPiBrowser = PI_CONFIG.isPiBrowser();\r\n        setIsPiEnvironment(isPiBrowser);\r\n        \r\n        if (isPiBrowser) {\r\n          console.log(' ChordsLegend running in Pi Browser environment');\r\n          console.log('Sandbox mode:', PI_CONFIG.SANDBOX_MODE);\r\n          console.log('Environment:', PI_CONFIG.ENVIRONMENT);\r\n          \r\n          // Initialize Pi SDK if available\r\n          if (typeof window !== 'undefined' && window.Pi) {\r\n            await window.Pi.init({\r\n              version: PI_CONFIG.SDK_CONFIG.version,\r\n              sandbox: PI_CONFIG.SDK_CONFIG.sandbox\r\n            });\r\n            console.log(' Pi SDK initialized successfully');\r\n          }\r\n        } else {\r\n          console.log(' ChordsLegend running in standard web environment');\r\n        }\r\n      } catch (error) {\r\n        console.error(' Pi SDK initialization failed:', error);\r\n      }\r\n    };\r\n\r\n    // Initialize both compatibility and Pi features\r\n    initCompatibility();\r\n    initPi();\r\n  }, []);\r\n\r\n  return (\r\n    <EnhancedErrorBoundary>\r\n      <AuthProvider>\r\n        <NavigationContainer>\r\n          <RootStack />\r\n        </NavigationContainer>\r\n      </AuthProvider>\r\n    </EnhancedErrorBoundary>\r\n  );\r\n}\r\n\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","var getProto = Object.getPrototypeOf ? (obj) => (Object.getPrototypeOf(obj)) : (obj) => (obj.__proto__);\nvar leafPrototypes;\n// create a fake namespace object\n// mode & 1: value is a module id, require it\n// mode & 2: merge all properties of value into the ns\n// mode & 4: return value when already ns object\n// mode & 16: return value when it's Promise-like\n// mode & 8|1: behave like require\n__webpack_require__.t = function(value, mode) {\n\tif(mode & 1) value = this(value);\n\tif(mode & 8) return value;\n\tif(typeof value === 'object' && value) {\n\t\tif((mode & 4) && value.__esModule) return value;\n\t\tif((mode & 16) && typeof value.then === 'function') return value;\n\t}\n\tvar ns = Object.create(null);\n\t__webpack_require__.r(ns);\n\tvar def = {};\n\tleafPrototypes = leafPrototypes || [null, getProto({}), getProto([]), getProto(getProto)];\n\tfor(var current = mode & 2 && value; typeof current == 'object' && !~leafPrototypes.indexOf(current); current = getProto(current)) {\n\t\tObject.getOwnPropertyNames(current).forEach((key) => (def[key] = () => (value[key])));\n\t}\n\tdef['default'] = () => (value);\n\t__webpack_require__.d(ns, def);\n\treturn ns;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t792: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkweb\"] = self[\"webpackChunkweb\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [273], () => (__webpack_require__(2332)))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["firebaseConfig","_Constants$expoConfig","fromConstants","Constants","expoConfig","extra","apiKey","FIREBASE_API_KEY","process","EXPO_PUBLIC_FIREBASE_API_KEY","authDomain","FIREBASE_AUTH_DOMAIN","EXPO_PUBLIC_FIREBASE_AUTH_DOMAIN","projectId","FIREBASE_PROJECT_ID","EXPO_PUBLIC_FIREBASE_PROJECT_ID","storageBucket","FIREBASE_STORAGE_BUCKET","EXPO_PUBLIC_FIREBASE_STORAGE_BUCKET","messagingSenderId","FIREBASE_MESSAGING_SENDER_ID","EXPO_PUBLIC_FIREBASE_MESSAGING_SENDER_ID","appId","FIREBASE_APP_ID","EXPO_PUBLIC_FIREBASE_APP_ID","getFirebaseConfig","console","log","_objectSpread","substring","_Constants$expoConfig3","app","auth","_Constants$expoConfig2","Object","keys","filter","k","includes","config","missing","key","length","error","validateFirebaseConfig","getApps","initializeApp","getAuth","Error","message","String","testFirebaseConnection","_ref","_asyncToGenerator","options","testUrl","response","fetch","method","headers","body","JSON","stringify","status","errorText","text","networkError","mode","cache","internetError","authInstance","fallbackError","apply","arguments","getAuthInstance","AuthContext","createContext","user","isLoading","login","_login","signUp","_signUp","logout","_logout","clearError","isConnected","forceConnectionState","AuthProvider","children","_useState","useState","_useState2","_slicedToArray","setUser","_useState3","_useState4","setIsLoading","_useState5","_useState6","setError","_useState7","_useState8","setIsConnected","providerInstanceId","Math","random","toString","useEffect","checkConnection","_ref2","unsubscribe","onAuthStateChanged","email","authError","connectionTest","testError","useCallback","_ref3","password","userCredential","signInWithEmailAndPassword","code","errorMessage","getFirebaseErrorMessage","_x","_x2","_ref4","createUserWithEmailAndPassword","_x3","_x4","signOut","value","connected","_jsx","Provider","useAuth","context","useContext","debugInfo","timestamp","Date","toLocaleTimeString","EnhancedErrorBoundary","_Component","props","_this","_classCallCheck","handleRestart","setState","hasError","errorInfo","Platform","OS","window","location","reload","state","_inherits","_createClass","this","deviceInfo","platform","version","Version","userAgent","navigator","toISOString","url","href","stack","componentStack","View","style","styles","container","_jsxs","errorContainer","Text","emoji","title","__DEV__","TouchableOpacity","restartButton","onPress","restartButtonText","supportText","Component","StyleSheet","create","flex","backgroundColor","justifyContent","alignItems","padding","borderRadius","maxWidth","fontSize","marginBottom","fontWeight","color","textAlign","lineHeight","debugTitle","debugText","fontFamily","paddingHorizontal","paddingVertical","PI_CONFIG","APP_NAME","APP_USERNAME","SANDBOX_MODE","ENVIRONMENT","API_KEY","PI_API_KEY","SANDBOX_URL","SANDBOX_API_BASE","isPiBrowser","hostname","undefined","Pi","SDK_CONFIG","sandbox","environment","APP_CONFIG","appName","developerId","appSecret","PI_APP_SECRET","scopes","SANDBOX_FEATURES","TEST_PREMIUM","price","name","description","FEATURES","PREMIUM_CHORD_LIBRARY","AI_CHORD_DETECTION","YOUTUBE_SYNC","OFFLINE_MODE","URLS","DEVELOPER_PORTAL","APP_DETAILS","PI_BROWSER","AuthScreen","navigation","useNavigation","useRoute","params","setEmail","setPassword","isLogin","setIsLogin","loading","setLoading","_useState9","general","_useState0","errors","setErrors","_useState1","_useState10","successMessage","setSuccessMessage","_useAuth","setTimeout","replace","prev","handleAuth","trim","test","validateEmail","passwordError","validatePassword","KeyboardAvoidingView","behavior","ScrollView","contentContainerStyle","scrollContainer","formContainer","subtitle","statusContainer","statusText","modeToggle","modeButton","modeButtonActive","modeButtonText","modeButtonTextActive","successContainer","successText","TextInput","input","inputError","placeholder","placeholderTextColor","onChangeText","keyboardType","autoCapitalize","autoComplete","fieldErrorText","secureTextEntry","passwordRequirements","requirementsTitle","requirementText","requirementMet","button","buttonDisabled","buttonWarning","disabled","loadingContainer","ActivityIndicator","size","buttonText","alternativeLogin","alternativeText","socialButtons","socialButton","socialButtonText","comingSoon","marginHorizontal","borderWidth","borderColor","marginTop","flexDirection","gap","flexGrow","debugToggle","debugToggleText","debugContainer","maxHeight","clearLogsButton","clearLogsText","debugLogs","debugLogText","marginLeft","opacity","fontStyle","API_CONFIG","EXPO_PUBLIC_API_URL","API_URL","toError","analyzeChords","youtubeUrl","controller","AbortController","timeoutId","abort","_ret","lastError","_loop","attempt","youtube_url","detailed","signal","clearTimeout","ok","errorData","_tryParseError","tryParseError","data","json","chords","v","map","chord","index","time","confidence","Number","min","max","duration","beat","DOMException","Promise","resolve","normalizedError","enhanceError","_unused","lightTheme","primary","secondary","background","surface","surfaceHighlight","secondaryText","onPrimary","divider","ThemeContext","theme","isDark","setTheme","CHORD_LIBRARY","fingerings","frets","fingers","type","barres","fret","startString","endString","baseFret","margin","overflow","elevation","shadowColor","shadowOffset","width","height","shadowOpacity","shadowRadius","header","borderBottomWidth","borderBottomColor","timeIndicator","timeline","timelineContent","chordItem","marginRight","position","progressBar","top","left","right","progressFill","chordName","timeText","durationText","playingIndicator","playingIcon","nextLabel","bottom","controls","borderTopWidth","borderTopColor","positionText","globalProgress","globalProgressFill","chordProgression","currentTime","isPlaying","onSeekToTime","scrollViewRef","useRef","toFixed","current","currentIndex","findIndex","nextChord","startTime","currentChord","scrollPosition","scrollTo","x","animated","formatTime","seconds","floor","padStart","currentChordIndex","ref","horizontal","showsHorizontalScrollIndicator","isActive","isPast","isNext","isUpcoming","progress","currentInfo","sheetScroll","sheetContent","paddingLeft","paddingRight","measure","measureNumber","beatsRow","chordSymbol","beatIndicator","beatNumber","playingPulse","rhythmSheet","beats","totalDuration","_toConsumableArray","c","totalBeats","ceil","beatTime","beatIndex","activeChord","find","isChordChange","some","abs","push","generateRhythmSheet","currentBeatIndex","currentBeat","currentMeasure","isActiveBeat","isUpcomingBeat","isPastBeat","measures","forEach","getMeasures","measureNumbers","sort","a","b","transform","scale","renderMeasure","_Dimensions$get","Dimensions","get","screenWidth","Fretboard","_fingering$barres","fingering","onFingeringChange","_ref$size","_ref$isHighlighted","isHighlighted","_ref$animationDelay","animationDelay","strings","dimensions","baseWidth","stringSpacing","fretSpacing","dotSize","getSizeDimensions","highlightAnim","Animated","Value","pulseAnim","parallel","timing","toValue","useNativeDriver","loop","sequence","iterations","start","stopAnimation","fretboardContainer","interpolate","inputRange","outputRange","extrapolate","fretboardBackground","chordNameTop","nut","Array","from","maxFrets","_","fretIndex","fretLine","stringName","stringIndex","stringThickness","stringLine","stringLabel","baseFretNumber","openStringIndicator","mutedIndicator","_fingering$fingers","fretPosition","y","fingerNumber","fingerDot","barre","startY","endY","barreIndicator","fingeringType","YoutubeIframe","require","e","UnifiedYouTubePlayer","React","videoId","_ref$height","_ref$width","_ref$playing","playing","onChangeState","onError","onTimeUpdate","onPlayingChange","_ref$autoplay","autoplay","_ref$muted","muted","_ref$loop","_ref$controls","setCurrentTime","isPlayerPlaying","setIsPlayerPlaying","timeUpdateInterval","startPlayTime","startTimeTracking","clearInterval","now","setInterval","iframe","document","querySelector","contentWindow","postMessage","warn","elapsed","stopTimeTracking","seekToTime","handlePlayStateChange","shouldPlay","handleMessage","event","parse","info","addEventListener","removeEventListener","useImperativeHandle","play","pause","seekTo","getCurrentTime","_getCurrentTime","onStateChange","onPlayerError","URLSearchParams","mute","rel","modestbranding","playsinline","enablejsapi","origin","isValidVideoId","src","frameBorder","allow","allowFullScreen","onLoad","debugOverlay","fallback","fallbackTitle","fallbackText","fallbackSubText","fallbackHint","allowWebViewZoom","webViewStyle","initialPlayerParams","webView","borderStyle","zIndex","SynchronizedChordPlayer","songTitle","onBack","setIsPlaying","setCurrentChordIndex","isLooping","setIsLooping","fingeringStyle","setFingeringStyle","fingeringLocked","setFingeringLocked","_useState11","_useState12","showFingeringModal","setShowFingeringModal","_useState13","_useState14","fretboardSize","setFretboardSize","_useState15","_useState16","forcePlayerState","setForcePlayerState","_useState17","_useState18","timingOffset","setTimingOffset","playerRef","getCurrentChord","adjustedTime","chordEndTime","isInTimeRange","getNextChord","activeChordIndex","_chordProgression","total","chordStart","chordEnd","handlePlayerTimeUpdate","handlePlayerStateChange","getChordFingering","chordDef","result","f","backButton","backButtonText","numberOfLines","content","playerContainer","controlButton","controlButtonText","offset","CompactRhythmTimeline","EmbeddedRhythmSheet","currentFingering","nextFingering","chordDisplay","currentNextContainer","currentChordSection","currentChordLabel","nextChordSection","nextChordLabel","nextChordName","nextChordTime","nextFretboardContainer","charAt","toUpperCase","slice","sizeControls","sizeButton","sizeButtonText","nextChordPreview","Modal","visible","transparent","animationType","onRequestClose","modalOverlay","modalContent","modalHeader","modalTitle","closeButton","closeButtonText","FlatList","keyExtractor","item","renderItem","fingeringOption","fingeringPreview","fingeringLabel","renderFingeringModal","paddingTop","minWidth","progressContainer","chordProgressItem","chordProgressText","chordTimeText","chordPreviewSection","sectionTitle","chordPreviewContainer","chordPreviewItem","previewChordName","previewTimeText","miniatureFretboard","textTransform","nextIndicator","progressIndicator","progressText","loadingText","loadingSubtext","errorSubtext","route","_route$params","thumbnail","channel","setChordProgression","isAnalyzing","setIsAnalyzing","generateRealisticProgression","songStructures","intro","verse","chorus","bridge","outro","silencePeriods","end","toLowerCase","structure","fullProgression","isInSilencePeriod","period","chordDuration","rand","filteredChords","t","analyzeVideo","chordData","realisticProgression","chordTiming","convertToChordTiming","match","getVideoId","goBack","HomeScreen","_user$email","welcomeText","split","quickActions","actionButton","navigate","actionIcon","actionText","section","howItWorks","step","stepNumber","stepText","sectionSubtitle","featuredItem","featuredImage","featuredTitle","debugButton","LibraryScreen","favorites","setFavorites","useFocusEffect","loadFavorites","savedFavorites","AsyncStorage","getItem","removeFavorite","songId","Alert","alert","_onPress","updatedFavorites","song","id","setItem","centerContainer","headerTitle","headerSubtitle","favoriteItem","channelTitle","Image","source","uri","songInfo","dateAdded","toLocaleDateString","removeButton","removeButtonText","emptyContainer","ListEmptyComponent","emptyState","emptyIcon","emptyTitle","emptyText","searchButton","searchButtonText","YOUTUBE_API_KEY","searchYouTube","query","axios","encodeURIComponent","items","_item$snippet$thumbna","snippet","thumbnails","medium","default","publishedAt","SearchScreen","setQuery","results","setResults","favoritesData","fav","toggleFavorite","concat","handleSearch","searchResults","searchContainer","searchInput","onSubmitEditing","searchButtonDisabled","isFavorite","resultItem","handleSelectSong","resultInfo","resultTitle","resultChannel","favoriteButton","favoriteIcon","favoriteIconActive","resultsList","showsVerticalScrollIndicator","SettingsScreen","darkMode","setDarkMode","notifications","setNotifications","clearCache","clear","SettingItem","_ref2$showSwitch","showSwitch","_ref2$switchValue","switchValue","onSwitchChange","settingItem","settingContent","settingTitle","settingSubtitle","Switch","onValueChange","trackColor","false","true","thumbColor","logoutButton","logoutText","Stack","createNativeStackNavigator","RootStack","Navigator","initialRouteName","screenOptions","headerStyle","headerTintColor","headerTitleStyle","Screen","component","ChordPlayerScreen","getBrowserCompatibility","compatible","issues","AudioContext","webkitAudioContext","logDeviceCapabilities","isWeb","isMobile","isTablet","isDesktop","supportedFeatures","audio","video","localStorage","serviceWorker","Audio","createElement","canPlayType","Storage","screenHeight","getDeviceInfo","compatibility","mobile","tablet","desktop","registerRootComponent","setIsPiEnvironment","setDeviceCompatibility","initPi","init","viewport","setAttribute","head","appendChild","themeColor","appleMobile","getElementById","textContent","enhanceForPWA","browserCheck","initCompatibility","NavigationContainer","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","call","m","deferred","O","chunkIds","fn","priority","notFulfilled","Infinity","i","fulfilled","j","every","splice","r","n","getter","__esModule","d","leafPrototypes","getProto","getPrototypeOf","obj","then","ns","def","indexOf","getOwnPropertyNames","definition","o","defineProperty","enumerable","g","globalThis","Function","prop","prototype","hasOwnProperty","Symbol","toStringTag","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","chunkLoadingGlobal","self","bind","__webpack_exports__"],"sourceRoot":""}